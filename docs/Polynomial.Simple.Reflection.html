<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Polynomial.Simple.Reflection</title><link rel="stylesheet" href="Agda.css"></head><body><pre><a id="1" class="Keyword">module</a> <a id="8" href="Polynomial.Simple.Reflection.html" class="Module">Polynomial.Simple.Reflection</a> <a id="37" class="Keyword">where</a>

<a id="44" class="Keyword">open</a> <a id="49" class="Keyword">import</a> <a id="56" href="Reflection.html" class="Module">Reflection</a>
<a id="67" class="Keyword">open</a> <a id="72" class="Keyword">import</a> <a id="79" href="Function.html" class="Module">Function</a>
<a id="88" class="Keyword">open</a> <a id="93" class="Keyword">import</a> <a id="100" href="Data.Unit.html" class="Module">Data.Unit</a> <a id="110" class="Keyword">using</a> <a id="116" class="Symbol">(</a><a id="117" href="Agda.Builtin.Unit.html#69" class="Record">⊤</a><a id="118" class="Symbol">)</a>
<a id="120" class="Keyword">open</a> <a id="125" class="Keyword">import</a> <a id="132" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="141" class="Symbol">as</a> <a id="144" class="Module">ℕ</a> <a id="146" class="Keyword">using</a> <a id="152" class="Symbol">(</a><a id="153" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a><a id="154" class="Symbol">;</a> <a id="156" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a><a id="159" class="Symbol">;</a> <a id="161" href="Agda.Builtin.Nat.html#115" class="InductiveConstructor">zero</a><a id="165" class="Symbol">)</a>
<a id="167" class="Keyword">open</a> <a id="172" class="Keyword">import</a> <a id="179" href="Data.List.html" class="Module">Data.List</a> <a id="189" class="Symbol">as</a> <a id="192" class="Module">List</a> <a id="197" class="Keyword">using</a> <a id="203" class="Symbol">(</a><a id="204" href="Agda.Builtin.List.html#80" class="Datatype">List</a><a id="208" class="Symbol">;</a> <a id="210" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">_∷_</a><a id="213" class="Symbol">;</a> <a id="215" href="Data.List.Base.html#9863" class="InductiveConstructor">[]</a><a id="217" class="Symbol">;</a> <a id="219" href="Data.List.Base.html#3600" class="Function">foldr</a><a id="224" class="Symbol">)</a>

<a id="227" class="Keyword">module</a> <a id="Internal"></a><a id="234" href="Polynomial.Simple.Reflection.html#234" class="Module">Internal</a> <a id="243" class="Symbol">(</a><a id="244" href="Polynomial.Simple.Reflection.html#244" class="Bound">rng</a> <a id="248" class="Symbol">:</a> <a id="250" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a><a id="254" class="Symbol">)</a> <a id="256" class="Keyword">where</a>
  <a id="264" class="Keyword">open</a> <a id="269" class="Keyword">import</a> <a id="276" href="Polynomial.Simple.Solver.html" class="Module">Polynomial.Simple.Solver</a> <a id="301" class="Keyword">renaming</a> <a id="310" class="Symbol">(</a><a id="311" href="Polynomial.Simple.Solver.html#2804" class="Function">solve</a> <a id="317" class="Symbol">to</a> <a id="320" href="Polynomial.Simple.Solver.html#2804" class="Function">solve′</a><a id="326" class="Symbol">)</a>
  <a id="330" class="Keyword">open</a> <a id="335" class="Keyword">import</a> <a id="342" href="Data.String.html" class="Module">Data.String</a>
  <a id="356" class="Keyword">open</a> <a id="361" class="Keyword">import</a> <a id="368" href="Relation.Nullary.html" class="Module">Relation.Nullary</a> <a id="385" class="Keyword">using</a> <a id="391" class="Symbol">(</a><a id="392" href="Relation.Nullary.html#570" class="Datatype">Dec</a><a id="395" class="Symbol">;</a> <a id="397" href="Relation.Nullary.html#606" class="InductiveConstructor">yes</a><a id="400" class="Symbol">;</a> <a id="402" href="Relation.Nullary.html#633" class="InductiveConstructor">no</a><a id="404" class="Symbol">)</a>
  <a id="408" class="Keyword">import</a> <a id="415" href="Data.Vec.html" class="Module">Data.Vec</a> <a id="424" class="Symbol">as</a> <a id="427" class="Module">Vec</a>
  <a id="433" class="Keyword">import</a> <a id="440" href="Data.Fin.html" class="Module">Data.Fin</a> <a id="449" class="Symbol">as</a> <a id="452" class="Module">Fin</a>

  <a id="459" class="Comment">-- Some patterns to decrease verbosity</a>
  <a id="500" class="Keyword">infixr</a> <a id="507" class="Number">5</a> <a id="509" href="Polynomial.Simple.Reflection.html#531" class="InductiveConstructor Operator">_⟨∷⟩_</a> <a id="515" href="Polynomial.Simple.Reflection.html#593" class="InductiveConstructor Operator">_⟅∷⟆_</a>
  <a id="523" class="Keyword">pattern</a> <a id="Internal._⟨∷⟩_"></a><a id="531" href="Polynomial.Simple.Reflection.html#531" class="InductiveConstructor Operator">_⟨∷⟩_</a> <a id="537" href="Polynomial.Simple.Reflection.html#576" class="Bound">x</a> <a id="539" href="Polynomial.Simple.Reflection.html#580" class="Bound">xs</a> <a id="542" class="Symbol">=</a> <a id="544" href="Agda.Builtin.Reflection.html#3069" class="InductiveConstructor">arg</a> <a id="548" class="Symbol">(</a><a id="549" href="Agda.Builtin.Reflection.html#2981" class="InductiveConstructor">arg-info</a> <a id="558" href="Agda.Builtin.Reflection.html#2549" class="InductiveConstructor">visible</a> <a id="566" href="Agda.Builtin.Reflection.html#2806" class="InductiveConstructor">relevant</a><a id="574" class="Symbol">)</a> <a id="576" href="Polynomial.Simple.Reflection.html#576" class="Bound">x</a> <a id="578" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="580" href="Polynomial.Simple.Reflection.html#580" class="Bound">xs</a>
  <a id="585" class="Keyword">pattern</a> <a id="Internal._⟅∷⟆_"></a><a id="593" href="Polynomial.Simple.Reflection.html#593" class="InductiveConstructor Operator">_⟅∷⟆_</a> <a id="599" href="Polynomial.Simple.Reflection.html#637" class="Bound">x</a> <a id="601" href="Polynomial.Simple.Reflection.html#641" class="Bound">xs</a> <a id="604" class="Symbol">=</a> <a id="606" href="Agda.Builtin.Reflection.html#3069" class="InductiveConstructor">arg</a> <a id="610" class="Symbol">(</a><a id="611" href="Agda.Builtin.Reflection.html#2981" class="InductiveConstructor">arg-info</a> <a id="620" href="Agda.Builtin.Reflection.html#2557" class="InductiveConstructor">hidden</a> <a id="627" href="Agda.Builtin.Reflection.html#2806" class="InductiveConstructor">relevant</a><a id="635" class="Symbol">)</a> <a id="637" href="Polynomial.Simple.Reflection.html#637" class="Bound">x</a> <a id="639" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="641" href="Polynomial.Simple.Reflection.html#641" class="Bound">xs</a>

  <a id="647" class="Keyword">infixr</a> <a id="654" class="Number">5</a> <a id="656" href="Polynomial.Simple.Reflection.html#665" class="Function Operator">_⋯⟅∷⟆_</a>
  <a id="Internal._⋯⟅∷⟆_"></a><a id="665" href="Polynomial.Simple.Reflection.html#665" class="Function Operator">_⋯⟅∷⟆_</a> <a id="672" class="Symbol">:</a> <a id="674" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="676" class="Symbol">→</a> <a id="678" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="683" class="Symbol">(</a><a id="684" href="Agda.Builtin.Reflection.html#3041" class="Datatype">Arg</a> <a id="688" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a><a id="692" class="Symbol">)</a> <a id="694" class="Symbol">→</a> <a id="696" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="701" class="Symbol">(</a><a id="702" href="Agda.Builtin.Reflection.html#3041" class="Datatype">Arg</a> <a id="706" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a><a id="710" class="Symbol">)</a>
  <a id="714" href="Agda.Builtin.Nat.html#115" class="InductiveConstructor">zero</a> <a id="719" href="Polynomial.Simple.Reflection.html#665" class="Function Operator">⋯⟅∷⟆</a> <a id="724" href="Polynomial.Simple.Reflection.html#724" class="Bound">xs</a> <a id="727" class="Symbol">=</a> <a id="729" href="Polynomial.Simple.Reflection.html#724" class="Bound">xs</a>
  <a id="734" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="738" href="Polynomial.Simple.Reflection.html#738" class="Bound">i</a> <a id="740" href="Polynomial.Simple.Reflection.html#665" class="Function Operator">⋯⟅∷⟆</a> <a id="745" href="Polynomial.Simple.Reflection.html#745" class="Bound">xs</a> <a id="748" class="Symbol">=</a> <a id="750" href="Agda.Builtin.Reflection.html#5048" class="InductiveConstructor">unknown</a> <a id="758" href="Polynomial.Simple.Reflection.html#593" class="InductiveConstructor Operator">⟅∷⟆</a>  <a id="763" href="Polynomial.Simple.Reflection.html#738" class="Bound">i</a> <a id="765" href="Polynomial.Simple.Reflection.html#665" class="Function Operator">⋯⟅∷⟆</a> <a id="770" href="Polynomial.Simple.Reflection.html#745" class="Bound">xs</a>

  <a id="Internal.natTerm"></a><a id="776" href="Polynomial.Simple.Reflection.html#776" class="Function">natTerm</a> <a id="784" class="Symbol">:</a> <a id="786" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="788" class="Symbol">→</a> <a id="790" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
  <a id="797" href="Polynomial.Simple.Reflection.html#776" class="Function">natTerm</a> <a id="805" href="Agda.Builtin.Nat.html#115" class="InductiveConstructor">zero</a> <a id="810" class="Symbol">=</a> <a id="812" class="Keyword">quote</a> <a id="818" href="Agda.Builtin.Nat.html#115" class="InductiveConstructor">zero</a> <a id="823" href="Function.html#2548" class="Function Operator">⟨</a> <a id="825" href="Agda.Builtin.Reflection.html#4648" class="InductiveConstructor">con</a> <a id="829" href="Function.html#2548" class="Function Operator">⟩</a> <a id="831" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>
  <a id="836" href="Polynomial.Simple.Reflection.html#776" class="Function">natTerm</a> <a id="844" class="Symbol">(</a><a id="845" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="849" href="Polynomial.Simple.Reflection.html#849" class="Bound">i</a><a id="850" class="Symbol">)</a> <a id="852" class="Symbol">=</a> <a id="854" class="Keyword">quote</a> <a id="860" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="864" href="Function.html#2548" class="Function Operator">⟨</a> <a id="866" href="Agda.Builtin.Reflection.html#4648" class="InductiveConstructor">con</a> <a id="870" href="Function.html#2548" class="Function Operator">⟩</a> <a id="872" href="Polynomial.Simple.Reflection.html#776" class="Function">natTerm</a> <a id="880" href="Polynomial.Simple.Reflection.html#849" class="Bound">i</a> <a id="882" href="Polynomial.Simple.Reflection.html#531" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="886" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>

  <a id="Internal.finTerm"></a><a id="892" href="Polynomial.Simple.Reflection.html#892" class="Function">finTerm</a> <a id="900" class="Symbol">:</a> <a id="902" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="904" class="Symbol">→</a> <a id="906" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
  <a id="913" href="Polynomial.Simple.Reflection.html#892" class="Function">finTerm</a> <a id="921" href="Agda.Builtin.Nat.html#115" class="InductiveConstructor">zero</a> <a id="926" class="Symbol">=</a> <a id="928" class="Keyword">quote</a> <a id="934" href="Data.Fin.Base.html#973" class="InductiveConstructor">Fin.zero</a> <a id="943" href="Function.html#2548" class="Function Operator">⟨</a> <a id="945" href="Agda.Builtin.Reflection.html#4648" class="InductiveConstructor">con</a> <a id="949" href="Function.html#2548" class="Function Operator">⟩</a> <a id="951" class="Number">1</a> <a id="953" href="Polynomial.Simple.Reflection.html#665" class="Function Operator">⋯⟅∷⟆</a> <a id="958" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>
  <a id="963" href="Polynomial.Simple.Reflection.html#892" class="Function">finTerm</a> <a id="971" class="Symbol">(</a><a id="972" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="976" href="Polynomial.Simple.Reflection.html#976" class="Bound">i</a><a id="977" class="Symbol">)</a> <a id="979" class="Symbol">=</a> <a id="981" class="Keyword">quote</a> <a id="987" href="Data.Fin.Base.html#1004" class="InductiveConstructor">Fin.suc</a> <a id="995" href="Function.html#2548" class="Function Operator">⟨</a> <a id="997" href="Agda.Builtin.Reflection.html#4648" class="InductiveConstructor">con</a> <a id="1001" href="Function.html#2548" class="Function Operator">⟩</a> <a id="1003" class="Number">1</a> <a id="1005" href="Polynomial.Simple.Reflection.html#665" class="Function Operator">⋯⟅∷⟆</a> <a id="1010" href="Polynomial.Simple.Reflection.html#892" class="Function">finTerm</a> <a id="1018" href="Polynomial.Simple.Reflection.html#976" class="Bound">i</a> <a id="1020" href="Polynomial.Simple.Reflection.html#531" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="1024" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>

  <a id="Internal.curriedTerm"></a><a id="1030" href="Polynomial.Simple.Reflection.html#1030" class="Function">curriedTerm</a> <a id="1042" class="Symbol">:</a> <a id="1044" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="1046" class="Symbol">→</a> <a id="1048" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
  <a id="1055" href="Polynomial.Simple.Reflection.html#1030" class="Function">curriedTerm</a> <a id="1067" class="Symbol">=</a> <a id="1069" href="Polynomial.Simple.Reflection.html#1091" class="Function">go</a> <a id="1072" href="Agda.Builtin.Nat.html#115" class="InductiveConstructor">zero</a>
    <a id="1081" class="Keyword">where</a>
    <a id="1091" href="Polynomial.Simple.Reflection.html#1091" class="Function">go</a> <a id="1094" class="Symbol">:</a> <a id="1096" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="1098" class="Symbol">→</a> <a id="1100" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="1102" class="Symbol">→</a> <a id="1104" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
    <a id="1113" href="Polynomial.Simple.Reflection.html#1091" class="Function">go</a> <a id="1116" href="Polynomial.Simple.Reflection.html#1116" class="Bound">k</a> <a id="1118" href="Agda.Builtin.Nat.html#115" class="InductiveConstructor">zero</a> <a id="1123" class="Symbol">=</a> <a id="1125" class="Keyword">quote</a> <a id="1131" href="Data.Vec.html#813" class="InductiveConstructor">Vec.[]</a> <a id="1138" href="Function.html#2548" class="Function Operator">⟨</a> <a id="1140" href="Agda.Builtin.Reflection.html#4648" class="InductiveConstructor">con</a> <a id="1144" href="Function.html#2548" class="Function Operator">⟩</a> <a id="1146" class="Number">2</a> <a id="1148" href="Polynomial.Simple.Reflection.html#665" class="Function Operator">⋯⟅∷⟆</a> <a id="1153" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>
    <a id="1160" href="Polynomial.Simple.Reflection.html#1091" class="Function">go</a> <a id="1163" href="Polynomial.Simple.Reflection.html#1163" class="Bound">k</a> <a id="1165" class="Symbol">(</a><a id="1166" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="1170" href="Polynomial.Simple.Reflection.html#1170" class="Bound">i</a><a id="1171" class="Symbol">)</a> <a id="1173" class="Symbol">=</a> <a id="1175" class="Keyword">quote</a> <a id="1181" href="Data.Vec.html#832" class="InductiveConstructor Operator">Vec._∷_</a> <a id="1189" href="Function.html#2548" class="Function Operator">⟨</a> <a id="1191" href="Agda.Builtin.Reflection.html#4648" class="InductiveConstructor">con</a> <a id="1195" href="Function.html#2548" class="Function Operator">⟩</a> <a id="1197" class="Number">2</a> <a id="1199" href="Polynomial.Simple.Reflection.html#665" class="Function Operator">⋯⟅∷⟆</a> <a id="1204" class="Number">1</a> <a id="1206" href="Polynomial.Simple.Reflection.html#665" class="Function Operator">⋯⟅∷⟆</a> <a id="1211" href="Agda.Builtin.Reflection.html#4592" class="InductiveConstructor">var</a> <a id="1215" href="Polynomial.Simple.Reflection.html#1163" class="Bound">k</a> <a id="1217" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a> <a id="1220" href="Polynomial.Simple.Reflection.html#531" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="1224" href="Polynomial.Simple.Reflection.html#1091" class="Function">go</a> <a id="1227" class="Symbol">(</a><a id="1228" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="1232" href="Polynomial.Simple.Reflection.html#1163" class="Bound">k</a><a id="1233" class="Symbol">)</a> <a id="1235" href="Polynomial.Simple.Reflection.html#1170" class="Bound">i</a> <a id="1237" href="Polynomial.Simple.Reflection.html#531" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="1241" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>

  <a id="Internal.hlams"></a><a id="1247" href="Polynomial.Simple.Reflection.html#1247" class="Function">hlams</a> <a id="1253" class="Symbol">:</a> <a id="1255" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="1260" href="Agda.Builtin.String.html#165" class="Postulate">String</a> <a id="1267" class="Symbol">→</a> <a id="1269" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="1274" class="Symbol">→</a> <a id="1276" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
  <a id="1283" href="Polynomial.Simple.Reflection.html#1247" class="Function">hlams</a> <a id="1289" href="Polynomial.Simple.Reflection.html#1289" class="Bound">vs</a> <a id="1292" href="Polynomial.Simple.Reflection.html#1292" class="Bound">xs</a> <a id="1295" class="Symbol">=</a> <a id="1297" href="Data.List.Base.html#3600" class="Function">foldr</a> <a id="1303" class="Symbol">(λ</a> <a id="1306" href="Polynomial.Simple.Reflection.html#1306" class="Bound">v</a> <a id="1308" href="Polynomial.Simple.Reflection.html#1308" class="Bound">vs</a> <a id="1311" class="Symbol">→</a> <a id="1313" href="Agda.Builtin.Reflection.html#4762" class="InductiveConstructor">lam</a> <a id="1317" href="Agda.Builtin.Reflection.html#2557" class="InductiveConstructor">hidden</a> <a id="1324" class="Symbol">(</a><a id="1325" href="Agda.Builtin.Reflection.html#3308" class="InductiveConstructor">abs</a> <a id="1329" href="Polynomial.Simple.Reflection.html#1306" class="Bound">v</a> <a id="1331" href="Polynomial.Simple.Reflection.html#1308" class="Bound">vs</a><a id="1333" class="Symbol">))</a> <a id="1336" href="Polynomial.Simple.Reflection.html#1292" class="Bound">xs</a> <a id="1339" href="Polynomial.Simple.Reflection.html#1289" class="Bound">vs</a>

  <a id="Internal.vlams"></a><a id="1345" href="Polynomial.Simple.Reflection.html#1345" class="Function">vlams</a> <a id="1351" class="Symbol">:</a> <a id="1353" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="1358" href="Agda.Builtin.String.html#165" class="Postulate">String</a> <a id="1365" class="Symbol">→</a> <a id="1367" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="1372" class="Symbol">→</a> <a id="1374" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
  <a id="1381" href="Polynomial.Simple.Reflection.html#1345" class="Function">vlams</a> <a id="1387" href="Polynomial.Simple.Reflection.html#1387" class="Bound">vs</a> <a id="1390" href="Polynomial.Simple.Reflection.html#1390" class="Bound">xs</a> <a id="1393" class="Symbol">=</a> <a id="1395" href="Data.List.Base.html#3600" class="Function">foldr</a> <a id="1401" class="Symbol">(λ</a> <a id="1404" href="Polynomial.Simple.Reflection.html#1404" class="Bound">v</a> <a id="1406" href="Polynomial.Simple.Reflection.html#1406" class="Bound">vs</a> <a id="1409" class="Symbol">→</a> <a id="1411" href="Agda.Builtin.Reflection.html#4762" class="InductiveConstructor">lam</a> <a id="1415" href="Agda.Builtin.Reflection.html#2549" class="InductiveConstructor">visible</a> <a id="1423" class="Symbol">(</a><a id="1424" href="Agda.Builtin.Reflection.html#3308" class="InductiveConstructor">abs</a> <a id="1428" href="Polynomial.Simple.Reflection.html#1404" class="Bound">v</a> <a id="1430" href="Polynomial.Simple.Reflection.html#1406" class="Bound">vs</a><a id="1432" class="Symbol">))</a> <a id="1435" href="Polynomial.Simple.Reflection.html#1390" class="Bound">xs</a> <a id="1438" href="Polynomial.Simple.Reflection.html#1387" class="Bound">vs</a>

  <a id="1444" class="Keyword">module</a> <a id="1451" href="Polynomial.Simple.Reflection.html#1451" class="Module">_</a> <a id="1453" class="Symbol">(</a><a id="1454" href="Polynomial.Simple.Reflection.html#1454" class="Bound">numVars</a> <a id="1462" class="Symbol">:</a> <a id="1464" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a><a id="1465" class="Symbol">)</a> <a id="1467" class="Keyword">where</a>

    <a id="1478" class="Comment">-- This function applies the hidden arguments that the constructors</a>
    <a id="1550" class="Comment">-- that Expr needs. The first is the universe level, the second is the</a>
    <a id="1625" class="Comment">-- type it contains, and the third is the number of variables it&#39;s</a>
    <a id="1696" class="Comment">-- indexed by. All three of these could likely be inferred, but to</a>
    <a id="1767" class="Comment">-- make things easier we supply the third because we know it.</a>
    <a id="1833" class="Keyword">infixr</a> <a id="1840" class="Number">5</a> <a id="1842" href="Polynomial.Simple.Reflection.html#1852" class="Function Operator">E⟅∷⟆_</a>
    <a id="1852" href="Polynomial.Simple.Reflection.html#1852" class="Function Operator">E⟅∷⟆_</a> <a id="1858" class="Symbol">:</a> <a id="1860" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="1865" class="Symbol">(</a><a id="1866" href="Agda.Builtin.Reflection.html#3041" class="Datatype">Arg</a> <a id="1870" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a><a id="1874" class="Symbol">)</a> <a id="1876" class="Symbol">→</a> <a id="1878" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="1883" class="Symbol">(</a><a id="1884" href="Agda.Builtin.Reflection.html#3041" class="Datatype">Arg</a> <a id="1888" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a><a id="1892" class="Symbol">)</a>
    <a id="1898" href="Polynomial.Simple.Reflection.html#1852" class="Function Operator">E⟅∷⟆</a> <a id="1903" href="Polynomial.Simple.Reflection.html#1903" class="Bound">xs</a> <a id="1906" class="Symbol">=</a> <a id="1908" class="Number">1</a> <a id="1910" href="Polynomial.Simple.Reflection.html#665" class="Function Operator">⋯⟅∷⟆</a>
              <a id="1929" class="Symbol">(</a><a id="1930" class="Keyword">quote</a> <a id="1936" href="Polynomial.Simple.AlmostCommutativeRing.html#1043" class="Field">AlmostCommutativeRing.Carrier</a> <a id="1966" href="Function.html#2548" class="Function Operator">⟨</a> <a id="1968" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="1972" href="Function.html#2548" class="Function Operator">⟩</a> <a id="1974" class="Number">2</a> <a id="1976" href="Polynomial.Simple.Reflection.html#665" class="Function Operator">⋯⟅∷⟆</a> <a id="1981" href="Polynomial.Simple.Reflection.html#244" class="Bound">rng</a> <a id="1985" href="Polynomial.Simple.Reflection.html#531" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="1989" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="1991" class="Symbol">)</a> <a id="1993" href="Polynomial.Simple.Reflection.html#593" class="InductiveConstructor Operator">⟅∷⟆</a>
              <a id="2011" href="Polynomial.Simple.Reflection.html#776" class="Function">natTerm</a> <a id="2019" href="Polynomial.Simple.Reflection.html#1454" class="Bound">numVars</a> <a id="2027" href="Polynomial.Simple.Reflection.html#593" class="InductiveConstructor Operator">⟅∷⟆</a>
              <a id="2045" href="Polynomial.Simple.Reflection.html#1903" class="Bound">xs</a>

    <a id="2053" class="Comment">-- A constant expression.</a>
    <a id="2083" href="Polynomial.Simple.Reflection.html#2083" class="Function">constExpr</a> <a id="2093" class="Symbol">:</a> <a id="2095" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="2100" class="Symbol">→</a> <a id="2102" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
    <a id="2111" href="Polynomial.Simple.Reflection.html#2083" class="Function">constExpr</a> <a id="2121" href="Polynomial.Simple.Reflection.html#2121" class="Bound">x</a> <a id="2123" class="Symbol">=</a> <a id="2125" class="Keyword">quote</a> <a id="2131" href="Polynomial.Expr.html#290" class="InductiveConstructor">Κ</a> <a id="2133" href="Function.html#2548" class="Function Operator">⟨</a> <a id="2135" href="Agda.Builtin.Reflection.html#4648" class="InductiveConstructor">con</a> <a id="2139" href="Function.html#2548" class="Function Operator">⟩</a> <a id="2141" href="Polynomial.Simple.Reflection.html#1852" class="Function Operator">E⟅∷⟆</a> <a id="2146" href="Polynomial.Simple.Reflection.html#2121" class="Bound">x</a> <a id="2148" href="Polynomial.Simple.Reflection.html#531" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="2152" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>

    <a id="2160" class="Keyword">module</a> <a id="ToExpr"></a><a id="2167" href="Polynomial.Simple.Reflection.html#2167" class="Module">ToExpr</a> <a id="2174" class="Symbol">(</a><a id="2175" href="Polynomial.Simple.Reflection.html#2175" class="Bound">varExpr</a> <a id="2183" class="Symbol">:</a> <a id="2185" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="2187" class="Symbol">→</a> <a id="2189" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a><a id="2193" class="Symbol">)</a> <a id="2195" class="Keyword">where</a>
      <a id="2207" class="Keyword">mutual</a>
        <a id="2222" class="Comment">-- Application of a ring operator often doesn&#39;t have a type as</a>
        <a id="2293" class="Comment">-- simple as &quot;Carrier → Carrier → Carrier&quot;: there may be hidden</a>
        <a id="2365" class="Comment">-- arguments, etc. Here, we do our best to handle those cases,</a>
        <a id="2436" class="Comment">-- by just taking the last two explicit arguments.</a>
        <a id="2495" href="Polynomial.Simple.Reflection.html#2495" class="Function">getBinOp</a> <a id="2504" class="Symbol">:</a> <a id="2506" href="Agda.Builtin.Reflection.html#363" class="Postulate">Name</a> <a id="2511" class="Symbol">→</a> <a id="2513" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="2518" class="Symbol">(</a><a id="2519" href="Agda.Builtin.Reflection.html#3041" class="Datatype">Arg</a> <a id="2523" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a><a id="2527" class="Symbol">)</a> <a id="2529" class="Symbol">→</a> <a id="2531" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
        <a id="2544" href="Polynomial.Simple.Reflection.html#2495" class="Function">getBinOp</a> <a id="2553" href="Polynomial.Simple.Reflection.html#2553" class="Bound">nm</a> <a id="2556" class="Symbol">(</a><a id="2557" href="Polynomial.Simple.Reflection.html#2557" class="Bound">x</a> <a id="2559" href="Polynomial.Simple.Reflection.html#531" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="2563" href="Polynomial.Simple.Reflection.html#2563" class="Bound">y</a> <a id="2565" href="Polynomial.Simple.Reflection.html#531" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="2569" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="2571" class="Symbol">)</a> <a id="2573" class="Symbol">=</a> <a id="2575" href="Polynomial.Simple.Reflection.html#2553" class="Bound">nm</a> <a id="2578" href="Function.html#2548" class="Function Operator">⟨</a> <a id="2580" href="Agda.Builtin.Reflection.html#4648" class="InductiveConstructor">con</a> <a id="2584" href="Function.html#2548" class="Function Operator">⟩</a> <a id="2586" href="Polynomial.Simple.Reflection.html#1852" class="Function Operator">E⟅∷⟆</a> <a id="2591" href="Polynomial.Simple.Reflection.html#3774" class="Function">toExpr</a> <a id="2598" href="Polynomial.Simple.Reflection.html#2557" class="Bound">x</a> <a id="2600" href="Polynomial.Simple.Reflection.html#531" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="2604" href="Polynomial.Simple.Reflection.html#3774" class="Function">toExpr</a> <a id="2611" href="Polynomial.Simple.Reflection.html#2563" class="Bound">y</a> <a id="2613" href="Polynomial.Simple.Reflection.html#531" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="2617" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>
        <a id="2628" href="Polynomial.Simple.Reflection.html#2495" class="CatchallClause Function">getBinOp</a><a id="2636" class="CatchallClause"> </a><a id="2637" href="Polynomial.Simple.Reflection.html#2637" class="CatchallClause Bound">nm</a><a id="2639" class="CatchallClause"> </a><a id="2640" class="CatchallClause Symbol">(</a><a id="2641" href="Polynomial.Simple.Reflection.html#2641" class="CatchallClause Bound">x</a><a id="2642" class="CatchallClause"> </a><a id="2643" href="Agda.Builtin.List.html#132" class="CatchallClause InductiveConstructor Operator">∷</a><a id="2644" class="CatchallClause"> </a><a id="2645" href="Polynomial.Simple.Reflection.html#2645" class="CatchallClause Bound">xs</a><a id="2647" class="CatchallClause Symbol">)</a> <a id="2649" class="Symbol">=</a> <a id="2651" href="Polynomial.Simple.Reflection.html#2495" class="Function">getBinOp</a> <a id="2660" href="Polynomial.Simple.Reflection.html#2637" class="Bound">nm</a> <a id="2663" href="Polynomial.Simple.Reflection.html#2645" class="Bound">xs</a>
        <a id="2674" href="Polynomial.Simple.Reflection.html#2495" class="CatchallClause Function">getBinOp</a><a id="2682" class="CatchallClause"> </a><a id="2683" class="CatchallClause Symbol">_</a><a id="2684" class="CatchallClause"> </a><a id="2685" class="CatchallClause Symbol">_</a> <a id="2687" class="Symbol">=</a> <a id="2689" href="Agda.Builtin.Reflection.html#5048" class="InductiveConstructor">unknown</a>

        <a id="2706" href="Polynomial.Simple.Reflection.html#2706" class="Function">getUnOp</a> <a id="2714" class="Symbol">:</a> <a id="2716" href="Agda.Builtin.Reflection.html#363" class="Postulate">Name</a> <a id="2721" class="Symbol">→</a> <a id="2723" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="2728" class="Symbol">(</a><a id="2729" href="Agda.Builtin.Reflection.html#3041" class="Datatype">Arg</a> <a id="2733" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a><a id="2737" class="Symbol">)</a> <a id="2739" class="Symbol">→</a> <a id="2741" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
        <a id="2754" href="Polynomial.Simple.Reflection.html#2706" class="Function">getUnOp</a> <a id="2762" href="Polynomial.Simple.Reflection.html#2762" class="Bound">nm</a> <a id="2765" class="Symbol">(</a><a id="2766" href="Polynomial.Simple.Reflection.html#2766" class="Bound">x</a> <a id="2768" href="Polynomial.Simple.Reflection.html#531" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="2772" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="2774" class="Symbol">)</a> <a id="2776" class="Symbol">=</a> <a id="2778" href="Polynomial.Simple.Reflection.html#2762" class="Bound">nm</a> <a id="2781" href="Function.html#2548" class="Function Operator">⟨</a> <a id="2783" href="Agda.Builtin.Reflection.html#4648" class="InductiveConstructor">con</a> <a id="2787" href="Function.html#2548" class="Function Operator">⟩</a> <a id="2789" href="Polynomial.Simple.Reflection.html#1852" class="Function Operator">E⟅∷⟆</a> <a id="2794" href="Polynomial.Simple.Reflection.html#3774" class="Function">toExpr</a> <a id="2801" href="Polynomial.Simple.Reflection.html#2766" class="Bound">x</a> <a id="2803" href="Polynomial.Simple.Reflection.html#531" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="2807" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>
        <a id="2818" href="Polynomial.Simple.Reflection.html#2706" class="CatchallClause Function">getUnOp</a><a id="2825" class="CatchallClause"> </a><a id="2826" href="Polynomial.Simple.Reflection.html#2826" class="CatchallClause Bound">nm</a><a id="2828" class="CatchallClause"> </a><a id="2829" class="CatchallClause Symbol">(</a><a id="2830" href="Polynomial.Simple.Reflection.html#2830" class="CatchallClause Bound">x</a><a id="2831" class="CatchallClause"> </a><a id="2832" href="Agda.Builtin.List.html#132" class="CatchallClause InductiveConstructor Operator">∷</a><a id="2833" class="CatchallClause"> </a><a id="2834" href="Polynomial.Simple.Reflection.html#2834" class="CatchallClause Bound">xs</a><a id="2836" class="CatchallClause Symbol">)</a> <a id="2838" class="Symbol">=</a> <a id="2840" href="Polynomial.Simple.Reflection.html#2706" class="Function">getUnOp</a> <a id="2848" href="Polynomial.Simple.Reflection.html#2826" class="Bound">nm</a> <a id="2851" href="Polynomial.Simple.Reflection.html#2834" class="Bound">xs</a>
        <a id="2862" href="Polynomial.Simple.Reflection.html#2706" class="CatchallClause Function">getUnOp</a><a id="2869" class="CatchallClause"> </a><a id="2870" class="CatchallClause Symbol">_</a><a id="2871" class="CatchallClause"> </a><a id="2872" class="CatchallClause Symbol">_</a> <a id="2874" class="Symbol">=</a> <a id="2876" href="Agda.Builtin.Reflection.html#5048" class="InductiveConstructor">unknown</a>

        <a id="2893" href="Polynomial.Simple.Reflection.html#2893" class="Function">getExp</a> <a id="2900" class="Symbol">:</a> <a id="2902" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="2907" class="Symbol">(</a><a id="2908" href="Agda.Builtin.Reflection.html#3041" class="Datatype">Arg</a> <a id="2912" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a><a id="2916" class="Symbol">)</a> <a id="2918" class="Symbol">→</a> <a id="2920" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
        <a id="2933" href="Polynomial.Simple.Reflection.html#2893" class="Function">getExp</a> <a id="2940" class="Symbol">(</a><a id="2941" href="Polynomial.Simple.Reflection.html#2941" class="Bound">x</a> <a id="2943" href="Polynomial.Simple.Reflection.html#531" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="2947" href="Polynomial.Simple.Reflection.html#2947" class="Bound">y</a> <a id="2949" href="Polynomial.Simple.Reflection.html#531" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="2953" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="2955" class="Symbol">)</a> <a id="2957" class="Symbol">=</a> <a id="2959" class="Keyword">quote</a> <a id="2965" href="Polynomial.Expr.html#414" class="InductiveConstructor Operator">_⊛_</a> <a id="2969" href="Function.html#2548" class="Function Operator">⟨</a> <a id="2971" href="Agda.Builtin.Reflection.html#4648" class="InductiveConstructor">con</a> <a id="2975" href="Function.html#2548" class="Function Operator">⟩</a> <a id="2977" href="Polynomial.Simple.Reflection.html#1852" class="Function Operator">E⟅∷⟆</a> <a id="2982" href="Polynomial.Simple.Reflection.html#3774" class="Function">toExpr</a> <a id="2989" href="Polynomial.Simple.Reflection.html#2941" class="Bound">x</a> <a id="2991" href="Polynomial.Simple.Reflection.html#531" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="2995" href="Polynomial.Simple.Reflection.html#2947" class="Bound">y</a> <a id="2997" href="Polynomial.Simple.Reflection.html#531" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="3001" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>
        <a id="3012" href="Polynomial.Simple.Reflection.html#2893" class="CatchallClause Function">getExp</a><a id="3018" class="CatchallClause"> </a><a id="3019" class="CatchallClause Symbol">(</a><a id="3020" href="Polynomial.Simple.Reflection.html#3020" class="CatchallClause Bound">x</a><a id="3021" class="CatchallClause"> </a><a id="3022" href="Agda.Builtin.List.html#132" class="CatchallClause InductiveConstructor Operator">∷</a><a id="3023" class="CatchallClause"> </a><a id="3024" href="Polynomial.Simple.Reflection.html#3024" class="CatchallClause Bound">xs</a><a id="3026" class="CatchallClause Symbol">)</a> <a id="3028" class="Symbol">=</a> <a id="3030" href="Polynomial.Simple.Reflection.html#2893" class="Function">getExp</a> <a id="3037" href="Polynomial.Simple.Reflection.html#3024" class="Bound">xs</a>
        <a id="3048" href="Polynomial.Simple.Reflection.html#2893" class="CatchallClause Function">getExp</a><a id="3054" class="CatchallClause"> </a><a id="3055" class="CatchallClause Symbol">_</a> <a id="3057" class="Symbol">=</a> <a id="3059" href="Agda.Builtin.Reflection.html#5048" class="InductiveConstructor">unknown</a>

        <a id="3076" class="Comment">-- When trying to figure out the shape of an expression, one of</a>
        <a id="3148" class="Comment">-- the difficult tasks is recognizing where constants in the</a>
        <a id="3217" class="Comment">-- underlying ring are used. If we were only dealing with ℕ, we</a>
        <a id="3289" class="Comment">-- might look for its constructors: however, we want to deal with</a>
        <a id="3363" class="Comment">-- arbitrary types which implement AlmostCommutativeRing. If the</a>
        <a id="3436" class="Comment">-- Term type contained type information we might be able to</a>
        <a id="3504" class="Comment">-- recognize it there, but it doesn&#39;t.</a>
        <a id="3551" class="Comment">--</a>
        <a id="3562" class="Comment">-- We&#39;re in luck, though, because all other cases in the following</a>
        <a id="3637" class="Comment">-- function *are* recognizable. As a result, the &quot;catch-all&quot; case</a>
        <a id="3711" class="Comment">-- will just assume that it has a constant expression.</a>
        <a id="3774" href="Polynomial.Simple.Reflection.html#3774" class="Function">toExpr</a> <a id="3781" class="Symbol">:</a> <a id="3783" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="3788" class="Symbol">→</a> <a id="3790" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
        <a id="3803" href="Polynomial.Simple.Reflection.html#3774" class="Function">toExpr</a> <a id="3810" class="Symbol">(</a><a id="3811" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="3815" class="Symbol">(</a><a id="3816" class="Keyword">quote</a> <a id="3822" href="Polynomial.Simple.AlmostCommutativeRing.html#1123" class="Field Operator">AlmostCommutativeRing._+_</a><a id="3847" class="Symbol">)</a> <a id="3849" href="Polynomial.Simple.Reflection.html#3849" class="Bound">xs</a><a id="3851" class="Symbol">)</a> <a id="3853" class="Symbol">=</a> <a id="3855" href="Polynomial.Simple.Reflection.html#2495" class="Function">getBinOp</a> <a id="3864" class="Symbol">(</a><a id="3865" class="Keyword">quote</a> <a id="3871" href="Polynomial.Expr.html#336" class="InductiveConstructor Operator">_⊕_</a><a id="3874" class="Symbol">)</a> <a id="3876" href="Polynomial.Simple.Reflection.html#3849" class="Bound">xs</a>
        <a id="3887" href="Polynomial.Simple.Reflection.html#3774" class="Function">toExpr</a> <a id="3894" class="Symbol">(</a><a id="3895" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="3899" class="Symbol">(</a><a id="3900" class="Keyword">quote</a> <a id="3906" href="Polynomial.Simple.AlmostCommutativeRing.html#1165" class="Field Operator">AlmostCommutativeRing._*_</a><a id="3931" class="Symbol">)</a> <a id="3933" href="Polynomial.Simple.Reflection.html#3933" class="Bound">xs</a><a id="3935" class="Symbol">)</a> <a id="3937" class="Symbol">=</a> <a id="3939" href="Polynomial.Simple.Reflection.html#2495" class="Function">getBinOp</a> <a id="3948" class="Symbol">(</a><a id="3949" class="Keyword">quote</a> <a id="3955" href="Polynomial.Expr.html#375" class="InductiveConstructor Operator">_⊗_</a><a id="3958" class="Symbol">)</a> <a id="3960" href="Polynomial.Simple.Reflection.html#3933" class="Bound">xs</a>
        <a id="3971" href="Polynomial.Simple.Reflection.html#3774" class="Function">toExpr</a> <a id="3978" class="Symbol">(</a><a id="3979" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="3983" class="Symbol">(</a><a id="3984" class="Keyword">quote</a> <a id="3990" href="Polynomial.Simple.AlmostCommutativeRing.html#2058" class="Function Operator">AlmostCommutativeRing._^_</a><a id="4015" class="Symbol">)</a> <a id="4017" href="Polynomial.Simple.Reflection.html#4017" class="Bound">xs</a><a id="4019" class="Symbol">)</a> <a id="4021" class="Symbol">=</a> <a id="4023" href="Polynomial.Simple.Reflection.html#2893" class="Function">getExp</a> <a id="4030" href="Polynomial.Simple.Reflection.html#4017" class="Bound">xs</a>
        <a id="4041" href="Polynomial.Simple.Reflection.html#3774" class="Function">toExpr</a> <a id="4048" class="Symbol">(</a><a id="4049" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="4053" class="Symbol">(</a><a id="4054" class="Keyword">quote</a> <a id="4060" href="Polynomial.Simple.AlmostCommutativeRing.html#1207" class="Field Operator">AlmostCommutativeRing.-_</a><a id="4084" class="Symbol">)</a> <a id="4086" href="Polynomial.Simple.Reflection.html#4086" class="Bound">xs</a><a id="4088" class="Symbol">)</a> <a id="4090" class="Symbol">=</a> <a id="4092" href="Polynomial.Simple.Reflection.html#2706" class="Function">getUnOp</a> <a id="4100" class="Symbol">(</a><a id="4101" class="Keyword">quote</a> <a id="4107" href="Polynomial.Expr.html#446" class="InductiveConstructor Operator">⊝_</a><a id="4109" class="Symbol">)</a> <a id="4111" href="Polynomial.Simple.Reflection.html#4086" class="Bound">xs</a>
        <a id="4122" href="Polynomial.Simple.Reflection.html#3774" class="Function">toExpr</a> <a id="4129" href="Polynomial.Simple.Reflection.html#4129" class="Bound">v</a><a id="4130" class="Symbol">@(</a><a id="4132" href="Agda.Builtin.Reflection.html#4592" class="InductiveConstructor">var</a> <a id="4136" href="Polynomial.Simple.Reflection.html#4136" class="Bound">x</a> <a id="4138" href="Polynomial.Simple.Reflection.html#4138" class="Bound">args</a><a id="4142" class="Symbol">)</a> <a id="4144" class="Keyword">with</a> <a id="4149" href="Polynomial.Simple.Reflection.html#4136" class="Bound">x</a> <a id="4151" href="Data.Nat.Properties.html#5343" class="Function Operator">ℕ.&lt;?</a> <a id="4156" href="Polynomial.Simple.Reflection.html#1454" class="Bound">numVars</a>
        <a id="4172" class="Symbol">...</a> <a id="4176" class="Symbol">|</a> <a id="4178" href="Relation.Nullary.html#606" class="InductiveConstructor">yes</a> <a id="4182" href="Polynomial.Simple.Reflection.html#4182" class="Bound">p</a> <a id="4184" class="Symbol">=</a> <a id="4186" href="Polynomial.Simple.Reflection.html#2175" class="Bound">varExpr</a> <a id="4194" class="Bound">x</a>
        <a id="4204" class="Symbol">...</a> <a id="4208" class="Symbol">|</a> <a id="4210" href="Relation.Nullary.html#633" class="InductiveConstructor">no</a> <a id="4213" href="Polynomial.Simple.Reflection.html#4213" class="Bound">¬p</a> <a id="4216" class="Symbol">=</a> <a id="4218" href="Polynomial.Simple.Reflection.html#2083" class="Function">constExpr</a> <a id="4228" class="Bound">v</a>
        <a id="4238" class="Symbol">{-#</a> <a id="4242" class="Keyword">CATCHALL</a> <a id="4251" class="Symbol">#-}</a>
        <a id="4263" href="Polynomial.Simple.Reflection.html#3774" class="Function">toExpr</a> <a id="4270" href="Polynomial.Simple.Reflection.html#4270" class="Bound">t</a> <a id="4272" class="Symbol">=</a> <a id="4274" href="Polynomial.Simple.Reflection.html#2083" class="Function">constExpr</a> <a id="4284" href="Polynomial.Simple.Reflection.html#4270" class="Bound">t</a>

    <a id="4291" href="Polynomial.Simple.Reflection.html#4291" class="Function">mkSolver</a> <a id="4300" class="Symbol">:</a> <a id="4302" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="4307" href="Agda.Builtin.String.html#165" class="Postulate">String</a> <a id="4314" class="Symbol">→</a> <a id="4316" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="4321" class="Symbol">→</a> <a id="4323" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="4328" class="Symbol">→</a> <a id="4330" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="4335" class="Symbol">(</a><a id="4336" href="Agda.Builtin.Reflection.html#3041" class="Datatype">Arg</a> <a id="4340" href="Agda.Builtin.Reflection.html#4561" class="Function">Type</a><a id="4344" class="Symbol">)</a>
    <a id="4350" href="Polynomial.Simple.Reflection.html#4291" class="Function">mkSolver</a> <a id="4359" href="Polynomial.Simple.Reflection.html#4359" class="Bound">nms</a> <a id="4363" href="Polynomial.Simple.Reflection.html#4363" class="Bound">lhs</a> <a id="4367" href="Polynomial.Simple.Reflection.html#4367" class="Bound">rhs</a> <a id="4371" class="Symbol">=</a>
        <a id="4381" class="Number">2</a> <a id="4383" href="Polynomial.Simple.Reflection.html#665" class="Function Operator">⋯⟅∷⟆</a>
        <a id="4396" href="Polynomial.Simple.Reflection.html#244" class="Bound">rng</a> <a id="4400" href="Polynomial.Simple.Reflection.html#531" class="InductiveConstructor Operator">⟨∷⟩</a>
        <a id="4412" href="Polynomial.Simple.Reflection.html#776" class="Function">natTerm</a> <a id="4420" href="Polynomial.Simple.Reflection.html#1454" class="Bound">numVars</a> <a id="4428" href="Polynomial.Simple.Reflection.html#531" class="InductiveConstructor Operator">⟨∷⟩</a>
        <a id="4440" href="Polynomial.Simple.Reflection.html#1345" class="Function">vlams</a> <a id="4446" href="Polynomial.Simple.Reflection.html#4359" class="Bound">nms</a> <a id="4450" class="Symbol">(</a><a id="4451" class="Keyword">quote</a> <a id="4457" href="Polynomial.Simple.Solver.html#3445" class="Function Operator">_⊜_</a> <a id="4461" href="Function.html#2548" class="Function Operator">⟨</a> <a id="4463" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="4467" href="Function.html#2548" class="Function Operator">⟩</a> <a id="4469" class="Number">2</a> <a id="4471" href="Polynomial.Simple.Reflection.html#665" class="Function Operator">⋯⟅∷⟆</a> <a id="4476" href="Polynomial.Simple.Reflection.html#244" class="Bound">rng</a> <a id="4480" href="Polynomial.Simple.Reflection.html#531" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="4484" href="Polynomial.Simple.Reflection.html#776" class="Function">natTerm</a> <a id="4492" href="Polynomial.Simple.Reflection.html#1454" class="Bound">numVars</a> <a id="4500" href="Polynomial.Simple.Reflection.html#531" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="4504" href="Polynomial.Simple.Reflection.html#3774" class="Function">toExpr</a> <a id="4511" href="Polynomial.Simple.Reflection.html#4363" class="Bound">lhs</a> <a id="4515" href="Polynomial.Simple.Reflection.html#531" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="4519" href="Polynomial.Simple.Reflection.html#3774" class="Function">toExpr</a> <a id="4526" href="Polynomial.Simple.Reflection.html#4367" class="Bound">rhs</a> <a id="4530" href="Polynomial.Simple.Reflection.html#531" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="4534" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="4536" class="Symbol">)</a> <a id="4538" href="Polynomial.Simple.Reflection.html#531" class="InductiveConstructor Operator">⟨∷⟩</a>
        <a id="4550" href="Polynomial.Simple.Reflection.html#1247" class="Function">hlams</a> <a id="4556" href="Polynomial.Simple.Reflection.html#4359" class="Bound">nms</a> <a id="4560" class="Symbol">(</a><a id="4561" class="Keyword">quote</a> <a id="4567" href="Polynomial.Simple.AlmostCommutativeRing.html#2136" class="Function">AlmostCommutativeRing.refl</a> <a id="4594" href="Function.html#2548" class="Function Operator">⟨</a> <a id="4596" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="4600" href="Function.html#2548" class="Function Operator">⟩</a> <a id="4602" class="Number">2</a> <a id="4604" href="Polynomial.Simple.Reflection.html#665" class="Function Operator">⋯⟅∷⟆</a> <a id="4609" href="Polynomial.Simple.Reflection.html#244" class="Bound">rng</a> <a id="4613" href="Polynomial.Simple.Reflection.html#531" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="4617" class="Number">1</a> <a id="4619" href="Polynomial.Simple.Reflection.html#665" class="Function Operator">⋯⟅∷⟆</a> <a id="4624" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="4626" class="Symbol">)</a> <a id="4628" href="Polynomial.Simple.Reflection.html#531" class="InductiveConstructor Operator">⟨∷⟩</a>
        <a id="4640" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>
      <a id="4649" class="Keyword">where</a>
      <a id="4661" class="Keyword">open</a> <a id="4666" href="Polynomial.Simple.Reflection.html#2167" class="Module">ToExpr</a> <a id="4673" class="Symbol">(λ</a> <a id="4676" href="Polynomial.Simple.Reflection.html#4676" class="Bound">x</a> <a id="4678" class="Symbol">→</a> <a id="4680" href="Agda.Builtin.Reflection.html#4592" class="InductiveConstructor">var</a> <a id="4684" href="Polynomial.Simple.Reflection.html#4676" class="Bound">x</a> <a id="4686" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="4688" class="Symbol">)</a>

    <a id="4695" href="Polynomial.Simple.Reflection.html#4695" class="Function">mkSolver′</a> <a id="4705" class="Symbol">:</a> <a id="4707" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="4712" class="Symbol">→</a> <a id="4714" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="4719" class="Symbol">→</a> <a id="4721" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
    <a id="4730" href="Polynomial.Simple.Reflection.html#4695" class="Function">mkSolver′</a> <a id="4740" href="Polynomial.Simple.Reflection.html#4740" class="Bound">lhs</a> <a id="4744" href="Polynomial.Simple.Reflection.html#4744" class="Bound">rhs</a> <a id="4748" class="Symbol">=</a>
      <a id="4756" class="Keyword">quote</a> <a id="4762" href="Relation.Binary.Core.html#5860" class="Function">AlmostCommutativeRing.trans</a> <a id="4790" href="Function.html#2548" class="Function Operator">⟨</a> <a id="4792" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="4796" href="Function.html#2548" class="Function Operator">⟩</a>
        <a id="4806" class="Number">2</a> <a id="4808" href="Polynomial.Simple.Reflection.html#665" class="Function Operator">⋯⟅∷⟆</a>
        <a id="4821" href="Polynomial.Simple.Reflection.html#244" class="Bound">rng</a> <a id="4825" href="Polynomial.Simple.Reflection.html#531" class="InductiveConstructor Operator">⟨∷⟩</a>
        <a id="4837" class="Number">3</a> <a id="4839" href="Polynomial.Simple.Reflection.html#665" class="Function Operator">⋯⟅∷⟆</a>
        <a id="4852" class="Symbol">(</a><a id="4853" class="Keyword">quote</a> <a id="4859" href="Relation.Binary.Core.html#5834" class="Function">AlmostCommutativeRing.sym</a> <a id="4885" href="Function.html#2548" class="Function Operator">⟨</a> <a id="4887" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="4891" href="Function.html#2548" class="Function Operator">⟩</a>
            <a id="4905" class="Symbol">(</a><a id="4906" class="Number">2</a> <a id="4908" href="Polynomial.Simple.Reflection.html#665" class="Function Operator">⋯⟅∷⟆</a>
            <a id="4925" href="Polynomial.Simple.Reflection.html#244" class="Bound">rng</a> <a id="4929" href="Polynomial.Simple.Reflection.html#531" class="InductiveConstructor Operator">⟨∷⟩</a>
            <a id="4945" class="Number">2</a> <a id="4947" href="Polynomial.Simple.Reflection.html#665" class="Function Operator">⋯⟅∷⟆</a>
            <a id="4964" class="Symbol">(</a><a id="4965" class="Keyword">quote</a> <a id="4971" href="Polynomial.Simple.Solver.html#2088" class="Function">Ops.correct</a> <a id="4983" href="Function.html#2548" class="Function Operator">⟨</a> <a id="4985" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="4989" href="Function.html#2548" class="Function Operator">⟩</a> <a id="4991" class="Number">2</a> <a id="4993" href="Polynomial.Simple.Reflection.html#665" class="Function Operator">⋯⟅∷⟆</a> <a id="4998" href="Polynomial.Simple.Reflection.html#244" class="Bound">rng</a> <a id="5002" href="Polynomial.Simple.Reflection.html#531" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="5006" class="Number">1</a> <a id="5008" href="Polynomial.Simple.Reflection.html#665" class="Function Operator">⋯⟅∷⟆</a> <a id="5013" href="Polynomial.Simple.Reflection.html#3774" class="Function">toExpr</a> <a id="5020" href="Polynomial.Simple.Reflection.html#4740" class="Bound">lhs</a> <a id="5024" href="Polynomial.Simple.Reflection.html#531" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="5028" href="Polynomial.Simple.Reflection.html#5250" class="Function">ρ</a> <a id="5030" href="Polynomial.Simple.Reflection.html#531" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="5034" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="5036" class="Symbol">)</a> <a id="5038" href="Polynomial.Simple.Reflection.html#531" class="InductiveConstructor Operator">⟨∷⟩</a>
            <a id="5054" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="5056" class="Symbol">))</a>
        <a id="5067" href="Polynomial.Simple.Reflection.html#531" class="InductiveConstructor Operator">⟨∷⟩</a>
        <a id="5079" class="Symbol">(</a><a id="5080" class="Keyword">quote</a> <a id="5086" href="Polynomial.Simple.Solver.html#2088" class="Function">Ops.correct</a> <a id="5098" href="Function.html#2548" class="Function Operator">⟨</a> <a id="5100" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="5104" href="Function.html#2548" class="Function Operator">⟩</a> <a id="5106" class="Number">2</a> <a id="5108" href="Polynomial.Simple.Reflection.html#665" class="Function Operator">⋯⟅∷⟆</a> <a id="5113" href="Polynomial.Simple.Reflection.html#244" class="Bound">rng</a> <a id="5117" href="Polynomial.Simple.Reflection.html#531" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="5121" class="Number">1</a> <a id="5123" href="Polynomial.Simple.Reflection.html#665" class="Function Operator">⋯⟅∷⟆</a> <a id="5128" href="Polynomial.Simple.Reflection.html#3774" class="Function">toExpr</a> <a id="5135" href="Polynomial.Simple.Reflection.html#4744" class="Bound">rhs</a> <a id="5139" href="Polynomial.Simple.Reflection.html#531" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="5143" href="Polynomial.Simple.Reflection.html#5250" class="Function">ρ</a> <a id="5145" href="Polynomial.Simple.Reflection.html#531" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="5149" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="5151" class="Symbol">)</a> <a id="5153" href="Polynomial.Simple.Reflection.html#531" class="InductiveConstructor Operator">⟨∷⟩</a>
        <a id="5165" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>
      <a id="5174" class="Keyword">where</a>
      <a id="5186" class="Keyword">open</a> <a id="5191" href="Polynomial.Simple.Reflection.html#2167" class="Module">ToExpr</a> <a id="5198" class="Symbol">(λ</a> <a id="5201" href="Polynomial.Simple.Reflection.html#5201" class="Bound">x</a> <a id="5203" class="Symbol">→</a> <a id="5205" class="Keyword">quote</a> <a id="5211" href="Polynomial.Expr.html#311" class="InductiveConstructor">Ι</a> <a id="5213" href="Function.html#2548" class="Function Operator">⟨</a> <a id="5215" href="Agda.Builtin.Reflection.html#4648" class="InductiveConstructor">con</a> <a id="5219" href="Function.html#2548" class="Function Operator">⟩</a> <a id="5221" href="Polynomial.Simple.Reflection.html#1852" class="Function Operator">E⟅∷⟆</a> <a id="5226" href="Polynomial.Simple.Reflection.html#892" class="Function">finTerm</a> <a id="5234" href="Polynomial.Simple.Reflection.html#5201" class="Bound">x</a> <a id="5236" href="Polynomial.Simple.Reflection.html#531" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="5240" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="5242" class="Symbol">)</a>
      <a id="5250" href="Polynomial.Simple.Reflection.html#5250" class="Function">ρ</a> <a id="5252" class="Symbol">:</a> <a id="5254" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
      <a id="5265" href="Polynomial.Simple.Reflection.html#5250" class="Function">ρ</a> <a id="5267" class="Symbol">=</a> <a id="5269" href="Polynomial.Simple.Reflection.html#1030" class="Function">curriedTerm</a> <a id="5281" href="Polynomial.Simple.Reflection.html#1454" class="Bound">numVars</a>

  <a id="Internal.toSoln"></a><a id="5292" href="Polynomial.Simple.Reflection.html#5292" class="Function">toSoln</a> <a id="5299" class="Symbol">:</a> <a id="5301" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="5306" class="Symbol">→</a> <a id="5308" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
  <a id="5315" href="Polynomial.Simple.Reflection.html#5292" class="Function">toSoln</a> <a id="5322" class="Symbol">=</a> <a id="5324" href="Polynomial.Simple.Reflection.html#5346" class="Function">go</a> <a id="5327" class="Number">0</a> <a id="5329" href="Function.html#1104" class="Function">id</a>
    <a id="5336" class="Keyword">where</a>
    <a id="5346" href="Polynomial.Simple.Reflection.html#5346" class="Function">go</a> <a id="5349" class="Symbol">:</a> <a id="5351" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="5353" class="Symbol">→</a> <a id="5355" class="Symbol">(</a><a id="5356" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="5361" href="Agda.Builtin.String.html#165" class="Postulate">String</a> <a id="5368" class="Symbol">→</a> <a id="5370" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="5375" href="Agda.Builtin.String.html#165" class="Postulate">String</a><a id="5381" class="Symbol">)</a> <a id="5383" class="Symbol">→</a> <a id="5385" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="5390" class="Symbol">→</a> <a id="5392" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
    <a id="5401" href="Polynomial.Simple.Reflection.html#5346" class="Function">go</a> <a id="5404" href="Polynomial.Simple.Reflection.html#5404" class="Bound">i</a> <a id="5406" href="Polynomial.Simple.Reflection.html#5406" class="Bound">k</a> <a id="5408" class="Symbol">(</a><a id="5409" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="5413" href="Polynomial.Simple.Reflection.html#5413" class="Bound">f</a> <a id="5415" class="Symbol">(</a>            <a id="5428" href="Polynomial.Simple.Reflection.html#5428" class="Bound">lhs</a> <a id="5432" href="Polynomial.Simple.Reflection.html#531" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="5436" href="Polynomial.Simple.Reflection.html#5436" class="Bound">rhs</a> <a id="5440" href="Polynomial.Simple.Reflection.html#531" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="5444" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="5446" class="Symbol">))</a> <a id="5449" class="Symbol">=</a> <a id="5451" class="Keyword">quote</a> <a id="5457" href="Polynomial.Simple.Solver.html#2804" class="Function">solve′</a> <a id="5464" href="Function.html#2548" class="Function Operator">⟨</a> <a id="5466" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="5470" href="Function.html#2548" class="Function Operator">⟩</a> <a id="5472" href="Polynomial.Simple.Reflection.html#4291" class="Function">mkSolver</a> <a id="5481" href="Polynomial.Simple.Reflection.html#5404" class="Bound">i</a> <a id="5483" class="Symbol">(</a><a id="5484" href="Polynomial.Simple.Reflection.html#5406" class="Bound">k</a> <a id="5486" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="5488" class="Symbol">)</a> <a id="5490" href="Polynomial.Simple.Reflection.html#5428" class="Bound">lhs</a> <a id="5494" href="Polynomial.Simple.Reflection.html#5436" class="Bound">rhs</a>
    <a id="5502" href="Polynomial.Simple.Reflection.html#5346" class="CatchallClause Function">go</a><a id="5504" class="CatchallClause"> </a><a id="5505" href="Polynomial.Simple.Reflection.html#5505" class="CatchallClause Bound">i</a><a id="5506" class="CatchallClause"> </a><a id="5507" href="Polynomial.Simple.Reflection.html#5507" class="CatchallClause Bound">k</a><a id="5508" class="CatchallClause"> </a><a id="5509" class="CatchallClause Symbol">(</a><a id="5510" href="Agda.Builtin.Reflection.html#4705" class="CatchallClause InductiveConstructor">def</a><a id="5513" class="CatchallClause"> </a><a id="5514" href="Polynomial.Simple.Reflection.html#5514" class="CatchallClause Bound">f</a><a id="5515" class="CatchallClause"> </a><a id="5516" class="CatchallClause Symbol">(</a><a id="5517" class="CatchallClause">    </a><a id="5521" class="CatchallClause Symbol">_</a><a id="5522" class="CatchallClause"> </a><a id="5523" href="Agda.Builtin.List.html#132" class="CatchallClause InductiveConstructor Operator">∷</a><a id="5524" class="CatchallClause"> </a><a id="5525" class="CatchallClause Symbol">_</a><a id="5526" class="CatchallClause"> </a><a id="5527" href="Agda.Builtin.List.html#132" class="CatchallClause InductiveConstructor Operator">∷</a><a id="5528" class="CatchallClause"> </a><a id="5529" href="Polynomial.Simple.Reflection.html#5529" class="CatchallClause Bound">lhs</a><a id="5532" class="CatchallClause"> </a><a id="5533" href="Polynomial.Simple.Reflection.html#531" class="CatchallClause InductiveConstructor Operator">⟨∷⟩</a><a id="5536" class="CatchallClause"> </a><a id="5537" href="Polynomial.Simple.Reflection.html#5537" class="CatchallClause Bound">rhs</a><a id="5540" class="CatchallClause"> </a><a id="5541" href="Polynomial.Simple.Reflection.html#531" class="CatchallClause InductiveConstructor Operator">⟨∷⟩</a><a id="5544" class="CatchallClause"> </a><a id="5545" href="Agda.Builtin.List.html#117" class="CatchallClause InductiveConstructor">[]</a><a id="5547" class="CatchallClause Symbol">))</a> <a id="5550" class="Symbol">=</a> <a id="5552" class="Keyword">quote</a> <a id="5558" href="Polynomial.Simple.Solver.html#2804" class="Function">solve′</a> <a id="5565" href="Function.html#2548" class="Function Operator">⟨</a> <a id="5567" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="5571" href="Function.html#2548" class="Function Operator">⟩</a> <a id="5573" href="Polynomial.Simple.Reflection.html#4291" class="Function">mkSolver</a> <a id="5582" href="Polynomial.Simple.Reflection.html#5505" class="Bound">i</a> <a id="5584" class="Symbol">(</a><a id="5585" href="Polynomial.Simple.Reflection.html#5507" class="Bound">k</a> <a id="5587" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="5589" class="Symbol">)</a> <a id="5591" href="Polynomial.Simple.Reflection.html#5529" class="Bound">lhs</a> <a id="5595" href="Polynomial.Simple.Reflection.html#5537" class="Bound">rhs</a>
    <a id="5603" href="Polynomial.Simple.Reflection.html#5346" class="CatchallClause Function">go</a><a id="5605" class="CatchallClause"> </a><a id="5606" href="Polynomial.Simple.Reflection.html#5606" class="CatchallClause Bound">i</a><a id="5607" class="CatchallClause"> </a><a id="5608" href="Polynomial.Simple.Reflection.html#5608" class="CatchallClause Bound">k</a><a id="5609" class="CatchallClause"> </a><a id="5610" class="CatchallClause Symbol">(</a><a id="5611" href="Agda.Builtin.Reflection.html#4705" class="CatchallClause InductiveConstructor">def</a><a id="5614" class="CatchallClause"> </a><a id="5615" href="Polynomial.Simple.Reflection.html#5615" class="CatchallClause Bound">f</a><a id="5616" class="CatchallClause"> </a><a id="5617" class="CatchallClause Symbol">(_</a><a id="5619" class="CatchallClause"> </a><a id="5620" href="Agda.Builtin.List.html#132" class="CatchallClause InductiveConstructor Operator">∷</a><a id="5621" class="CatchallClause"> </a><a id="5622" class="CatchallClause Symbol">_</a><a id="5623" class="CatchallClause"> </a><a id="5624" href="Agda.Builtin.List.html#132" class="CatchallClause InductiveConstructor Operator">∷</a><a id="5625" class="CatchallClause"> </a><a id="5626" class="CatchallClause Symbol">_</a><a id="5627" class="CatchallClause"> </a><a id="5628" href="Agda.Builtin.List.html#132" class="CatchallClause InductiveConstructor Operator">∷</a><a id="5629" class="CatchallClause"> </a><a id="5630" href="Polynomial.Simple.Reflection.html#5630" class="CatchallClause Bound">lhs</a><a id="5633" class="CatchallClause"> </a><a id="5634" href="Polynomial.Simple.Reflection.html#531" class="CatchallClause InductiveConstructor Operator">⟨∷⟩</a><a id="5637" class="CatchallClause"> </a><a id="5638" href="Polynomial.Simple.Reflection.html#5638" class="CatchallClause Bound">rhs</a><a id="5641" class="CatchallClause"> </a><a id="5642" href="Polynomial.Simple.Reflection.html#531" class="CatchallClause InductiveConstructor Operator">⟨∷⟩</a><a id="5645" class="CatchallClause"> </a><a id="5646" href="Agda.Builtin.List.html#117" class="CatchallClause InductiveConstructor">[]</a><a id="5648" class="CatchallClause Symbol">))</a> <a id="5651" class="Symbol">=</a> <a id="5653" class="Keyword">quote</a> <a id="5659" href="Polynomial.Simple.Solver.html#2804" class="Function">solve′</a> <a id="5666" href="Function.html#2548" class="Function Operator">⟨</a> <a id="5668" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="5672" href="Function.html#2548" class="Function Operator">⟩</a> <a id="5674" href="Polynomial.Simple.Reflection.html#4291" class="Function">mkSolver</a> <a id="5683" href="Polynomial.Simple.Reflection.html#5606" class="Bound">i</a> <a id="5685" class="Symbol">(</a><a id="5686" href="Polynomial.Simple.Reflection.html#5608" class="Bound">k</a> <a id="5688" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="5690" class="Symbol">)</a> <a id="5692" href="Polynomial.Simple.Reflection.html#5630" class="Bound">lhs</a> <a id="5696" href="Polynomial.Simple.Reflection.html#5638" class="Bound">rhs</a>
    <a id="5704" href="Polynomial.Simple.Reflection.html#5346" class="Function">go</a> <a id="5707" href="Polynomial.Simple.Reflection.html#5707" class="Bound">i</a> <a id="5709" href="Polynomial.Simple.Reflection.html#5709" class="Bound">k</a> <a id="5711" class="Symbol">(</a><a id="5712" href="Agda.Builtin.Reflection.html#4880" class="InductiveConstructor">pi</a> <a id="5715" href="Polynomial.Simple.Reflection.html#5715" class="Bound">a</a> <a id="5717" class="Symbol">(</a><a id="5718" href="Agda.Builtin.Reflection.html#3308" class="InductiveConstructor">abs</a> <a id="5722" href="Polynomial.Simple.Reflection.html#5722" class="Bound">s</a> <a id="5724" href="Polynomial.Simple.Reflection.html#5724" class="Bound">x</a><a id="5725" class="Symbol">))</a> <a id="5728" class="Symbol">=</a> <a id="5730" href="Polynomial.Simple.Reflection.html#5346" class="Function">go</a> <a id="5733" class="Symbol">(</a><a id="5734" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="5738" href="Polynomial.Simple.Reflection.html#5707" class="Bound">i</a><a id="5739" class="Symbol">)</a> <a id="5741" class="Symbol">(</a><a id="5742" href="Polynomial.Simple.Reflection.html#5709" class="Bound">k</a> <a id="5744" href="Function.html#805" class="Function Operator">∘</a> <a id="5746" class="Symbol">(</a><a id="5747" href="Polynomial.Simple.Reflection.html#5722" class="Bound">s</a> <a id="5749" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷_</a><a id="5751" class="Symbol">))</a> <a id="5754" href="Polynomial.Simple.Reflection.html#5724" class="Bound">x</a>
    <a id="5760" href="Polynomial.Simple.Reflection.html#5346" class="CatchallClause Function">go</a><a id="5762" class="CatchallClause"> </a><a id="5763" href="Polynomial.Simple.Reflection.html#5763" class="CatchallClause Bound">i</a><a id="5764" class="CatchallClause"> </a><a id="5765" href="Polynomial.Simple.Reflection.html#5765" class="CatchallClause Bound">k</a><a id="5766" class="CatchallClause"> </a><a id="5767" href="Polynomial.Simple.Reflection.html#5767" class="CatchallClause Bound">t</a> <a id="5769" class="Symbol">=</a> <a id="5771" href="Agda.Builtin.Reflection.html#5048" class="InductiveConstructor">unknown</a>

  <a id="Internal.toSoln′"></a><a id="5782" href="Polynomial.Simple.Reflection.html#5782" class="Function">toSoln′</a> <a id="5790" class="Symbol">:</a> <a id="5792" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="5794" class="Symbol">→</a> <a id="5796" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="5801" class="Symbol">→</a> <a id="5803" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
  <a id="5810" href="Polynomial.Simple.Reflection.html#5782" class="Function">toSoln′</a> <a id="5818" href="Polynomial.Simple.Reflection.html#5818" class="Bound">i</a> <a id="5820" class="Symbol">(</a><a id="5821" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="5825" href="Polynomial.Simple.Reflection.html#5825" class="Bound">f</a> <a id="5827" class="Symbol">(</a>            <a id="5840" href="Polynomial.Simple.Reflection.html#5840" class="Bound">lhs</a> <a id="5844" href="Polynomial.Simple.Reflection.html#531" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="5848" href="Polynomial.Simple.Reflection.html#5848" class="Bound">rhs</a> <a id="5852" href="Polynomial.Simple.Reflection.html#531" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="5856" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="5858" class="Symbol">))</a> <a id="5861" class="Symbol">=</a> <a id="5863" href="Polynomial.Simple.Reflection.html#4695" class="Function">mkSolver′</a> <a id="5873" href="Polynomial.Simple.Reflection.html#5818" class="Bound">i</a> <a id="5875" href="Polynomial.Simple.Reflection.html#5840" class="Bound">lhs</a> <a id="5879" href="Polynomial.Simple.Reflection.html#5848" class="Bound">rhs</a>
  <a id="5885" href="Polynomial.Simple.Reflection.html#5782" class="CatchallClause Function">toSoln′</a><a id="5892" class="CatchallClause"> </a><a id="5893" href="Polynomial.Simple.Reflection.html#5893" class="CatchallClause Bound">i</a><a id="5894" class="CatchallClause"> </a><a id="5895" class="CatchallClause Symbol">(</a><a id="5896" href="Agda.Builtin.Reflection.html#4705" class="CatchallClause InductiveConstructor">def</a><a id="5899" class="CatchallClause"> </a><a id="5900" href="Polynomial.Simple.Reflection.html#5900" class="CatchallClause Bound">f</a><a id="5901" class="CatchallClause"> </a><a id="5902" class="CatchallClause Symbol">(_</a><a id="5904" class="CatchallClause"> </a><a id="5905" href="Agda.Builtin.List.html#132" class="CatchallClause InductiveConstructor Operator">∷</a><a id="5906" class="CatchallClause"> </a><a id="5907" class="CatchallClause Symbol">_</a><a id="5908" class="CatchallClause"> </a><a id="5909" href="Agda.Builtin.List.html#132" class="CatchallClause InductiveConstructor Operator">∷</a><a id="5910" class="CatchallClause">     </a><a id="5915" href="Polynomial.Simple.Reflection.html#5915" class="CatchallClause Bound">lhs</a><a id="5918" class="CatchallClause"> </a><a id="5919" href="Polynomial.Simple.Reflection.html#531" class="CatchallClause InductiveConstructor Operator">⟨∷⟩</a><a id="5922" class="CatchallClause"> </a><a id="5923" href="Polynomial.Simple.Reflection.html#5923" class="CatchallClause Bound">rhs</a><a id="5926" class="CatchallClause"> </a><a id="5927" href="Polynomial.Simple.Reflection.html#531" class="CatchallClause InductiveConstructor Operator">⟨∷⟩</a><a id="5930" class="CatchallClause"> </a><a id="5931" href="Agda.Builtin.List.html#117" class="CatchallClause InductiveConstructor">[]</a><a id="5933" class="CatchallClause Symbol">))</a> <a id="5936" class="Symbol">=</a> <a id="5938" href="Polynomial.Simple.Reflection.html#4695" class="Function">mkSolver′</a> <a id="5948" href="Polynomial.Simple.Reflection.html#5893" class="Bound">i</a> <a id="5950" href="Polynomial.Simple.Reflection.html#5915" class="Bound">lhs</a> <a id="5954" href="Polynomial.Simple.Reflection.html#5923" class="Bound">rhs</a>
  <a id="5960" href="Polynomial.Simple.Reflection.html#5782" class="CatchallClause Function">toSoln′</a><a id="5967" class="CatchallClause"> </a><a id="5968" href="Polynomial.Simple.Reflection.html#5968" class="CatchallClause Bound">i</a><a id="5969" class="CatchallClause"> </a><a id="5970" class="CatchallClause Symbol">(</a><a id="5971" href="Agda.Builtin.Reflection.html#4705" class="CatchallClause InductiveConstructor">def</a><a id="5974" class="CatchallClause"> </a><a id="5975" href="Polynomial.Simple.Reflection.html#5975" class="CatchallClause Bound">f</a><a id="5976" class="CatchallClause"> </a><a id="5977" class="CatchallClause Symbol">(_</a><a id="5979" class="CatchallClause"> </a><a id="5980" href="Agda.Builtin.List.html#132" class="CatchallClause InductiveConstructor Operator">∷</a><a id="5981" class="CatchallClause"> </a><a id="5982" class="CatchallClause Symbol">_</a><a id="5983" class="CatchallClause"> </a><a id="5984" href="Agda.Builtin.List.html#132" class="CatchallClause InductiveConstructor Operator">∷</a><a id="5985" class="CatchallClause"> </a><a id="5986" class="CatchallClause Symbol">_</a><a id="5987" class="CatchallClause"> </a><a id="5988" href="Agda.Builtin.List.html#132" class="CatchallClause InductiveConstructor Operator">∷</a><a id="5989" class="CatchallClause"> </a><a id="5990" href="Polynomial.Simple.Reflection.html#5990" class="CatchallClause Bound">lhs</a><a id="5993" class="CatchallClause"> </a><a id="5994" href="Polynomial.Simple.Reflection.html#531" class="CatchallClause InductiveConstructor Operator">⟨∷⟩</a><a id="5997" class="CatchallClause"> </a><a id="5998" href="Polynomial.Simple.Reflection.html#5998" class="CatchallClause Bound">rhs</a><a id="6001" class="CatchallClause"> </a><a id="6002" href="Polynomial.Simple.Reflection.html#531" class="CatchallClause InductiveConstructor Operator">⟨∷⟩</a><a id="6005" class="CatchallClause"> </a><a id="6006" href="Agda.Builtin.List.html#117" class="CatchallClause InductiveConstructor">[]</a><a id="6008" class="CatchallClause Symbol">))</a> <a id="6011" class="Symbol">=</a> <a id="6013" href="Polynomial.Simple.Reflection.html#4695" class="Function">mkSolver′</a> <a id="6023" href="Polynomial.Simple.Reflection.html#5968" class="Bound">i</a> <a id="6025" href="Polynomial.Simple.Reflection.html#5990" class="Bound">lhs</a> <a id="6029" href="Polynomial.Simple.Reflection.html#5998" class="Bound">rhs</a>
  <a id="6035" href="Polynomial.Simple.Reflection.html#5782" class="CatchallClause Function">toSoln′</a><a id="6042" class="CatchallClause"> </a><a id="6043" class="CatchallClause Symbol">_</a><a id="6044" class="CatchallClause"> </a><a id="6045" class="CatchallClause Symbol">_</a> <a id="6047" class="Symbol">=</a> <a id="6049" href="Agda.Builtin.Reflection.html#5048" class="InductiveConstructor">unknown</a>

<a id="6058" class="Keyword">open</a> <a id="6063" href="Polynomial.Simple.Reflection.html#234" class="Module">Internal</a>
<a id="6072" class="Keyword">open</a> <a id="6077" class="Keyword">import</a> <a id="6084" href="Agda.Builtin.Reflection.html" class="Module">Agda.Builtin.Reflection</a>
<a id="6108" class="Keyword">macro</a>
  <a id="solve"></a><a id="6116" href="Polynomial.Simple.Reflection.html#6116" class="Function">solve</a> <a id="6122" class="Symbol">:</a> <a id="6124" href="Agda.Builtin.Reflection.html#363" class="Postulate">Name</a> <a id="6129" class="Symbol">→</a> <a id="6131" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="6136" class="Symbol">→</a> <a id="6138" href="Agda.Builtin.Reflection.html#7153" class="Postulate">TC</a> <a id="6141" href="Agda.Builtin.Unit.html#69" class="Record">⊤</a>
  <a id="6145" href="Polynomial.Simple.Reflection.html#6116" class="Function">solve</a> <a id="6151" href="Polynomial.Simple.Reflection.html#6151" class="Bound">rng</a> <a id="6155" href="Polynomial.Simple.Reflection.html#6155" class="Bound">hole</a> <a id="6160" class="Symbol">=</a>
    <a id="6166" href="Agda.Builtin.Reflection.html#7414" class="Postulate">inferType</a> <a id="6176" href="Polynomial.Simple.Reflection.html#6155" class="Bound">hole</a> <a id="6181" href="Function.html#2548" class="Function Operator">⟨</a> <a id="6183" href="Agda.Builtin.Reflection.html#7240" class="Postulate">bindTC</a> <a id="6190" href="Function.html#2548" class="Function Operator">⟩</a> <a id="6192" href="Agda.Builtin.Reflection.html#7520" class="Postulate">reduce</a> <a id="6199" href="Function.html#2548" class="Function Operator">⟨</a> <a id="6201" href="Agda.Builtin.Reflection.html#7240" class="Postulate">bindTC</a> <a id="6208" href="Function.html#2548" class="Function Operator">⟩</a> <a id="6210" href="Agda.Builtin.Reflection.html#7317" class="Postulate">unify</a> <a id="6216" href="Polynomial.Simple.Reflection.html#6155" class="Bound">hole</a> <a id="6221" href="Function.html#805" class="Function Operator">∘</a> <a id="6223" href="Polynomial.Simple.Reflection.html#5292" class="Function">toSoln</a> <a id="6230" class="Symbol">(</a><a id="6231" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="6235" href="Polynomial.Simple.Reflection.html#6151" class="Bound">rng</a> <a id="6239" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="6241" class="Symbol">)</a>

<a id="6244" class="Keyword">macro</a>
  <a id="solveFor"></a><a id="6252" href="Polynomial.Simple.Reflection.html#6252" class="Function">solveFor</a> <a id="6261" class="Symbol">:</a> <a id="6263" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="6265" class="Symbol">→</a> <a id="6267" href="Agda.Builtin.Reflection.html#363" class="Postulate">Name</a> <a id="6272" class="Symbol">→</a> <a id="6274" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="6279" class="Symbol">→</a> <a id="6281" href="Agda.Builtin.Reflection.html#7153" class="Postulate">TC</a> <a id="6284" href="Agda.Builtin.Unit.html#69" class="Record">⊤</a>
  <a id="6288" href="Polynomial.Simple.Reflection.html#6252" class="Function">solveFor</a> <a id="6297" href="Polynomial.Simple.Reflection.html#6297" class="Bound">i</a> <a id="6299" href="Polynomial.Simple.Reflection.html#6299" class="Bound">rng</a> <a id="6303" href="Polynomial.Simple.Reflection.html#6303" class="Bound">hole</a> <a id="6308" class="Symbol">=</a>
    <a id="6314" href="Agda.Builtin.Reflection.html#7414" class="Postulate">inferType</a> <a id="6324" href="Polynomial.Simple.Reflection.html#6303" class="Bound">hole</a> <a id="6329" href="Function.html#2548" class="Function Operator">⟨</a> <a id="6331" href="Agda.Builtin.Reflection.html#7240" class="Postulate">bindTC</a> <a id="6338" href="Function.html#2548" class="Function Operator">⟩</a> <a id="6340" href="Agda.Builtin.Reflection.html#7520" class="Postulate">reduce</a> <a id="6347" href="Function.html#2548" class="Function Operator">⟨</a> <a id="6349" href="Agda.Builtin.Reflection.html#7240" class="Postulate">bindTC</a> <a id="6356" href="Function.html#2548" class="Function Operator">⟩</a> <a id="6358" href="Agda.Builtin.Reflection.html#7317" class="Postulate">unify</a> <a id="6364" href="Polynomial.Simple.Reflection.html#6303" class="Bound">hole</a> <a id="6369" href="Function.html#805" class="Function Operator">∘</a> <a id="6371" href="Polynomial.Simple.Reflection.html#5782" class="Function">toSoln′</a> <a id="6379" class="Symbol">(</a><a id="6380" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="6384" href="Polynomial.Simple.Reflection.html#6299" class="Bound">rng</a> <a id="6388" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="6390" class="Symbol">)</a> <a id="6392" href="Polynomial.Simple.Reflection.html#6297" class="Bound">i</a>
</pre></body></html>