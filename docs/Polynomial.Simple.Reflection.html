<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Polynomial.Simple.Reflection</title><link rel="stylesheet" href="Agda.css"></head><body><pre><a id="1" class="Keyword">module</a> <a id="8" href="Polynomial.Simple.Reflection.html" class="Module">Polynomial.Simple.Reflection</a> <a id="37" class="Keyword">where</a>

<a id="44" class="Keyword">open</a> <a id="49" class="Keyword">import</a> <a id="56" href="Agda.Builtin.Reflection.html" class="Module">Agda.Builtin.Reflection</a>
<a id="80" class="Keyword">open</a> <a id="85" class="Keyword">import</a> <a id="92" href="Reflection.html" class="Module">Reflection</a>
<a id="103" class="Keyword">open</a> <a id="108" class="Keyword">import</a> <a id="115" href="Function.html" class="Module">Function</a>
<a id="124" class="Keyword">open</a> <a id="129" class="Keyword">import</a> <a id="136" href="Data.Unit.html" class="Module">Data.Unit</a> <a id="146" class="Keyword">using</a> <a id="152" class="Symbol">(</a><a id="153" href="Agda.Builtin.Unit.html#69" class="Record">⊤</a><a id="154" class="Symbol">)</a>
<a id="156" class="Keyword">open</a> <a id="161" class="Keyword">import</a> <a id="168" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="177" class="Symbol">as</a> <a id="180" class="Module">ℕ</a> <a id="182" class="Keyword">using</a> <a id="188" class="Symbol">(</a><a id="189" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a><a id="190" class="Symbol">;</a> <a id="192" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a><a id="195" class="Symbol">;</a> <a id="197" href="Agda.Builtin.Nat.html#115" class="InductiveConstructor">zero</a><a id="201" class="Symbol">)</a>
<a id="203" class="Keyword">open</a> <a id="208" class="Keyword">import</a> <a id="215" href="Data.List.html" class="Module">Data.List</a> <a id="225" class="Symbol">as</a> <a id="228" class="Module">List</a> <a id="233" class="Keyword">using</a> <a id="239" class="Symbol">(</a><a id="240" href="Agda.Builtin.List.html#80" class="Datatype">List</a><a id="244" class="Symbol">;</a> <a id="246" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">_∷_</a><a id="249" class="Symbol">;</a> <a id="251" href="Data.List.Base.html#9863" class="InductiveConstructor">[]</a><a id="253" class="Symbol">;</a> <a id="255" href="Data.List.Base.html#3600" class="Function">foldr</a><a id="260" class="Symbol">)</a>

<a id="_&gt;&gt;=_"></a><a id="263" href="Polynomial.Simple.Reflection.html#263" class="Function Operator">_&gt;&gt;=_</a> <a id="269" class="Symbol">:</a> <a id="271" class="Symbol">{</a><a id="272" href="Polynomial.Simple.Reflection.html#272" class="Bound">A</a> <a id="274" href="Polynomial.Simple.Reflection.html#274" class="Bound">B</a> <a id="276" class="Symbol">:</a> <a id="278" class="PrimitiveType">Set</a><a id="281" class="Symbol">}</a> <a id="283" class="Symbol">→</a> <a id="285" href="Agda.Builtin.Reflection.html#7153" class="Postulate">TC</a> <a id="288" href="Polynomial.Simple.Reflection.html#272" class="Bound">A</a> <a id="290" class="Symbol">→</a> <a id="292" class="Symbol">(</a><a id="293" href="Polynomial.Simple.Reflection.html#272" class="Bound">A</a> <a id="295" class="Symbol">→</a> <a id="297" href="Agda.Builtin.Reflection.html#7153" class="Postulate">TC</a> <a id="300" href="Polynomial.Simple.Reflection.html#274" class="Bound">B</a><a id="301" class="Symbol">)</a> <a id="303" class="Symbol">→</a> <a id="305" href="Agda.Builtin.Reflection.html#7153" class="Postulate">TC</a> <a id="308" href="Polynomial.Simple.Reflection.html#274" class="Bound">B</a>
<a id="310" href="Polynomial.Simple.Reflection.html#263" class="Function Operator">_&gt;&gt;=_</a> <a id="316" class="Symbol">=</a> <a id="318" href="Agda.Builtin.Reflection.html#7240" class="Postulate">bindTC</a>

<a id="326" class="Keyword">module</a> <a id="Internal"></a><a id="333" href="Polynomial.Simple.Reflection.html#333" class="Module">Internal</a> <a id="342" class="Symbol">(</a><a id="343" href="Polynomial.Simple.Reflection.html#343" class="Bound">rng</a> <a id="347" class="Symbol">:</a> <a id="349" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a><a id="353" class="Symbol">)</a> <a id="355" class="Keyword">where</a>
  <a id="363" class="Keyword">open</a> <a id="368" class="Keyword">import</a> <a id="375" href="Polynomial.Simple.Solver.html" class="Module">Polynomial.Simple.Solver</a> <a id="400" class="Keyword">renaming</a> <a id="409" class="Symbol">(</a><a id="410" href="Polynomial.Simple.Solver.html#2804" class="Function">solve</a> <a id="416" class="Symbol">to</a> <a id="419" href="Polynomial.Simple.Solver.html#2804" class="Function">solve′</a><a id="425" class="Symbol">)</a>
  <a id="429" class="Keyword">open</a> <a id="434" class="Keyword">import</a> <a id="441" href="Data.String.html" class="Module">Data.String</a>
  <a id="455" class="Keyword">open</a> <a id="460" class="Keyword">import</a> <a id="467" href="Relation.Nullary.html" class="Module">Relation.Nullary</a> <a id="484" class="Keyword">using</a> <a id="490" class="Symbol">(</a><a id="491" href="Relation.Nullary.html#570" class="Datatype">Dec</a><a id="494" class="Symbol">;</a> <a id="496" href="Relation.Nullary.html#606" class="InductiveConstructor">yes</a><a id="499" class="Symbol">;</a> <a id="501" href="Relation.Nullary.html#633" class="InductiveConstructor">no</a><a id="503" class="Symbol">)</a>
  <a id="507" class="Keyword">import</a> <a id="514" href="Data.Vec.html" class="Module">Data.Vec</a> <a id="523" class="Symbol">as</a> <a id="526" class="Module">Vec</a>
  <a id="532" class="Keyword">import</a> <a id="539" href="Data.Fin.html" class="Module">Data.Fin</a> <a id="548" class="Symbol">as</a> <a id="551" class="Module">Fin</a>
  <a id="557" class="Keyword">open</a> <a id="562" class="Keyword">import</a> <a id="569" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="580" class="Symbol">as</a> <a id="583" class="Module">Maybe</a> <a id="589" class="Keyword">using</a> <a id="595" class="Symbol">(</a><a id="596" href="Data.Maybe.Base.html#710" class="Datatype">Maybe</a><a id="601" class="Symbol">;</a> <a id="603" href="Data.Maybe.Base.html#748" class="InductiveConstructor">just</a><a id="607" class="Symbol">;</a> <a id="609" href="Data.Maybe.Base.html#778" class="InductiveConstructor">nothing</a><a id="616" class="Symbol">)</a>

  <a id="621" class="Keyword">open</a> <a id="626" class="Keyword">import</a> <a id="633" href="Data.Nat.Table.html" class="Module">Data.Nat.Table</a>

  <a id="651" class="Comment">-- Some patterns to decrease verbosity</a>
  <a id="692" class="Keyword">infixr</a> <a id="699" class="Number">5</a> <a id="701" href="Polynomial.Simple.Reflection.html#723" class="InductiveConstructor Operator">_⟨∷⟩_</a> <a id="707" href="Polynomial.Simple.Reflection.html#785" class="InductiveConstructor Operator">_⟅∷⟆_</a>
  <a id="715" class="Keyword">pattern</a> <a id="Internal._⟨∷⟩_"></a><a id="723" href="Polynomial.Simple.Reflection.html#723" class="InductiveConstructor Operator">_⟨∷⟩_</a> <a id="729" href="Polynomial.Simple.Reflection.html#768" class="Bound">x</a> <a id="731" href="Polynomial.Simple.Reflection.html#772" class="Bound">xs</a> <a id="734" class="Symbol">=</a> <a id="736" href="Agda.Builtin.Reflection.html#3069" class="InductiveConstructor">arg</a> <a id="740" class="Symbol">(</a><a id="741" href="Agda.Builtin.Reflection.html#2981" class="InductiveConstructor">arg-info</a> <a id="750" href="Agda.Builtin.Reflection.html#2549" class="InductiveConstructor">visible</a> <a id="758" href="Agda.Builtin.Reflection.html#2806" class="InductiveConstructor">relevant</a><a id="766" class="Symbol">)</a> <a id="768" href="Polynomial.Simple.Reflection.html#768" class="Bound">x</a> <a id="770" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="772" href="Polynomial.Simple.Reflection.html#772" class="Bound">xs</a>
  <a id="777" class="Keyword">pattern</a> <a id="Internal._⟅∷⟆_"></a><a id="785" href="Polynomial.Simple.Reflection.html#785" class="InductiveConstructor Operator">_⟅∷⟆_</a> <a id="791" href="Polynomial.Simple.Reflection.html#829" class="Bound">x</a> <a id="793" href="Polynomial.Simple.Reflection.html#833" class="Bound">xs</a> <a id="796" class="Symbol">=</a> <a id="798" href="Agda.Builtin.Reflection.html#3069" class="InductiveConstructor">arg</a> <a id="802" class="Symbol">(</a><a id="803" href="Agda.Builtin.Reflection.html#2981" class="InductiveConstructor">arg-info</a> <a id="812" href="Agda.Builtin.Reflection.html#2557" class="InductiveConstructor">hidden</a> <a id="819" href="Agda.Builtin.Reflection.html#2806" class="InductiveConstructor">relevant</a><a id="827" class="Symbol">)</a> <a id="829" href="Polynomial.Simple.Reflection.html#829" class="Bound">x</a> <a id="831" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="833" href="Polynomial.Simple.Reflection.html#833" class="Bound">xs</a>

  <a id="839" class="Keyword">infixr</a> <a id="846" class="Number">5</a> <a id="848" href="Polynomial.Simple.Reflection.html#857" class="Function Operator">_⋯⟅∷⟆_</a>
  <a id="Internal._⋯⟅∷⟆_"></a><a id="857" href="Polynomial.Simple.Reflection.html#857" class="Function Operator">_⋯⟅∷⟆_</a> <a id="864" class="Symbol">:</a> <a id="866" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="868" class="Symbol">→</a> <a id="870" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="875" class="Symbol">(</a><a id="876" href="Agda.Builtin.Reflection.html#3041" class="Datatype">Arg</a> <a id="880" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a><a id="884" class="Symbol">)</a> <a id="886" class="Symbol">→</a> <a id="888" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="893" class="Symbol">(</a><a id="894" href="Agda.Builtin.Reflection.html#3041" class="Datatype">Arg</a> <a id="898" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a><a id="902" class="Symbol">)</a>
  <a id="906" href="Agda.Builtin.Nat.html#115" class="InductiveConstructor">zero</a>  <a id="912" href="Polynomial.Simple.Reflection.html#857" class="Function Operator">⋯⟅∷⟆</a> <a id="917" href="Polynomial.Simple.Reflection.html#917" class="Bound">xs</a> <a id="920" class="Symbol">=</a> <a id="922" href="Polynomial.Simple.Reflection.html#917" class="Bound">xs</a>
  <a id="927" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="931" href="Polynomial.Simple.Reflection.html#931" class="Bound">i</a> <a id="933" href="Polynomial.Simple.Reflection.html#857" class="Function Operator">⋯⟅∷⟆</a> <a id="938" href="Polynomial.Simple.Reflection.html#938" class="Bound">xs</a> <a id="941" class="Symbol">=</a> <a id="943" href="Agda.Builtin.Reflection.html#5048" class="InductiveConstructor">unknown</a> <a id="951" href="Polynomial.Simple.Reflection.html#785" class="InductiveConstructor Operator">⟅∷⟆</a>  <a id="956" href="Polynomial.Simple.Reflection.html#931" class="Bound">i</a> <a id="958" href="Polynomial.Simple.Reflection.html#857" class="Function Operator">⋯⟅∷⟆</a> <a id="963" href="Polynomial.Simple.Reflection.html#938" class="Bound">xs</a>

  <a id="Internal.natTerm"></a><a id="969" href="Polynomial.Simple.Reflection.html#969" class="Function">natTerm</a> <a id="977" class="Symbol">:</a> <a id="979" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="981" class="Symbol">→</a> <a id="983" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
  <a id="990" href="Polynomial.Simple.Reflection.html#969" class="Function">natTerm</a> <a id="998" href="Agda.Builtin.Nat.html#115" class="InductiveConstructor">zero</a> <a id="1003" class="Symbol">=</a> <a id="1005" class="Keyword">quote</a> <a id="1011" href="Agda.Builtin.Nat.html#115" class="InductiveConstructor">zero</a> <a id="1016" href="Function.html#2548" class="Function Operator">⟨</a> <a id="1018" href="Agda.Builtin.Reflection.html#4648" class="InductiveConstructor">con</a> <a id="1022" href="Function.html#2548" class="Function Operator">⟩</a> <a id="1024" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>
  <a id="1029" href="Polynomial.Simple.Reflection.html#969" class="Function">natTerm</a> <a id="1037" class="Symbol">(</a><a id="1038" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="1042" href="Polynomial.Simple.Reflection.html#1042" class="Bound">i</a><a id="1043" class="Symbol">)</a> <a id="1045" class="Symbol">=</a> <a id="1047" class="Keyword">quote</a> <a id="1053" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="1057" href="Function.html#2548" class="Function Operator">⟨</a> <a id="1059" href="Agda.Builtin.Reflection.html#4648" class="InductiveConstructor">con</a> <a id="1063" href="Function.html#2548" class="Function Operator">⟩</a> <a id="1065" href="Polynomial.Simple.Reflection.html#969" class="Function">natTerm</a> <a id="1073" href="Polynomial.Simple.Reflection.html#1042" class="Bound">i</a> <a id="1075" href="Polynomial.Simple.Reflection.html#723" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="1079" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>

  <a id="Internal.finTerm"></a><a id="1085" href="Polynomial.Simple.Reflection.html#1085" class="Function">finTerm</a> <a id="1093" class="Symbol">:</a> <a id="1095" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="1097" class="Symbol">→</a> <a id="1099" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
  <a id="1106" href="Polynomial.Simple.Reflection.html#1085" class="Function">finTerm</a> <a id="1114" href="Agda.Builtin.Nat.html#115" class="InductiveConstructor">zero</a> <a id="1119" class="Symbol">=</a> <a id="1121" class="Keyword">quote</a> <a id="1127" href="Data.Fin.Base.html#973" class="InductiveConstructor">Fin.zero</a> <a id="1136" href="Function.html#2548" class="Function Operator">⟨</a> <a id="1138" href="Agda.Builtin.Reflection.html#4648" class="InductiveConstructor">con</a> <a id="1142" href="Function.html#2548" class="Function Operator">⟩</a> <a id="1144" class="Number">1</a> <a id="1146" href="Polynomial.Simple.Reflection.html#857" class="Function Operator">⋯⟅∷⟆</a> <a id="1151" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>
  <a id="1156" href="Polynomial.Simple.Reflection.html#1085" class="Function">finTerm</a> <a id="1164" class="Symbol">(</a><a id="1165" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="1169" href="Polynomial.Simple.Reflection.html#1169" class="Bound">i</a><a id="1170" class="Symbol">)</a> <a id="1172" class="Symbol">=</a> <a id="1174" class="Keyword">quote</a> <a id="1180" href="Data.Fin.Base.html#1004" class="InductiveConstructor">Fin.suc</a> <a id="1188" href="Function.html#2548" class="Function Operator">⟨</a> <a id="1190" href="Agda.Builtin.Reflection.html#4648" class="InductiveConstructor">con</a> <a id="1194" href="Function.html#2548" class="Function Operator">⟩</a> <a id="1196" class="Number">1</a> <a id="1198" href="Polynomial.Simple.Reflection.html#857" class="Function Operator">⋯⟅∷⟆</a> <a id="1203" href="Polynomial.Simple.Reflection.html#1085" class="Function">finTerm</a> <a id="1211" href="Polynomial.Simple.Reflection.html#1169" class="Bound">i</a> <a id="1213" href="Polynomial.Simple.Reflection.html#723" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="1217" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>

  <a id="Internal.curriedTerm"></a><a id="1223" href="Polynomial.Simple.Reflection.html#1223" class="Function">curriedTerm</a> <a id="1235" class="Symbol">:</a> <a id="1237" href="Data.Nat.Table.html#151" class="Function">Table</a> <a id="1243" class="Symbol">→</a> <a id="1245" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
  <a id="1252" href="Polynomial.Simple.Reflection.html#1223" class="Function">curriedTerm</a> <a id="1264" class="Symbol">=</a> <a id="1266" href="Polynomial.Simple.Reflection.html#1288" class="Function">go</a> <a id="1269" href="Agda.Builtin.Nat.html#115" class="InductiveConstructor">zero</a>
    <a id="1278" class="Keyword">where</a>
    <a id="1288" href="Polynomial.Simple.Reflection.html#1288" class="Function">go</a> <a id="1291" class="Symbol">:</a> <a id="1293" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="1295" class="Symbol">→</a> <a id="1297" href="Data.Nat.Table.html#151" class="Function">Table</a> <a id="1303" class="Symbol">→</a> <a id="1305" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
    <a id="1314" href="Polynomial.Simple.Reflection.html#1288" class="Function">go</a> <a id="1317" href="Polynomial.Simple.Reflection.html#1317" class="Bound">k</a> <a id="1319" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a> <a id="1322" class="Symbol">=</a> <a id="1324" class="Keyword">quote</a> <a id="1330" href="Data.Vec.html#813" class="InductiveConstructor">Vec.[]</a> <a id="1337" href="Function.html#2548" class="Function Operator">⟨</a> <a id="1339" href="Agda.Builtin.Reflection.html#4648" class="InductiveConstructor">con</a> <a id="1343" href="Function.html#2548" class="Function Operator">⟩</a> <a id="1345" class="Number">2</a> <a id="1347" href="Polynomial.Simple.Reflection.html#857" class="Function Operator">⋯⟅∷⟆</a> <a id="1352" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>
    <a id="1359" href="Polynomial.Simple.Reflection.html#1288" class="Function">go</a> <a id="1362" href="Polynomial.Simple.Reflection.html#1362" class="Bound">k</a> <a id="1364" class="Symbol">(</a><a id="1365" href="Polynomial.Simple.Reflection.html#1365" class="Bound">x</a> <a id="1367" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="1369" href="Polynomial.Simple.Reflection.html#1369" class="Bound">xs</a><a id="1371" class="Symbol">)</a> <a id="1373" class="Symbol">=</a> <a id="1375" class="Keyword">quote</a> <a id="1381" href="Data.Vec.html#832" class="InductiveConstructor Operator">Vec._∷_</a> <a id="1389" href="Function.html#2548" class="Function Operator">⟨</a> <a id="1391" href="Agda.Builtin.Reflection.html#4648" class="InductiveConstructor">con</a> <a id="1395" href="Function.html#2548" class="Function Operator">⟩</a> <a id="1397" class="Number">2</a> <a id="1399" href="Polynomial.Simple.Reflection.html#857" class="Function Operator">⋯⟅∷⟆</a> <a id="1404" class="Number">1</a> <a id="1406" href="Polynomial.Simple.Reflection.html#857" class="Function Operator">⋯⟅∷⟆</a> <a id="1411" href="Agda.Builtin.Reflection.html#4592" class="InductiveConstructor">var</a> <a id="1415" class="Symbol">(</a><a id="1416" href="Polynomial.Simple.Reflection.html#1362" class="Bound">k</a> <a id="1418" href="Agda.Builtin.Nat.html#230" class="Primitive Operator">ℕ.+</a> <a id="1422" href="Polynomial.Simple.Reflection.html#1365" class="Bound">x</a><a id="1423" class="Symbol">)</a> <a id="1425" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a> <a id="1428" href="Polynomial.Simple.Reflection.html#723" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="1432" href="Polynomial.Simple.Reflection.html#1288" class="Function">go</a> <a id="1435" class="Symbol">(</a><a id="1436" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="1440" class="Symbol">(</a><a id="1441" href="Polynomial.Simple.Reflection.html#1362" class="Bound">k</a> <a id="1443" href="Agda.Builtin.Nat.html#230" class="Primitive Operator">ℕ.+</a> <a id="1447" href="Polynomial.Simple.Reflection.html#1365" class="Bound">x</a><a id="1448" class="Symbol">))</a> <a id="1451" href="Polynomial.Simple.Reflection.html#1369" class="Bound">xs</a> <a id="1454" href="Polynomial.Simple.Reflection.html#723" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="1458" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>

  <a id="Internal.hlams"></a><a id="1464" href="Polynomial.Simple.Reflection.html#1464" class="Function">hlams</a> <a id="1470" class="Symbol">:</a> <a id="1472" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="1477" href="Agda.Builtin.String.html#165" class="Postulate">String</a> <a id="1484" class="Symbol">→</a> <a id="1486" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="1491" class="Symbol">→</a> <a id="1493" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
  <a id="1500" href="Polynomial.Simple.Reflection.html#1464" class="Function">hlams</a> <a id="1506" href="Polynomial.Simple.Reflection.html#1506" class="Bound">vs</a> <a id="1509" href="Polynomial.Simple.Reflection.html#1509" class="Bound">xs</a> <a id="1512" class="Symbol">=</a> <a id="1514" href="Data.List.Base.html#3600" class="Function">foldr</a> <a id="1520" class="Symbol">(λ</a> <a id="1523" href="Polynomial.Simple.Reflection.html#1523" class="Bound">v</a> <a id="1525" href="Polynomial.Simple.Reflection.html#1525" class="Bound">vs</a> <a id="1528" class="Symbol">→</a> <a id="1530" href="Agda.Builtin.Reflection.html#4762" class="InductiveConstructor">lam</a> <a id="1534" href="Agda.Builtin.Reflection.html#2557" class="InductiveConstructor">hidden</a> <a id="1541" class="Symbol">(</a><a id="1542" href="Agda.Builtin.Reflection.html#3308" class="InductiveConstructor">abs</a> <a id="1546" href="Polynomial.Simple.Reflection.html#1523" class="Bound">v</a> <a id="1548" href="Polynomial.Simple.Reflection.html#1525" class="Bound">vs</a><a id="1550" class="Symbol">))</a> <a id="1553" href="Polynomial.Simple.Reflection.html#1509" class="Bound">xs</a> <a id="1556" href="Polynomial.Simple.Reflection.html#1506" class="Bound">vs</a>

  <a id="Internal.vlams"></a><a id="1562" href="Polynomial.Simple.Reflection.html#1562" class="Function">vlams</a> <a id="1568" class="Symbol">:</a> <a id="1570" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="1575" href="Agda.Builtin.String.html#165" class="Postulate">String</a> <a id="1582" class="Symbol">→</a> <a id="1584" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="1589" class="Symbol">→</a> <a id="1591" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
  <a id="1598" href="Polynomial.Simple.Reflection.html#1562" class="Function">vlams</a> <a id="1604" href="Polynomial.Simple.Reflection.html#1604" class="Bound">vs</a> <a id="1607" href="Polynomial.Simple.Reflection.html#1607" class="Bound">xs</a> <a id="1610" class="Symbol">=</a> <a id="1612" href="Data.List.Base.html#3600" class="Function">foldr</a> <a id="1618" class="Symbol">(λ</a> <a id="1621" href="Polynomial.Simple.Reflection.html#1621" class="Bound">v</a> <a id="1623" href="Polynomial.Simple.Reflection.html#1623" class="Bound">vs</a> <a id="1626" class="Symbol">→</a> <a id="1628" href="Agda.Builtin.Reflection.html#4762" class="InductiveConstructor">lam</a> <a id="1632" href="Agda.Builtin.Reflection.html#2549" class="InductiveConstructor">visible</a> <a id="1640" class="Symbol">(</a><a id="1641" href="Agda.Builtin.Reflection.html#3308" class="InductiveConstructor">abs</a> <a id="1645" href="Polynomial.Simple.Reflection.html#1621" class="Bound">v</a> <a id="1647" href="Polynomial.Simple.Reflection.html#1623" class="Bound">vs</a><a id="1649" class="Symbol">))</a> <a id="1652" href="Polynomial.Simple.Reflection.html#1607" class="Bound">xs</a> <a id="1655" href="Polynomial.Simple.Reflection.html#1604" class="Bound">vs</a>

  <a id="1661" class="Keyword">module</a> <a id="1668" href="Polynomial.Simple.Reflection.html#1668" class="Module">_</a> <a id="1670" class="Symbol">(</a><a id="1671" href="Polynomial.Simple.Reflection.html#1671" class="Bound">numVars</a> <a id="1679" class="Symbol">:</a> <a id="1681" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a><a id="1682" class="Symbol">)</a> <a id="1684" class="Keyword">where</a>

    <a id="1695" class="Comment">-- This function applies the hidden arguments that the constructors</a>
    <a id="1767" class="Comment">-- that Expr needs. The first is the universe level, the second is the</a>
    <a id="1842" class="Comment">-- type it contains, and the third is the number of variables it&#39;s</a>
    <a id="1913" class="Comment">-- indexed by. All three of these could likely be inferred, but to</a>
    <a id="1984" class="Comment">-- make things easier we supply the third because we know it.</a>
    <a id="2050" class="Keyword">infixr</a> <a id="2057" class="Number">5</a> <a id="2059" href="Polynomial.Simple.Reflection.html#2069" class="Function Operator">E⟅∷⟆_</a>
    <a id="2069" href="Polynomial.Simple.Reflection.html#2069" class="Function Operator">E⟅∷⟆_</a> <a id="2075" class="Symbol">:</a> <a id="2077" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="2082" class="Symbol">(</a><a id="2083" href="Agda.Builtin.Reflection.html#3041" class="Datatype">Arg</a> <a id="2087" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a><a id="2091" class="Symbol">)</a> <a id="2093" class="Symbol">→</a> <a id="2095" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="2100" class="Symbol">(</a><a id="2101" href="Agda.Builtin.Reflection.html#3041" class="Datatype">Arg</a> <a id="2105" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a><a id="2109" class="Symbol">)</a>
    <a id="2115" href="Polynomial.Simple.Reflection.html#2069" class="Function Operator">E⟅∷⟆</a> <a id="2120" href="Polynomial.Simple.Reflection.html#2120" class="Bound">xs</a> <a id="2123" class="Symbol">=</a> <a id="2125" class="Number">1</a> <a id="2127" href="Polynomial.Simple.Reflection.html#857" class="Function Operator">⋯⟅∷⟆</a>
              <a id="2146" class="Symbol">(</a><a id="2147" class="Keyword">quote</a> <a id="2153" href="Polynomial.Simple.AlmostCommutativeRing.html#1043" class="Field">AlmostCommutativeRing.Carrier</a> <a id="2183" href="Function.html#2548" class="Function Operator">⟨</a> <a id="2185" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="2189" href="Function.html#2548" class="Function Operator">⟩</a> <a id="2191" class="Number">2</a> <a id="2193" href="Polynomial.Simple.Reflection.html#857" class="Function Operator">⋯⟅∷⟆</a> <a id="2198" href="Polynomial.Simple.Reflection.html#343" class="Bound">rng</a> <a id="2202" href="Polynomial.Simple.Reflection.html#723" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="2206" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="2208" class="Symbol">)</a> <a id="2210" href="Polynomial.Simple.Reflection.html#785" class="InductiveConstructor Operator">⟅∷⟆</a>
              <a id="2228" href="Polynomial.Simple.Reflection.html#969" class="Function">natTerm</a> <a id="2236" href="Polynomial.Simple.Reflection.html#1671" class="Bound">numVars</a> <a id="2244" href="Polynomial.Simple.Reflection.html#785" class="InductiveConstructor Operator">⟅∷⟆</a>
              <a id="2262" href="Polynomial.Simple.Reflection.html#2120" class="Bound">xs</a>

    <a id="2270" class="Comment">-- A constant expression.</a>
    <a id="2300" href="Polynomial.Simple.Reflection.html#2300" class="Function">constExpr</a> <a id="2310" class="Symbol">:</a> <a id="2312" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="2317" class="Symbol">→</a> <a id="2319" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
    <a id="2328" href="Polynomial.Simple.Reflection.html#2300" class="Function">constExpr</a> <a id="2338" href="Polynomial.Simple.Reflection.html#2338" class="Bound">x</a> <a id="2340" class="Symbol">=</a> <a id="2342" class="Keyword">quote</a> <a id="2348" href="Polynomial.Expr.html#290" class="InductiveConstructor">Κ</a> <a id="2350" href="Function.html#2548" class="Function Operator">⟨</a> <a id="2352" href="Agda.Builtin.Reflection.html#4648" class="InductiveConstructor">con</a> <a id="2356" href="Function.html#2548" class="Function Operator">⟩</a> <a id="2358" href="Polynomial.Simple.Reflection.html#2069" class="Function Operator">E⟅∷⟆</a> <a id="2363" href="Polynomial.Simple.Reflection.html#2338" class="Bound">x</a> <a id="2365" href="Polynomial.Simple.Reflection.html#723" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="2369" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>

    <a id="2377" class="Keyword">module</a> <a id="ToExpr"></a><a id="2384" href="Polynomial.Simple.Reflection.html#2384" class="Module">ToExpr</a> <a id="2391" class="Symbol">(</a><a id="2392" href="Polynomial.Simple.Reflection.html#2392" class="Bound">varExpr</a> <a id="2400" class="Symbol">:</a> <a id="2402" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="2404" class="Symbol">→</a> <a id="2406" href="Data.Maybe.Base.html#710" class="Datatype">Maybe</a> <a id="2412" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a><a id="2416" class="Symbol">)</a> <a id="2418" class="Keyword">where</a>
      <a id="2430" class="Keyword">mutual</a>
        <a id="2445" class="Comment">-- Application of a ring operator often doesn&#39;t have a type as</a>
        <a id="2516" class="Comment">-- simple as &quot;Carrier → Carrier → Carrier&quot;: there may be hidden</a>
        <a id="2588" class="Comment">-- arguments, etc. Here, we do our best to handle those cases,</a>
        <a id="2659" class="Comment">-- by just taking the last two explicit arguments.</a>
        <a id="2718" href="Polynomial.Simple.Reflection.html#2718" class="Function">getBinOp</a> <a id="2727" class="Symbol">:</a> <a id="2729" href="Agda.Builtin.Reflection.html#363" class="Postulate">Name</a> <a id="2734" class="Symbol">→</a> <a id="2736" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="2741" class="Symbol">(</a><a id="2742" href="Agda.Builtin.Reflection.html#3041" class="Datatype">Arg</a> <a id="2746" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a><a id="2750" class="Symbol">)</a> <a id="2752" class="Symbol">→</a> <a id="2754" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
        <a id="2767" href="Polynomial.Simple.Reflection.html#2718" class="Function">getBinOp</a> <a id="2776" href="Polynomial.Simple.Reflection.html#2776" class="Bound">nm</a> <a id="2779" class="Symbol">(</a><a id="2780" href="Polynomial.Simple.Reflection.html#2780" class="Bound">x</a> <a id="2782" href="Polynomial.Simple.Reflection.html#723" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="2786" href="Polynomial.Simple.Reflection.html#2786" class="Bound">y</a> <a id="2788" href="Polynomial.Simple.Reflection.html#723" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="2792" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="2794" class="Symbol">)</a> <a id="2796" class="Symbol">=</a> <a id="2798" href="Polynomial.Simple.Reflection.html#2776" class="Bound">nm</a> <a id="2801" href="Function.html#2548" class="Function Operator">⟨</a> <a id="2803" href="Agda.Builtin.Reflection.html#4648" class="InductiveConstructor">con</a> <a id="2807" href="Function.html#2548" class="Function Operator">⟩</a> <a id="2809" href="Polynomial.Simple.Reflection.html#2069" class="Function Operator">E⟅∷⟆</a> <a id="2814" href="Polynomial.Simple.Reflection.html#3997" class="Function">toExpr</a> <a id="2821" href="Polynomial.Simple.Reflection.html#2780" class="Bound">x</a> <a id="2823" href="Polynomial.Simple.Reflection.html#723" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="2827" href="Polynomial.Simple.Reflection.html#3997" class="Function">toExpr</a> <a id="2834" href="Polynomial.Simple.Reflection.html#2786" class="Bound">y</a> <a id="2836" href="Polynomial.Simple.Reflection.html#723" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="2840" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>
        <a id="2851" href="Polynomial.Simple.Reflection.html#2718" class="CatchallClause Function">getBinOp</a><a id="2859" class="CatchallClause"> </a><a id="2860" href="Polynomial.Simple.Reflection.html#2860" class="CatchallClause Bound">nm</a><a id="2862" class="CatchallClause"> </a><a id="2863" class="CatchallClause Symbol">(</a><a id="2864" href="Polynomial.Simple.Reflection.html#2864" class="CatchallClause Bound">x</a><a id="2865" class="CatchallClause"> </a><a id="2866" href="Agda.Builtin.List.html#132" class="CatchallClause InductiveConstructor Operator">∷</a><a id="2867" class="CatchallClause"> </a><a id="2868" href="Polynomial.Simple.Reflection.html#2868" class="CatchallClause Bound">xs</a><a id="2870" class="CatchallClause Symbol">)</a> <a id="2872" class="Symbol">=</a> <a id="2874" href="Polynomial.Simple.Reflection.html#2718" class="Function">getBinOp</a> <a id="2883" href="Polynomial.Simple.Reflection.html#2860" class="Bound">nm</a> <a id="2886" href="Polynomial.Simple.Reflection.html#2868" class="Bound">xs</a>
        <a id="2897" href="Polynomial.Simple.Reflection.html#2718" class="CatchallClause Function">getBinOp</a><a id="2905" class="CatchallClause"> </a><a id="2906" class="CatchallClause Symbol">_</a><a id="2907" class="CatchallClause"> </a><a id="2908" class="CatchallClause Symbol">_</a> <a id="2910" class="Symbol">=</a> <a id="2912" href="Agda.Builtin.Reflection.html#5048" class="InductiveConstructor">unknown</a>

        <a id="2929" href="Polynomial.Simple.Reflection.html#2929" class="Function">getUnOp</a> <a id="2937" class="Symbol">:</a> <a id="2939" href="Agda.Builtin.Reflection.html#363" class="Postulate">Name</a> <a id="2944" class="Symbol">→</a> <a id="2946" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="2951" class="Symbol">(</a><a id="2952" href="Agda.Builtin.Reflection.html#3041" class="Datatype">Arg</a> <a id="2956" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a><a id="2960" class="Symbol">)</a> <a id="2962" class="Symbol">→</a> <a id="2964" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
        <a id="2977" href="Polynomial.Simple.Reflection.html#2929" class="Function">getUnOp</a> <a id="2985" href="Polynomial.Simple.Reflection.html#2985" class="Bound">nm</a> <a id="2988" class="Symbol">(</a><a id="2989" href="Polynomial.Simple.Reflection.html#2989" class="Bound">x</a> <a id="2991" href="Polynomial.Simple.Reflection.html#723" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="2995" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="2997" class="Symbol">)</a> <a id="2999" class="Symbol">=</a> <a id="3001" href="Polynomial.Simple.Reflection.html#2985" class="Bound">nm</a> <a id="3004" href="Function.html#2548" class="Function Operator">⟨</a> <a id="3006" href="Agda.Builtin.Reflection.html#4648" class="InductiveConstructor">con</a> <a id="3010" href="Function.html#2548" class="Function Operator">⟩</a> <a id="3012" href="Polynomial.Simple.Reflection.html#2069" class="Function Operator">E⟅∷⟆</a> <a id="3017" href="Polynomial.Simple.Reflection.html#3997" class="Function">toExpr</a> <a id="3024" href="Polynomial.Simple.Reflection.html#2989" class="Bound">x</a> <a id="3026" href="Polynomial.Simple.Reflection.html#723" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="3030" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>
        <a id="3041" href="Polynomial.Simple.Reflection.html#2929" class="CatchallClause Function">getUnOp</a><a id="3048" class="CatchallClause"> </a><a id="3049" href="Polynomial.Simple.Reflection.html#3049" class="CatchallClause Bound">nm</a><a id="3051" class="CatchallClause"> </a><a id="3052" class="CatchallClause Symbol">(</a><a id="3053" href="Polynomial.Simple.Reflection.html#3053" class="CatchallClause Bound">x</a><a id="3054" class="CatchallClause"> </a><a id="3055" href="Agda.Builtin.List.html#132" class="CatchallClause InductiveConstructor Operator">∷</a><a id="3056" class="CatchallClause"> </a><a id="3057" href="Polynomial.Simple.Reflection.html#3057" class="CatchallClause Bound">xs</a><a id="3059" class="CatchallClause Symbol">)</a> <a id="3061" class="Symbol">=</a> <a id="3063" href="Polynomial.Simple.Reflection.html#2929" class="Function">getUnOp</a> <a id="3071" href="Polynomial.Simple.Reflection.html#3049" class="Bound">nm</a> <a id="3074" href="Polynomial.Simple.Reflection.html#3057" class="Bound">xs</a>
        <a id="3085" href="Polynomial.Simple.Reflection.html#2929" class="CatchallClause Function">getUnOp</a><a id="3092" class="CatchallClause"> </a><a id="3093" class="CatchallClause Symbol">_</a><a id="3094" class="CatchallClause"> </a><a id="3095" class="CatchallClause Symbol">_</a> <a id="3097" class="Symbol">=</a> <a id="3099" href="Agda.Builtin.Reflection.html#5048" class="InductiveConstructor">unknown</a>

        <a id="3116" href="Polynomial.Simple.Reflection.html#3116" class="Function">getExp</a> <a id="3123" class="Symbol">:</a> <a id="3125" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="3130" class="Symbol">(</a><a id="3131" href="Agda.Builtin.Reflection.html#3041" class="Datatype">Arg</a> <a id="3135" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a><a id="3139" class="Symbol">)</a> <a id="3141" class="Symbol">→</a> <a id="3143" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
        <a id="3156" href="Polynomial.Simple.Reflection.html#3116" class="Function">getExp</a> <a id="3163" class="Symbol">(</a><a id="3164" href="Polynomial.Simple.Reflection.html#3164" class="Bound">x</a> <a id="3166" href="Polynomial.Simple.Reflection.html#723" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="3170" href="Polynomial.Simple.Reflection.html#3170" class="Bound">y</a> <a id="3172" href="Polynomial.Simple.Reflection.html#723" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="3176" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="3178" class="Symbol">)</a> <a id="3180" class="Symbol">=</a> <a id="3182" class="Keyword">quote</a> <a id="3188" href="Polynomial.Expr.html#414" class="InductiveConstructor Operator">_⊛_</a> <a id="3192" href="Function.html#2548" class="Function Operator">⟨</a> <a id="3194" href="Agda.Builtin.Reflection.html#4648" class="InductiveConstructor">con</a> <a id="3198" href="Function.html#2548" class="Function Operator">⟩</a> <a id="3200" href="Polynomial.Simple.Reflection.html#2069" class="Function Operator">E⟅∷⟆</a> <a id="3205" href="Polynomial.Simple.Reflection.html#3997" class="Function">toExpr</a> <a id="3212" href="Polynomial.Simple.Reflection.html#3164" class="Bound">x</a> <a id="3214" href="Polynomial.Simple.Reflection.html#723" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="3218" href="Polynomial.Simple.Reflection.html#3170" class="Bound">y</a> <a id="3220" href="Polynomial.Simple.Reflection.html#723" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="3224" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>
        <a id="3235" href="Polynomial.Simple.Reflection.html#3116" class="CatchallClause Function">getExp</a><a id="3241" class="CatchallClause"> </a><a id="3242" class="CatchallClause Symbol">(</a><a id="3243" href="Polynomial.Simple.Reflection.html#3243" class="CatchallClause Bound">x</a><a id="3244" class="CatchallClause"> </a><a id="3245" href="Agda.Builtin.List.html#132" class="CatchallClause InductiveConstructor Operator">∷</a><a id="3246" class="CatchallClause"> </a><a id="3247" href="Polynomial.Simple.Reflection.html#3247" class="CatchallClause Bound">xs</a><a id="3249" class="CatchallClause Symbol">)</a> <a id="3251" class="Symbol">=</a> <a id="3253" href="Polynomial.Simple.Reflection.html#3116" class="Function">getExp</a> <a id="3260" href="Polynomial.Simple.Reflection.html#3247" class="Bound">xs</a>
        <a id="3271" href="Polynomial.Simple.Reflection.html#3116" class="CatchallClause Function">getExp</a><a id="3277" class="CatchallClause"> </a><a id="3278" class="CatchallClause Symbol">_</a> <a id="3280" class="Symbol">=</a> <a id="3282" href="Agda.Builtin.Reflection.html#5048" class="InductiveConstructor">unknown</a>

        <a id="3299" class="Comment">-- When trying to figure out the shape of an expression, one of</a>
        <a id="3371" class="Comment">-- the difficult tasks is recognizing where constants in the</a>
        <a id="3440" class="Comment">-- underlying ring are used. If we were only dealing with ℕ, we</a>
        <a id="3512" class="Comment">-- might look for its constructors: however, we want to deal with</a>
        <a id="3586" class="Comment">-- arbitrary types which implement AlmostCommutativeRing. If the</a>
        <a id="3659" class="Comment">-- Term type contained type information we might be able to</a>
        <a id="3727" class="Comment">-- recognize it there, but it doesn&#39;t.</a>
        <a id="3774" class="Comment">--</a>
        <a id="3785" class="Comment">-- We&#39;re in luck, though, because all other cases in the following</a>
        <a id="3860" class="Comment">-- function *are* recognizable. As a result, the &quot;catch-all&quot; case</a>
        <a id="3934" class="Comment">-- will just assume that it has a constant expression.</a>
        <a id="3997" href="Polynomial.Simple.Reflection.html#3997" class="Function">toExpr</a> <a id="4004" class="Symbol">:</a> <a id="4006" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="4011" class="Symbol">→</a> <a id="4013" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
        <a id="4026" href="Polynomial.Simple.Reflection.html#3997" class="Function">toExpr</a> <a id="4033" class="Symbol">(</a><a id="4034" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="4038" class="Symbol">(</a><a id="4039" class="Keyword">quote</a> <a id="4045" href="Polynomial.Simple.AlmostCommutativeRing.html#1123" class="Field Operator">AlmostCommutativeRing._+_</a><a id="4070" class="Symbol">)</a> <a id="4072" href="Polynomial.Simple.Reflection.html#4072" class="Bound">xs</a><a id="4074" class="Symbol">)</a> <a id="4076" class="Symbol">=</a> <a id="4078" href="Polynomial.Simple.Reflection.html#2718" class="Function">getBinOp</a> <a id="4087" class="Symbol">(</a><a id="4088" class="Keyword">quote</a> <a id="4094" href="Polynomial.Expr.html#336" class="InductiveConstructor Operator">_⊕_</a><a id="4097" class="Symbol">)</a> <a id="4099" href="Polynomial.Simple.Reflection.html#4072" class="Bound">xs</a>
        <a id="4110" href="Polynomial.Simple.Reflection.html#3997" class="Function">toExpr</a> <a id="4117" class="Symbol">(</a><a id="4118" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="4122" class="Symbol">(</a><a id="4123" class="Keyword">quote</a> <a id="4129" href="Polynomial.Simple.AlmostCommutativeRing.html#1165" class="Field Operator">AlmostCommutativeRing._*_</a><a id="4154" class="Symbol">)</a> <a id="4156" href="Polynomial.Simple.Reflection.html#4156" class="Bound">xs</a><a id="4158" class="Symbol">)</a> <a id="4160" class="Symbol">=</a> <a id="4162" href="Polynomial.Simple.Reflection.html#2718" class="Function">getBinOp</a> <a id="4171" class="Symbol">(</a><a id="4172" class="Keyword">quote</a> <a id="4178" href="Polynomial.Expr.html#375" class="InductiveConstructor Operator">_⊗_</a><a id="4181" class="Symbol">)</a> <a id="4183" href="Polynomial.Simple.Reflection.html#4156" class="Bound">xs</a>
        <a id="4194" href="Polynomial.Simple.Reflection.html#3997" class="Function">toExpr</a> <a id="4201" class="Symbol">(</a><a id="4202" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="4206" class="Symbol">(</a><a id="4207" class="Keyword">quote</a> <a id="4213" href="Polynomial.Simple.AlmostCommutativeRing.html#2058" class="Function Operator">AlmostCommutativeRing._^_</a><a id="4238" class="Symbol">)</a> <a id="4240" href="Polynomial.Simple.Reflection.html#4240" class="Bound">xs</a><a id="4242" class="Symbol">)</a> <a id="4244" class="Symbol">=</a> <a id="4246" href="Polynomial.Simple.Reflection.html#3116" class="Function">getExp</a> <a id="4253" href="Polynomial.Simple.Reflection.html#4240" class="Bound">xs</a>
        <a id="4264" href="Polynomial.Simple.Reflection.html#3997" class="Function">toExpr</a> <a id="4271" class="Symbol">(</a><a id="4272" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="4276" class="Symbol">(</a><a id="4277" class="Keyword">quote</a> <a id="4283" href="Polynomial.Simple.AlmostCommutativeRing.html#1207" class="Field Operator">AlmostCommutativeRing.-_</a><a id="4307" class="Symbol">)</a> <a id="4309" href="Polynomial.Simple.Reflection.html#4309" class="Bound">xs</a><a id="4311" class="Symbol">)</a> <a id="4313" class="Symbol">=</a> <a id="4315" href="Polynomial.Simple.Reflection.html#2929" class="Function">getUnOp</a> <a id="4323" class="Symbol">(</a><a id="4324" class="Keyword">quote</a> <a id="4330" href="Polynomial.Expr.html#446" class="InductiveConstructor Operator">⊝_</a><a id="4332" class="Symbol">)</a> <a id="4334" href="Polynomial.Simple.Reflection.html#4309" class="Bound">xs</a>
        <a id="4345" href="Polynomial.Simple.Reflection.html#3997" class="Function">toExpr</a> <a id="4352" href="Polynomial.Simple.Reflection.html#4352" class="Bound">v</a><a id="4353" class="Symbol">@(</a><a id="4355" href="Agda.Builtin.Reflection.html#4592" class="InductiveConstructor">var</a> <a id="4359" href="Polynomial.Simple.Reflection.html#4359" class="Bound">x</a> <a id="4361" class="Symbol">_)</a> <a id="4364" class="Symbol">=</a> <a id="4366" href="Data.Maybe.Base.html#1730" class="Function">Maybe.fromMaybe</a> <a id="4382" class="Symbol">(</a><a id="4383" href="Polynomial.Simple.Reflection.html#2300" class="Function">constExpr</a> <a id="4393" href="Polynomial.Simple.Reflection.html#4352" class="Bound">v</a><a id="4394" class="Symbol">)</a> <a id="4396" class="Symbol">(</a><a id="4397" href="Polynomial.Simple.Reflection.html#2392" class="Bound">varExpr</a> <a id="4405" href="Polynomial.Simple.Reflection.html#4359" class="Bound">x</a><a id="4406" class="Symbol">)</a>
        <a id="4416" href="Polynomial.Simple.Reflection.html#3997" class="CatchallClause Function">toExpr</a><a id="4422" class="CatchallClause"> </a><a id="4423" href="Polynomial.Simple.Reflection.html#4423" class="CatchallClause Bound">t</a> <a id="4425" class="Symbol">=</a> <a id="4427" href="Polynomial.Simple.Reflection.html#2300" class="Function">constExpr</a> <a id="4437" href="Polynomial.Simple.Reflection.html#4423" class="Bound">t</a>

    <a id="4444" href="Polynomial.Simple.Reflection.html#4444" class="Function">mkSolver</a> <a id="4453" class="Symbol">:</a> <a id="4455" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="4460" href="Agda.Builtin.String.html#165" class="Postulate">String</a> <a id="4467" class="Symbol">→</a> <a id="4469" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="4474" class="Symbol">→</a> <a id="4476" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="4481" class="Symbol">→</a> <a id="4483" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="4488" class="Symbol">(</a><a id="4489" href="Agda.Builtin.Reflection.html#3041" class="Datatype">Arg</a> <a id="4493" href="Agda.Builtin.Reflection.html#4561" class="Function">Type</a><a id="4497" class="Symbol">)</a>
    <a id="4503" href="Polynomial.Simple.Reflection.html#4444" class="Function">mkSolver</a> <a id="4512" href="Polynomial.Simple.Reflection.html#4512" class="Bound">nms</a> <a id="4516" href="Polynomial.Simple.Reflection.html#4516" class="Bound">lhs</a> <a id="4520" href="Polynomial.Simple.Reflection.html#4520" class="Bound">rhs</a> <a id="4524" class="Symbol">=</a>
        <a id="4534" class="Number">2</a> <a id="4536" href="Polynomial.Simple.Reflection.html#857" class="Function Operator">⋯⟅∷⟆</a>
        <a id="4549" href="Polynomial.Simple.Reflection.html#343" class="Bound">rng</a> <a id="4553" href="Polynomial.Simple.Reflection.html#723" class="InductiveConstructor Operator">⟨∷⟩</a>
        <a id="4565" href="Polynomial.Simple.Reflection.html#969" class="Function">natTerm</a> <a id="4573" href="Polynomial.Simple.Reflection.html#1671" class="Bound">numVars</a> <a id="4581" href="Polynomial.Simple.Reflection.html#723" class="InductiveConstructor Operator">⟨∷⟩</a>
        <a id="4593" href="Polynomial.Simple.Reflection.html#1562" class="Function">vlams</a> <a id="4599" href="Polynomial.Simple.Reflection.html#4512" class="Bound">nms</a> <a id="4603" class="Symbol">(</a><a id="4604" class="Keyword">quote</a> <a id="4610" href="Polynomial.Simple.Solver.html#3445" class="Function Operator">_⊜_</a> <a id="4614" href="Function.html#2548" class="Function Operator">⟨</a> <a id="4616" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="4620" href="Function.html#2548" class="Function Operator">⟩</a> <a id="4622" class="Number">2</a> <a id="4624" href="Polynomial.Simple.Reflection.html#857" class="Function Operator">⋯⟅∷⟆</a> <a id="4629" href="Polynomial.Simple.Reflection.html#343" class="Bound">rng</a> <a id="4633" href="Polynomial.Simple.Reflection.html#723" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="4637" href="Polynomial.Simple.Reflection.html#969" class="Function">natTerm</a> <a id="4645" href="Polynomial.Simple.Reflection.html#1671" class="Bound">numVars</a> <a id="4653" href="Polynomial.Simple.Reflection.html#723" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="4657" href="Polynomial.Simple.Reflection.html#3997" class="Function">toExpr</a> <a id="4664" href="Polynomial.Simple.Reflection.html#4516" class="Bound">lhs</a> <a id="4668" href="Polynomial.Simple.Reflection.html#723" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="4672" href="Polynomial.Simple.Reflection.html#3997" class="Function">toExpr</a> <a id="4679" href="Polynomial.Simple.Reflection.html#4520" class="Bound">rhs</a> <a id="4683" href="Polynomial.Simple.Reflection.html#723" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="4687" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="4689" class="Symbol">)</a> <a id="4691" href="Polynomial.Simple.Reflection.html#723" class="InductiveConstructor Operator">⟨∷⟩</a>
        <a id="4703" href="Polynomial.Simple.Reflection.html#1464" class="Function">hlams</a> <a id="4709" href="Polynomial.Simple.Reflection.html#4512" class="Bound">nms</a> <a id="4713" class="Symbol">(</a><a id="4714" class="Keyword">quote</a> <a id="4720" href="Polynomial.Simple.AlmostCommutativeRing.html#2136" class="Function">AlmostCommutativeRing.refl</a> <a id="4747" href="Function.html#2548" class="Function Operator">⟨</a> <a id="4749" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="4753" href="Function.html#2548" class="Function Operator">⟩</a> <a id="4755" class="Number">2</a> <a id="4757" href="Polynomial.Simple.Reflection.html#857" class="Function Operator">⋯⟅∷⟆</a> <a id="4762" href="Polynomial.Simple.Reflection.html#343" class="Bound">rng</a> <a id="4766" href="Polynomial.Simple.Reflection.html#723" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="4770" class="Number">1</a> <a id="4772" href="Polynomial.Simple.Reflection.html#857" class="Function Operator">⋯⟅∷⟆</a> <a id="4777" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="4779" class="Symbol">)</a> <a id="4781" href="Polynomial.Simple.Reflection.html#723" class="InductiveConstructor Operator">⟨∷⟩</a>
        <a id="4793" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>
      <a id="4802" class="Keyword">where</a>
      <a id="4814" href="Polynomial.Simple.Reflection.html#4814" class="Function">varExpr</a> <a id="4822" class="Symbol">:</a> <a id="4824" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="4826" class="Symbol">→</a> <a id="4828" href="Data.Maybe.Base.html#710" class="Datatype">Maybe</a> <a id="4834" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
      <a id="4845" href="Polynomial.Simple.Reflection.html#4814" class="Function">varExpr</a> <a id="4853" href="Polynomial.Simple.Reflection.html#4853" class="Bound">i</a> <a id="4855" class="Keyword">with</a> <a id="4860" href="Polynomial.Simple.Reflection.html#4853" class="Bound">i</a> <a id="4862" href="Data.Nat.Properties.html#5343" class="Function Operator">ℕ.&lt;?</a> <a id="4867" href="Polynomial.Simple.Reflection.html#1671" class="Bound">numVars</a>
      <a id="4881" class="Symbol">...</a> <a id="4885" class="Symbol">|</a> <a id="4887" href="Relation.Nullary.html#606" class="InductiveConstructor">yes</a> <a id="4891" class="Symbol">_</a> <a id="4893" class="Symbol">=</a> <a id="4895" href="Data.Maybe.Base.html#748" class="InductiveConstructor">just</a> <a id="4900" class="Symbol">(</a><a id="4901" href="Agda.Builtin.Reflection.html#4592" class="InductiveConstructor">var</a> <a id="4905" class="Bound">i</a> <a id="4907" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="4909" class="Symbol">)</a>
      <a id="4917" class="Symbol">...</a> <a id="4921" class="Symbol">|</a> <a id="4923" href="Relation.Nullary.html#633" class="InductiveConstructor">no</a> <a id="4926" class="Symbol">_</a> <a id="4928" class="Symbol">=</a> <a id="4930" href="Data.Maybe.Base.html#778" class="InductiveConstructor">nothing</a>
      <a id="4944" class="Keyword">open</a> <a id="4949" href="Polynomial.Simple.Reflection.html#2384" class="Module">ToExpr</a> <a id="4956" href="Polynomial.Simple.Reflection.html#4814" class="Function">varExpr</a>

    <a id="4969" href="Polynomial.Simple.Reflection.html#4969" class="Function">mkSolver′</a> <a id="4979" class="Symbol">:</a> <a id="4981" href="Data.Nat.Table.html#151" class="Function">Table</a> <a id="4987" class="Symbol">→</a> <a id="4989" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="4994" class="Symbol">→</a> <a id="4996" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="5001" class="Symbol">→</a> <a id="5003" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
    <a id="5012" href="Polynomial.Simple.Reflection.html#4969" class="Function">mkSolver′</a> <a id="5022" href="Polynomial.Simple.Reflection.html#5022" class="Bound">t</a> <a id="5024" href="Polynomial.Simple.Reflection.html#5024" class="Bound">lhs</a> <a id="5028" href="Polynomial.Simple.Reflection.html#5028" class="Bound">rhs</a> <a id="5032" class="Symbol">=</a>
      <a id="5040" class="Keyword">quote</a> <a id="5046" href="Relation.Binary.Core.html#5860" class="Function">AlmostCommutativeRing.trans</a> <a id="5074" href="Function.html#2548" class="Function Operator">⟨</a> <a id="5076" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="5080" href="Function.html#2548" class="Function Operator">⟩</a>
        <a id="5090" class="Number">2</a> <a id="5092" href="Polynomial.Simple.Reflection.html#857" class="Function Operator">⋯⟅∷⟆</a>
        <a id="5105" href="Polynomial.Simple.Reflection.html#343" class="Bound">rng</a> <a id="5109" href="Polynomial.Simple.Reflection.html#723" class="InductiveConstructor Operator">⟨∷⟩</a>
        <a id="5121" class="Number">3</a> <a id="5123" href="Polynomial.Simple.Reflection.html#857" class="Function Operator">⋯⟅∷⟆</a>
        <a id="5136" class="Symbol">(</a><a id="5137" class="Keyword">quote</a> <a id="5143" href="Relation.Binary.Core.html#5834" class="Function">AlmostCommutativeRing.sym</a> <a id="5169" href="Function.html#2548" class="Function Operator">⟨</a> <a id="5171" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="5175" href="Function.html#2548" class="Function Operator">⟩</a>
            <a id="5189" class="Symbol">(</a><a id="5190" class="Number">2</a> <a id="5192" href="Polynomial.Simple.Reflection.html#857" class="Function Operator">⋯⟅∷⟆</a>
            <a id="5209" href="Polynomial.Simple.Reflection.html#343" class="Bound">rng</a> <a id="5213" href="Polynomial.Simple.Reflection.html#723" class="InductiveConstructor Operator">⟨∷⟩</a>
            <a id="5229" class="Number">2</a> <a id="5231" href="Polynomial.Simple.Reflection.html#857" class="Function Operator">⋯⟅∷⟆</a>
            <a id="5248" class="Symbol">(</a><a id="5249" class="Keyword">quote</a> <a id="5255" href="Polynomial.Simple.Solver.html#2088" class="Function">Ops.correct</a> <a id="5267" href="Function.html#2548" class="Function Operator">⟨</a> <a id="5269" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="5273" href="Function.html#2548" class="Function Operator">⟩</a> <a id="5275" class="Number">2</a> <a id="5277" href="Polynomial.Simple.Reflection.html#857" class="Function Operator">⋯⟅∷⟆</a> <a id="5282" href="Polynomial.Simple.Reflection.html#343" class="Bound">rng</a> <a id="5286" href="Polynomial.Simple.Reflection.html#723" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="5290" class="Number">1</a> <a id="5292" href="Polynomial.Simple.Reflection.html#857" class="Function Operator">⋯⟅∷⟆</a> <a id="5297" href="Polynomial.Simple.Reflection.html#3997" class="Function">toExpr</a> <a id="5304" href="Polynomial.Simple.Reflection.html#5024" class="Bound">lhs</a> <a id="5308" href="Polynomial.Simple.Reflection.html#723" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="5312" href="Polynomial.Simple.Reflection.html#5615" class="Function">ρ</a> <a id="5314" href="Polynomial.Simple.Reflection.html#723" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="5318" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="5320" class="Symbol">)</a> <a id="5322" href="Polynomial.Simple.Reflection.html#723" class="InductiveConstructor Operator">⟨∷⟩</a>
            <a id="5338" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="5340" class="Symbol">))</a>
        <a id="5351" href="Polynomial.Simple.Reflection.html#723" class="InductiveConstructor Operator">⟨∷⟩</a>
        <a id="5363" class="Symbol">(</a><a id="5364" class="Keyword">quote</a> <a id="5370" href="Polynomial.Simple.Solver.html#2088" class="Function">Ops.correct</a> <a id="5382" href="Function.html#2548" class="Function Operator">⟨</a> <a id="5384" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="5388" href="Function.html#2548" class="Function Operator">⟩</a> <a id="5390" class="Number">2</a> <a id="5392" href="Polynomial.Simple.Reflection.html#857" class="Function Operator">⋯⟅∷⟆</a> <a id="5397" href="Polynomial.Simple.Reflection.html#343" class="Bound">rng</a> <a id="5401" href="Polynomial.Simple.Reflection.html#723" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="5405" class="Number">1</a> <a id="5407" href="Polynomial.Simple.Reflection.html#857" class="Function Operator">⋯⟅∷⟆</a> <a id="5412" href="Polynomial.Simple.Reflection.html#3997" class="Function">toExpr</a> <a id="5419" href="Polynomial.Simple.Reflection.html#5028" class="Bound">rhs</a> <a id="5423" href="Polynomial.Simple.Reflection.html#723" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="5427" href="Polynomial.Simple.Reflection.html#5615" class="Function">ρ</a> <a id="5429" href="Polynomial.Simple.Reflection.html#723" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="5433" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="5435" class="Symbol">)</a> <a id="5437" href="Polynomial.Simple.Reflection.html#723" class="InductiveConstructor Operator">⟨∷⟩</a>
        <a id="5449" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>
      <a id="5458" class="Keyword">where</a>
      <a id="5470" href="Polynomial.Simple.Reflection.html#5470" class="Function">varExpr</a> <a id="5478" class="Symbol">:</a> <a id="5480" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="5482" class="Symbol">→</a> <a id="5484" href="Data.Maybe.Base.html#710" class="Datatype">Maybe</a> <a id="5490" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
      <a id="5501" href="Polynomial.Simple.Reflection.html#5470" class="Function">varExpr</a> <a id="5509" href="Polynomial.Simple.Reflection.html#5509" class="Bound">i</a> <a id="5511" class="Symbol">=</a> <a id="5513" href="Data.Maybe.Base.html#2139" class="Function">Maybe.map</a> <a id="5523" class="Symbol">(λ</a> <a id="5526" href="Polynomial.Simple.Reflection.html#5526" class="Bound">x</a> <a id="5528" class="Symbol">→</a> <a id="5530" class="Keyword">quote</a> <a id="5536" href="Polynomial.Expr.html#311" class="InductiveConstructor">Ι</a> <a id="5538" href="Function.html#2548" class="Function Operator">⟨</a> <a id="5540" href="Agda.Builtin.Reflection.html#4648" class="InductiveConstructor">con</a> <a id="5544" href="Function.html#2548" class="Function Operator">⟩</a> <a id="5546" href="Polynomial.Simple.Reflection.html#2069" class="Function Operator">E⟅∷⟆</a> <a id="5551" href="Polynomial.Simple.Reflection.html#1085" class="Function">finTerm</a> <a id="5559" href="Polynomial.Simple.Reflection.html#5526" class="Bound">x</a> <a id="5561" href="Polynomial.Simple.Reflection.html#723" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="5565" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="5567" class="Symbol">)</a> <a id="5569" class="Symbol">(</a><a id="5570" href="Data.Nat.Table.html#539" class="Function">member</a> <a id="5577" href="Polynomial.Simple.Reflection.html#5509" class="Bound">i</a> <a id="5579" href="Polynomial.Simple.Reflection.html#5022" class="Bound">t</a><a id="5580" class="Symbol">)</a>

      <a id="5589" class="Keyword">open</a> <a id="5594" href="Polynomial.Simple.Reflection.html#2384" class="Module">ToExpr</a> <a id="5601" href="Polynomial.Simple.Reflection.html#5470" class="Function">varExpr</a>
      <a id="5615" href="Polynomial.Simple.Reflection.html#5615" class="Function">ρ</a> <a id="5617" class="Symbol">:</a> <a id="5619" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
      <a id="5630" href="Polynomial.Simple.Reflection.html#5615" class="Function">ρ</a> <a id="5632" class="Symbol">=</a> <a id="5634" href="Polynomial.Simple.Reflection.html#1223" class="Function">curriedTerm</a> <a id="5646" href="Polynomial.Simple.Reflection.html#5022" class="Bound">t</a>

  <a id="Internal.toSoln"></a><a id="5651" href="Polynomial.Simple.Reflection.html#5651" class="Function">toSoln</a> <a id="5658" class="Symbol">:</a> <a id="5660" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="5665" class="Symbol">→</a> <a id="5667" href="Agda.Builtin.Reflection.html#7153" class="Postulate">TC</a> <a id="5670" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
  <a id="5677" href="Polynomial.Simple.Reflection.html#5651" class="Function">toSoln</a> <a id="5684" href="Polynomial.Simple.Reflection.html#5684" class="Bound">t′</a> <a id="5687" class="Symbol">=</a> <a id="5689" href="Polynomial.Simple.Reflection.html#5714" class="Function">go</a> <a id="5692" class="Number">0</a> <a id="5694" href="Function.html#1104" class="Function">id</a> <a id="5697" href="Polynomial.Simple.Reflection.html#5684" class="Bound">t′</a>
    <a id="5704" class="Keyword">where</a>
    <a id="5714" href="Polynomial.Simple.Reflection.html#5714" class="Function">go</a> <a id="5717" class="Symbol">:</a> <a id="5719" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="5721" class="Symbol">→</a> <a id="5723" class="Symbol">(</a><a id="5724" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="5729" href="Agda.Builtin.String.html#165" class="Postulate">String</a> <a id="5736" class="Symbol">→</a> <a id="5738" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="5743" href="Agda.Builtin.String.html#165" class="Postulate">String</a><a id="5749" class="Symbol">)</a> <a id="5751" class="Symbol">→</a> <a id="5753" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="5758" class="Symbol">→</a> <a id="5760" href="Agda.Builtin.Reflection.html#7153" class="Postulate">TC</a> <a id="5763" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
    <a id="5772" href="Polynomial.Simple.Reflection.html#5714" class="Function">go</a> <a id="5775" href="Polynomial.Simple.Reflection.html#5775" class="Bound">i</a> <a id="5777" href="Polynomial.Simple.Reflection.html#5777" class="Bound">k</a> <a id="5779" class="Symbol">(</a><a id="5780" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="5784" href="Polynomial.Simple.Reflection.html#5784" class="Bound">f</a> <a id="5786" class="Symbol">(</a>            <a id="5799" href="Polynomial.Simple.Reflection.html#5799" class="Bound">lhs</a> <a id="5803" href="Polynomial.Simple.Reflection.html#723" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="5807" href="Polynomial.Simple.Reflection.html#5807" class="Bound">rhs</a> <a id="5811" href="Polynomial.Simple.Reflection.html#723" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="5815" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="5817" class="Symbol">))</a> <a id="5820" class="Symbol">=</a> <a id="5822" href="Agda.Builtin.Reflection.html#7193" class="Postulate">returnTC</a> <a id="5831" href="Function.html#1927" class="Function Operator">$</a> <a id="5833" class="Keyword">quote</a> <a id="5839" href="Polynomial.Simple.Solver.html#2804" class="Function">solve′</a> <a id="5846" href="Function.html#2548" class="Function Operator">⟨</a> <a id="5848" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="5852" href="Function.html#2548" class="Function Operator">⟩</a> <a id="5854" href="Polynomial.Simple.Reflection.html#4444" class="Function">mkSolver</a> <a id="5863" href="Polynomial.Simple.Reflection.html#5775" class="Bound">i</a> <a id="5865" class="Symbol">(</a><a id="5866" href="Polynomial.Simple.Reflection.html#5777" class="Bound">k</a> <a id="5868" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="5870" class="Symbol">)</a> <a id="5872" href="Polynomial.Simple.Reflection.html#5799" class="Bound">lhs</a> <a id="5876" href="Polynomial.Simple.Reflection.html#5807" class="Bound">rhs</a>
    <a id="5884" href="Polynomial.Simple.Reflection.html#5714" class="CatchallClause Function">go</a><a id="5886" class="CatchallClause"> </a><a id="5887" href="Polynomial.Simple.Reflection.html#5887" class="CatchallClause Bound">i</a><a id="5888" class="CatchallClause"> </a><a id="5889" href="Polynomial.Simple.Reflection.html#5889" class="CatchallClause Bound">k</a><a id="5890" class="CatchallClause"> </a><a id="5891" class="CatchallClause Symbol">(</a><a id="5892" href="Agda.Builtin.Reflection.html#4705" class="CatchallClause InductiveConstructor">def</a><a id="5895" class="CatchallClause"> </a><a id="5896" href="Polynomial.Simple.Reflection.html#5896" class="CatchallClause Bound">f</a><a id="5897" class="CatchallClause"> </a><a id="5898" class="CatchallClause Symbol">(</a><a id="5899" class="CatchallClause">    </a><a id="5903" class="CatchallClause Symbol">_</a><a id="5904" class="CatchallClause"> </a><a id="5905" href="Agda.Builtin.List.html#132" class="CatchallClause InductiveConstructor Operator">∷</a><a id="5906" class="CatchallClause"> </a><a id="5907" class="CatchallClause Symbol">_</a><a id="5908" class="CatchallClause"> </a><a id="5909" href="Agda.Builtin.List.html#132" class="CatchallClause InductiveConstructor Operator">∷</a><a id="5910" class="CatchallClause"> </a><a id="5911" href="Polynomial.Simple.Reflection.html#5911" class="CatchallClause Bound">lhs</a><a id="5914" class="CatchallClause"> </a><a id="5915" href="Polynomial.Simple.Reflection.html#723" class="CatchallClause InductiveConstructor Operator">⟨∷⟩</a><a id="5918" class="CatchallClause"> </a><a id="5919" href="Polynomial.Simple.Reflection.html#5919" class="CatchallClause Bound">rhs</a><a id="5922" class="CatchallClause"> </a><a id="5923" href="Polynomial.Simple.Reflection.html#723" class="CatchallClause InductiveConstructor Operator">⟨∷⟩</a><a id="5926" class="CatchallClause"> </a><a id="5927" href="Agda.Builtin.List.html#117" class="CatchallClause InductiveConstructor">[]</a><a id="5929" class="CatchallClause Symbol">))</a> <a id="5932" class="Symbol">=</a> <a id="5934" href="Agda.Builtin.Reflection.html#7193" class="Postulate">returnTC</a> <a id="5943" href="Function.html#1927" class="Function Operator">$</a> <a id="5945" class="Keyword">quote</a> <a id="5951" href="Polynomial.Simple.Solver.html#2804" class="Function">solve′</a> <a id="5958" href="Function.html#2548" class="Function Operator">⟨</a> <a id="5960" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="5964" href="Function.html#2548" class="Function Operator">⟩</a> <a id="5966" href="Polynomial.Simple.Reflection.html#4444" class="Function">mkSolver</a> <a id="5975" href="Polynomial.Simple.Reflection.html#5887" class="Bound">i</a> <a id="5977" class="Symbol">(</a><a id="5978" href="Polynomial.Simple.Reflection.html#5889" class="Bound">k</a> <a id="5980" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="5982" class="Symbol">)</a> <a id="5984" href="Polynomial.Simple.Reflection.html#5911" class="Bound">lhs</a> <a id="5988" href="Polynomial.Simple.Reflection.html#5919" class="Bound">rhs</a>
    <a id="5996" href="Polynomial.Simple.Reflection.html#5714" class="CatchallClause Function">go</a><a id="5998" class="CatchallClause"> </a><a id="5999" href="Polynomial.Simple.Reflection.html#5999" class="CatchallClause Bound">i</a><a id="6000" class="CatchallClause"> </a><a id="6001" href="Polynomial.Simple.Reflection.html#6001" class="CatchallClause Bound">k</a><a id="6002" class="CatchallClause"> </a><a id="6003" class="CatchallClause Symbol">(</a><a id="6004" href="Agda.Builtin.Reflection.html#4705" class="CatchallClause InductiveConstructor">def</a><a id="6007" class="CatchallClause"> </a><a id="6008" href="Polynomial.Simple.Reflection.html#6008" class="CatchallClause Bound">f</a><a id="6009" class="CatchallClause"> </a><a id="6010" class="CatchallClause Symbol">(_</a><a id="6012" class="CatchallClause"> </a><a id="6013" href="Agda.Builtin.List.html#132" class="CatchallClause InductiveConstructor Operator">∷</a><a id="6014" class="CatchallClause"> </a><a id="6015" class="CatchallClause Symbol">_</a><a id="6016" class="CatchallClause"> </a><a id="6017" href="Agda.Builtin.List.html#132" class="CatchallClause InductiveConstructor Operator">∷</a><a id="6018" class="CatchallClause"> </a><a id="6019" class="CatchallClause Symbol">_</a><a id="6020" class="CatchallClause"> </a><a id="6021" href="Agda.Builtin.List.html#132" class="CatchallClause InductiveConstructor Operator">∷</a><a id="6022" class="CatchallClause"> </a><a id="6023" href="Polynomial.Simple.Reflection.html#6023" class="CatchallClause Bound">lhs</a><a id="6026" class="CatchallClause"> </a><a id="6027" href="Polynomial.Simple.Reflection.html#723" class="CatchallClause InductiveConstructor Operator">⟨∷⟩</a><a id="6030" class="CatchallClause"> </a><a id="6031" href="Polynomial.Simple.Reflection.html#6031" class="CatchallClause Bound">rhs</a><a id="6034" class="CatchallClause"> </a><a id="6035" href="Polynomial.Simple.Reflection.html#723" class="CatchallClause InductiveConstructor Operator">⟨∷⟩</a><a id="6038" class="CatchallClause"> </a><a id="6039" href="Agda.Builtin.List.html#117" class="CatchallClause InductiveConstructor">[]</a><a id="6041" class="CatchallClause Symbol">))</a> <a id="6044" class="Symbol">=</a> <a id="6046" href="Agda.Builtin.Reflection.html#7193" class="Postulate">returnTC</a> <a id="6055" href="Function.html#1927" class="Function Operator">$</a> <a id="6057" class="Keyword">quote</a> <a id="6063" href="Polynomial.Simple.Solver.html#2804" class="Function">solve′</a> <a id="6070" href="Function.html#2548" class="Function Operator">⟨</a> <a id="6072" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="6076" href="Function.html#2548" class="Function Operator">⟩</a> <a id="6078" href="Polynomial.Simple.Reflection.html#4444" class="Function">mkSolver</a> <a id="6087" href="Polynomial.Simple.Reflection.html#5999" class="Bound">i</a> <a id="6089" class="Symbol">(</a><a id="6090" href="Polynomial.Simple.Reflection.html#6001" class="Bound">k</a> <a id="6092" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="6094" class="Symbol">)</a> <a id="6096" href="Polynomial.Simple.Reflection.html#6023" class="Bound">lhs</a> <a id="6100" href="Polynomial.Simple.Reflection.html#6031" class="Bound">rhs</a>
    <a id="6108" href="Polynomial.Simple.Reflection.html#5714" class="Function">go</a> <a id="6111" href="Polynomial.Simple.Reflection.html#6111" class="Bound">i</a> <a id="6113" href="Polynomial.Simple.Reflection.html#6113" class="Bound">k</a> <a id="6115" class="Symbol">(</a><a id="6116" href="Agda.Builtin.Reflection.html#4880" class="InductiveConstructor">pi</a> <a id="6119" href="Polynomial.Simple.Reflection.html#6119" class="Bound">a</a> <a id="6121" class="Symbol">(</a><a id="6122" href="Agda.Builtin.Reflection.html#3308" class="InductiveConstructor">abs</a> <a id="6126" href="Polynomial.Simple.Reflection.html#6126" class="Bound">s</a> <a id="6128" href="Polynomial.Simple.Reflection.html#6128" class="Bound">x</a><a id="6129" class="Symbol">))</a> <a id="6132" class="Symbol">=</a> <a id="6134" href="Polynomial.Simple.Reflection.html#5714" class="Function">go</a> <a id="6137" class="Symbol">(</a><a id="6138" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="6142" href="Polynomial.Simple.Reflection.html#6111" class="Bound">i</a><a id="6143" class="Symbol">)</a> <a id="6145" class="Symbol">(</a><a id="6146" href="Polynomial.Simple.Reflection.html#6113" class="Bound">k</a> <a id="6148" href="Function.html#805" class="Function Operator">∘</a> <a id="6150" class="Symbol">(</a><a id="6151" href="Polynomial.Simple.Reflection.html#6126" class="Bound">s</a> <a id="6153" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷_</a><a id="6155" class="Symbol">))</a> <a id="6158" href="Polynomial.Simple.Reflection.html#6128" class="Bound">x</a>
    <a id="6164" href="Polynomial.Simple.Reflection.html#5714" class="CatchallClause Function">go</a><a id="6166" class="CatchallClause"> </a><a id="6167" href="Polynomial.Simple.Reflection.html#6167" class="CatchallClause Bound">i</a><a id="6168" class="CatchallClause"> </a><a id="6169" href="Polynomial.Simple.Reflection.html#6169" class="CatchallClause Bound">k</a><a id="6170" class="CatchallClause"> </a><a id="6171" href="Polynomial.Simple.Reflection.html#6171" class="CatchallClause Bound">t</a> <a id="6173" class="Symbol">=</a> <a id="6175" href="Agda.Builtin.Reflection.html#7354" class="Postulate">typeError</a> <a id="6185" class="Symbol">(</a><a id="6186" href="Agda.Builtin.Reflection.html#6852" class="InductiveConstructor">strErr</a> <a id="6193" class="String">&quot;Malformed call to solve.&quot;</a> <a id="6220" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a>
                          <a id="6248" href="Agda.Builtin.Reflection.html#6852" class="InductiveConstructor">strErr</a> <a id="6255" class="String">&quot;Expected target type to be like: ∀ x y → x + y ≈ y + x.&quot;</a> <a id="6313" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a>
                          <a id="6341" href="Agda.Builtin.Reflection.html#6852" class="InductiveConstructor">strErr</a> <a id="6348" class="String">&quot;Instead: &quot;</a> <a id="6360" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a>
                          <a id="6388" href="Agda.Builtin.Reflection.html#6883" class="InductiveConstructor">termErr</a> <a id="6396" href="Polynomial.Simple.Reflection.html#5684" class="Bound">t′</a> <a id="6399" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a>
                          <a id="6427" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="6429" class="Symbol">)</a>

  <a id="Internal.listType"></a><a id="6434" href="Polynomial.Simple.Reflection.html#6434" class="Function">listType</a> <a id="6443" class="Symbol">:</a> <a id="6445" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="6450" class="Symbol">→</a> <a id="6452" href="Agda.Builtin.Reflection.html#7153" class="Postulate">TC</a> <a id="6455" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
  <a id="6462" href="Polynomial.Simple.Reflection.html#6434" class="Function">listType</a> <a id="6471" href="Polynomial.Simple.Reflection.html#6471" class="Bound">t</a> <a id="6473" class="Symbol">=</a>
    <a id="6479" href="Agda.Builtin.Reflection.html#7447" class="Postulate">checkType</a> <a id="6489" href="Polynomial.Simple.Reflection.html#6471" class="Bound">t</a> <a id="6491" class="Symbol">(</a><a id="6492" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="6496" class="Symbol">(</a><a id="6497" class="Keyword">quote</a> <a id="6503" href="Agda.Builtin.List.html#80" class="Datatype">List</a><a id="6507" class="Symbol">)</a> <a id="6509" class="Symbol">(</a><a id="6510" class="Number">1</a> <a id="6512" href="Polynomial.Simple.Reflection.html#857" class="Function Operator">⋯⟅∷⟆</a> <a id="6517" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="6521" class="Symbol">(</a><a id="6522" class="Keyword">quote</a> <a id="6528" href="Polynomial.Simple.AlmostCommutativeRing.html#1043" class="Field">AlmostCommutativeRing.Carrier</a><a id="6557" class="Symbol">)</a> <a id="6559" class="Symbol">(</a><a id="6560" class="Number">2</a> <a id="6562" href="Polynomial.Simple.Reflection.html#857" class="Function Operator">⋯⟅∷⟆</a> <a id="6567" href="Polynomial.Simple.Reflection.html#343" class="Bound">rng</a> <a id="6571" href="Polynomial.Simple.Reflection.html#723" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="6575" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="6577" class="Symbol">)</a> <a id="6579" href="Polynomial.Simple.Reflection.html#723" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="6583" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="6585" class="Symbol">))</a> <a id="6588" href="Function.html#2548" class="Function Operator">⟨</a> <a id="6590" href="Agda.Builtin.Reflection.html#7240" class="Postulate">bindTC</a> <a id="6597" href="Function.html#2548" class="Function Operator">⟩</a> <a id="6599" href="Agda.Builtin.Reflection.html#7487" class="Postulate">normalise</a>

  <a id="Internal.checkRing"></a><a id="6612" href="Polynomial.Simple.Reflection.html#6612" class="Function">checkRing</a> <a id="6622" class="Symbol">:</a> <a id="6624" href="Agda.Builtin.Reflection.html#7153" class="Postulate">TC</a> <a id="6627" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
  <a id="6634" href="Polynomial.Simple.Reflection.html#6612" class="Function">checkRing</a> <a id="6644" class="Symbol">=</a> <a id="6646" href="Agda.Builtin.Reflection.html#7447" class="Postulate">checkType</a> <a id="6656" href="Polynomial.Simple.Reflection.html#343" class="Bound">rng</a> <a id="6660" class="Symbol">(</a><a id="6661" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="6665" class="Symbol">(</a><a id="6666" class="Keyword">quote</a> <a id="6672" href="Polynomial.Simple.AlmostCommutativeRing.html#905" class="Record">AlmostCommutativeRing</a><a id="6693" class="Symbol">)</a> <a id="6695" class="Symbol">(</a><a id="6696" href="Agda.Builtin.Reflection.html#5048" class="InductiveConstructor">unknown</a> <a id="6704" href="Polynomial.Simple.Reflection.html#723" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="6708" href="Agda.Builtin.Reflection.html#5048" class="InductiveConstructor">unknown</a> <a id="6716" href="Polynomial.Simple.Reflection.html#723" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="6720" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="6722" class="Symbol">))</a>

  <a id="Internal.toSoln′"></a><a id="6728" href="Polynomial.Simple.Reflection.html#6728" class="Function">toSoln′</a> <a id="6736" class="Symbol">:</a> <a id="6738" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>  <a id="6744" class="Symbol">→</a> <a id="6746" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="6751" class="Symbol">→</a> <a id="6753" href="Agda.Builtin.Reflection.html#7153" class="Postulate">TC</a> <a id="6756" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
  <a id="6763" href="Polynomial.Simple.Reflection.html#6728" class="Function">toSoln′</a> <a id="6771" href="Polynomial.Simple.Reflection.html#6771" class="Bound">t′</a> <a id="6774" href="Polynomial.Simple.Reflection.html#6774" class="Bound">xs′</a> <a id="6778" class="Symbol">=</a> <a id="6780" href="Polynomial.Simple.Reflection.html#7410" class="Function">go</a> <a id="6783" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a> <a id="6786" href="Polynomial.Simple.Reflection.html#6771" class="Bound">t′</a> <a id="6789" href="Polynomial.Simple.Reflection.html#6774" class="Bound">xs′</a>
    <a id="6797" class="Keyword">where</a>
    <a id="6807" href="Polynomial.Simple.Reflection.html#6807" class="Function">go′</a> <a id="6811" class="Symbol">:</a> <a id="6813" href="Data.Nat.Table.html#151" class="Function">Table</a> <a id="6819" class="Symbol">→</a> <a id="6821" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="6826" class="Symbol">→</a> <a id="6828" href="Agda.Builtin.Reflection.html#7153" class="Postulate">TC</a> <a id="6831" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
    <a id="6840" href="Polynomial.Simple.Reflection.html#6807" class="Function">go′</a> <a id="6844" href="Polynomial.Simple.Reflection.html#6844" class="Bound">i</a> <a id="6846" class="Symbol">(</a><a id="6847" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="6851" href="Polynomial.Simple.Reflection.html#6851" class="Bound">f</a> <a id="6853" class="Symbol">(</a>            <a id="6866" href="Polynomial.Simple.Reflection.html#6866" class="Bound">lhs</a> <a id="6870" href="Polynomial.Simple.Reflection.html#723" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="6874" href="Polynomial.Simple.Reflection.html#6874" class="Bound">rhs</a> <a id="6878" href="Polynomial.Simple.Reflection.html#723" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="6882" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="6884" class="Symbol">))</a> <a id="6887" class="Symbol">=</a> <a id="6889" href="Agda.Builtin.Reflection.html#7193" class="Postulate">returnTC</a> <a id="6898" href="Function.html#1927" class="Function Operator">$</a> <a id="6900" href="Polynomial.Simple.Reflection.html#4969" class="Function">mkSolver′</a> <a id="6910" class="Symbol">(</a><a id="6911" href="Data.List.Base.html#4466" class="Function">List.length</a> <a id="6923" href="Polynomial.Simple.Reflection.html#6844" class="Bound">i</a><a id="6924" class="Symbol">)</a> <a id="6926" href="Polynomial.Simple.Reflection.html#6844" class="Bound">i</a> <a id="6928" href="Polynomial.Simple.Reflection.html#6866" class="Bound">lhs</a> <a id="6932" href="Polynomial.Simple.Reflection.html#6874" class="Bound">rhs</a>
    <a id="6940" href="Polynomial.Simple.Reflection.html#6807" class="CatchallClause Function">go′</a><a id="6943" class="CatchallClause"> </a><a id="6944" href="Polynomial.Simple.Reflection.html#6944" class="CatchallClause Bound">i</a><a id="6945" class="CatchallClause"> </a><a id="6946" class="CatchallClause Symbol">(</a><a id="6947" href="Agda.Builtin.Reflection.html#4705" class="CatchallClause InductiveConstructor">def</a><a id="6950" class="CatchallClause"> </a><a id="6951" href="Polynomial.Simple.Reflection.html#6951" class="CatchallClause Bound">f</a><a id="6952" class="CatchallClause"> </a><a id="6953" class="CatchallClause Symbol">(_</a><a id="6955" class="CatchallClause"> </a><a id="6956" href="Agda.Builtin.List.html#132" class="CatchallClause InductiveConstructor Operator">∷</a><a id="6957" class="CatchallClause"> </a><a id="6958" class="CatchallClause Symbol">_</a><a id="6959" class="CatchallClause"> </a><a id="6960" href="Agda.Builtin.List.html#132" class="CatchallClause InductiveConstructor Operator">∷</a><a id="6961" class="CatchallClause">     </a><a id="6966" href="Polynomial.Simple.Reflection.html#6966" class="CatchallClause Bound">lhs</a><a id="6969" class="CatchallClause"> </a><a id="6970" href="Polynomial.Simple.Reflection.html#723" class="CatchallClause InductiveConstructor Operator">⟨∷⟩</a><a id="6973" class="CatchallClause"> </a><a id="6974" href="Polynomial.Simple.Reflection.html#6974" class="CatchallClause Bound">rhs</a><a id="6977" class="CatchallClause"> </a><a id="6978" href="Polynomial.Simple.Reflection.html#723" class="CatchallClause InductiveConstructor Operator">⟨∷⟩</a><a id="6981" class="CatchallClause"> </a><a id="6982" href="Agda.Builtin.List.html#117" class="CatchallClause InductiveConstructor">[]</a><a id="6984" class="CatchallClause Symbol">))</a> <a id="6987" class="Symbol">=</a> <a id="6989" href="Agda.Builtin.Reflection.html#7193" class="Postulate">returnTC</a> <a id="6998" href="Function.html#1927" class="Function Operator">$</a> <a id="7000" href="Polynomial.Simple.Reflection.html#4969" class="Function">mkSolver′</a> <a id="7010" class="Symbol">(</a><a id="7011" href="Data.List.Base.html#4466" class="Function">List.length</a> <a id="7023" href="Polynomial.Simple.Reflection.html#6944" class="Bound">i</a><a id="7024" class="Symbol">)</a> <a id="7026" href="Polynomial.Simple.Reflection.html#6944" class="Bound">i</a> <a id="7028" href="Polynomial.Simple.Reflection.html#6966" class="Bound">lhs</a> <a id="7032" href="Polynomial.Simple.Reflection.html#6974" class="Bound">rhs</a>
    <a id="7040" href="Polynomial.Simple.Reflection.html#6807" class="CatchallClause Function">go′</a><a id="7043" class="CatchallClause"> </a><a id="7044" href="Polynomial.Simple.Reflection.html#7044" class="CatchallClause Bound">i</a><a id="7045" class="CatchallClause"> </a><a id="7046" class="CatchallClause Symbol">(</a><a id="7047" href="Agda.Builtin.Reflection.html#4705" class="CatchallClause InductiveConstructor">def</a><a id="7050" class="CatchallClause"> </a><a id="7051" href="Polynomial.Simple.Reflection.html#7051" class="CatchallClause Bound">f</a><a id="7052" class="CatchallClause"> </a><a id="7053" class="CatchallClause Symbol">(_</a><a id="7055" class="CatchallClause"> </a><a id="7056" href="Agda.Builtin.List.html#132" class="CatchallClause InductiveConstructor Operator">∷</a><a id="7057" class="CatchallClause"> </a><a id="7058" class="CatchallClause Symbol">_</a><a id="7059" class="CatchallClause"> </a><a id="7060" href="Agda.Builtin.List.html#132" class="CatchallClause InductiveConstructor Operator">∷</a><a id="7061" class="CatchallClause"> </a><a id="7062" class="CatchallClause Symbol">_</a><a id="7063" class="CatchallClause"> </a><a id="7064" href="Agda.Builtin.List.html#132" class="CatchallClause InductiveConstructor Operator">∷</a><a id="7065" class="CatchallClause"> </a><a id="7066" href="Polynomial.Simple.Reflection.html#7066" class="CatchallClause Bound">lhs</a><a id="7069" class="CatchallClause"> </a><a id="7070" href="Polynomial.Simple.Reflection.html#723" class="CatchallClause InductiveConstructor Operator">⟨∷⟩</a><a id="7073" class="CatchallClause"> </a><a id="7074" href="Polynomial.Simple.Reflection.html#7074" class="CatchallClause Bound">rhs</a><a id="7077" class="CatchallClause"> </a><a id="7078" href="Polynomial.Simple.Reflection.html#723" class="CatchallClause InductiveConstructor Operator">⟨∷⟩</a><a id="7081" class="CatchallClause"> </a><a id="7082" href="Agda.Builtin.List.html#117" class="CatchallClause InductiveConstructor">[]</a><a id="7084" class="CatchallClause Symbol">))</a> <a id="7087" class="Symbol">=</a> <a id="7089" href="Agda.Builtin.Reflection.html#7193" class="Postulate">returnTC</a> <a id="7098" href="Function.html#1927" class="Function Operator">$</a> <a id="7100" href="Polynomial.Simple.Reflection.html#4969" class="Function">mkSolver′</a> <a id="7110" class="Symbol">(</a><a id="7111" href="Data.List.Base.html#4466" class="Function">List.length</a> <a id="7123" href="Polynomial.Simple.Reflection.html#7044" class="Bound">i</a><a id="7124" class="Symbol">)</a> <a id="7126" href="Polynomial.Simple.Reflection.html#7044" class="Bound">i</a> <a id="7128" href="Polynomial.Simple.Reflection.html#7066" class="Bound">lhs</a> <a id="7132" href="Polynomial.Simple.Reflection.html#7074" class="Bound">rhs</a>
    <a id="7140" href="Polynomial.Simple.Reflection.html#6807" class="CatchallClause Function">go′</a><a id="7143" class="CatchallClause"> </a><a id="7144" class="CatchallClause Symbol">_</a><a id="7145" class="CatchallClause"> </a><a id="7146" class="CatchallClause Symbol">_</a> <a id="7148" class="Symbol">=</a> <a id="7150" href="Agda.Builtin.Reflection.html#7354" class="Postulate">typeError</a> <a id="7160" class="Symbol">(</a><a id="7161" href="Agda.Builtin.Reflection.html#6852" class="InductiveConstructor">strErr</a> <a id="7168" class="String">&quot;Malformed call to solveOver.&quot;</a> <a id="7199" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a>
                         <a id="7226" href="Agda.Builtin.Reflection.html#6852" class="InductiveConstructor">strErr</a> <a id="7233" class="String">&quot;Target type should be an equality like x + y ≈ y + x.&quot;</a> <a id="7289" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a>
                         <a id="7316" href="Agda.Builtin.Reflection.html#6852" class="InductiveConstructor">strErr</a> <a id="7323" class="String">&quot;Instead: &quot;</a> <a id="7335" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a>
                         <a id="7362" href="Agda.Builtin.Reflection.html#6883" class="InductiveConstructor">termErr</a> <a id="7370" href="Polynomial.Simple.Reflection.html#6774" class="Bound">xs′</a> <a id="7374" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a>
                         <a id="7401" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="7403" class="Symbol">)</a>

    <a id="7410" href="Polynomial.Simple.Reflection.html#7410" class="Function">go</a> <a id="7413" class="Symbol">:</a> <a id="7415" href="Data.Nat.Table.html#151" class="Function">Table</a> <a id="7421" class="Symbol">→</a> <a id="7423" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="7428" class="Symbol">→</a> <a id="7430" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="7435" class="Symbol">→</a> <a id="7437" href="Agda.Builtin.Reflection.html#7153" class="Postulate">TC</a> <a id="7440" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
    <a id="7449" href="Polynomial.Simple.Reflection.html#7410" class="Function">go</a> <a id="7452" href="Polynomial.Simple.Reflection.html#7452" class="Bound">t</a> <a id="7454" class="Symbol">(</a><a id="7455" href="Agda.Builtin.Reflection.html#4648" class="InductiveConstructor">con</a> <a id="7459" class="Symbol">(</a><a id="7460" class="Keyword">quote</a> <a id="7466" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">List._∷_</a><a id="7474" class="Symbol">)</a> <a id="7476" class="Symbol">(_</a> <a id="7479" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="7481" class="Symbol">_</a> <a id="7483" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="7485" href="Agda.Builtin.Reflection.html#4592" class="InductiveConstructor">var</a> <a id="7489" href="Polynomial.Simple.Reflection.html#7489" class="Bound">i</a> <a id="7491" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a> <a id="7494" href="Polynomial.Simple.Reflection.html#723" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="7498" href="Polynomial.Simple.Reflection.html#7498" class="Bound">xs</a> <a id="7501" href="Polynomial.Simple.Reflection.html#723" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="7505" class="Symbol">_))</a> <a id="7509" href="Polynomial.Simple.Reflection.html#7509" class="Bound">ys</a> <a id="7512" class="Symbol">=</a> <a id="7514" href="Polynomial.Simple.Reflection.html#7410" class="Function">go</a> <a id="7517" class="Symbol">(</a><a id="7518" href="Data.Nat.Table.html#179" class="Function">insert</a> <a id="7525" href="Polynomial.Simple.Reflection.html#7489" class="Bound">i</a> <a id="7527" href="Polynomial.Simple.Reflection.html#7452" class="Bound">t</a><a id="7528" class="Symbol">)</a> <a id="7530" href="Polynomial.Simple.Reflection.html#7498" class="Bound">xs</a> <a id="7533" href="Polynomial.Simple.Reflection.html#7509" class="Bound">ys</a>
    <a id="7540" href="Polynomial.Simple.Reflection.html#7410" class="Function">go</a> <a id="7543" href="Polynomial.Simple.Reflection.html#7543" class="Bound">t</a> <a id="7545" class="Symbol">(</a><a id="7546" href="Agda.Builtin.Reflection.html#4648" class="InductiveConstructor">con</a> <a id="7550" class="Symbol">(</a><a id="7551" class="Keyword">quote</a> <a id="7557" href="Agda.Builtin.List.html#117" class="InductiveConstructor">List.List.[]</a><a id="7569" class="Symbol">)</a> <a id="7571" class="Symbol">_)</a> <a id="7574" href="Polynomial.Simple.Reflection.html#7574" class="Bound">xs</a> <a id="7577" class="Symbol">=</a> <a id="7579" href="Polynomial.Simple.Reflection.html#6807" class="Function">go′</a> <a id="7583" href="Polynomial.Simple.Reflection.html#7543" class="Bound">t</a> <a id="7585" href="Polynomial.Simple.Reflection.html#7574" class="Bound">xs</a>
    <a id="7592" href="Polynomial.Simple.Reflection.html#7410" class="CatchallClause Function">go</a><a id="7594" class="CatchallClause"> </a><a id="7595" href="Polynomial.Simple.Reflection.html#7595" class="CatchallClause Bound">i</a><a id="7596" class="CatchallClause"> </a><a id="7597" href="Polynomial.Simple.Reflection.html#7597" class="CatchallClause Bound">k</a><a id="7598" class="CatchallClause"> </a><a id="7599" href="Polynomial.Simple.Reflection.html#7599" class="CatchallClause Bound">t</a> <a id="7601" class="Symbol">=</a> <a id="7603" href="Agda.Builtin.Reflection.html#7354" class="Postulate">typeError</a> <a id="7613" class="Symbol">(</a><a id="7614" href="Agda.Builtin.Reflection.html#6852" class="InductiveConstructor">strErr</a> <a id="7621" class="String">&quot;Malformed call to solveOver.&quot;</a> <a id="7652" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a>
                          <a id="7680" href="Agda.Builtin.Reflection.html#6852" class="InductiveConstructor">strErr</a> <a id="7687" class="String">&quot;First argument should be a list of free variables.&quot;</a> <a id="7740" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a>
                          <a id="7768" href="Agda.Builtin.Reflection.html#6852" class="InductiveConstructor">strErr</a> <a id="7775" class="String">&quot;Instead: &quot;</a> <a id="7787" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a>
                          <a id="7815" href="Agda.Builtin.Reflection.html#6883" class="InductiveConstructor">termErr</a> <a id="7823" href="Polynomial.Simple.Reflection.html#6771" class="Bound">t′</a> <a id="7826" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a>
                          <a id="7854" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="7856" class="Symbol">)</a>
<a id="7858" class="Keyword">open</a> <a id="7863" href="Polynomial.Simple.Reflection.html#333" class="Module">Internal</a>

<a id="7873" class="Comment">-- This is the main macro you&#39;ll probably be using. Call it like this:</a>
<a id="7944" class="Comment">--</a>
<a id="7947" class="Comment">--   lemma : ∀ x y → x + y ≈ y + x</a>
<a id="7982" class="Comment">--   lemma = solve TypeRing</a>
<a id="8010" class="Comment">--</a>
<a id="8013" class="Comment">-- where TypRing is your implementation of AlmostCommutativeRing. (Find some</a>
<a id="8090" class="Comment">-- example implementations in Polynomial.Solver.Ring.AlmostCommutativeRing.Instances).</a>
<a id="8177" class="Keyword">macro</a>
  <a id="solve"></a><a id="8185" href="Polynomial.Simple.Reflection.html#8185" class="Function">solve</a> <a id="8191" class="Symbol">:</a> <a id="8193" href="Agda.Builtin.Reflection.html#363" class="Postulate">Name</a> <a id="8198" class="Symbol">→</a> <a id="8200" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="8205" class="Symbol">→</a> <a id="8207" href="Agda.Builtin.Reflection.html#7153" class="Postulate">TC</a> <a id="8210" href="Agda.Builtin.Unit.html#69" class="Record">⊤</a>
  <a id="8214" href="Polynomial.Simple.Reflection.html#8185" class="Function">solve</a> <a id="8220" href="Polynomial.Simple.Reflection.html#8220" class="Bound">rng′</a> <a id="8225" href="Polynomial.Simple.Reflection.html#8225" class="Bound">hole</a> <a id="8230" class="Symbol">=</a> <a id="8232" class="Keyword">do</a>
    <a id="8239" href="Polynomial.Simple.Reflection.html#8239" class="Bound">rng</a> <a id="8243" href="Polynomial.Simple.Reflection.html#263" class="Function Operator">←</a> <a id="8245" href="Polynomial.Simple.Reflection.html#6612" class="Function">checkRing</a> <a id="8255" class="Symbol">(</a><a id="8256" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="8260" href="Polynomial.Simple.Reflection.html#8220" class="Bound">rng′</a> <a id="8265" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="8267" class="Symbol">)</a>
    <a id="8273" class="Symbol">_</a> <a id="8275" href="Polynomial.Simple.Reflection.html#263" class="Function Operator">←</a> <a id="8277" href="Agda.Builtin.Reflection.html#8165" class="Postulate">commitTC</a>
    <a id="8290" href="Agda.Builtin.Reflection.html#7414" class="Postulate">inferType</a> <a id="8300" href="Polynomial.Simple.Reflection.html#8225" class="Bound">hole</a> <a id="8305" href="Function.html#2548" class="Function Operator">⟨</a> <a id="8307" href="Agda.Builtin.Reflection.html#7240" class="Postulate">bindTC</a> <a id="8314" href="Function.html#2548" class="Function Operator">⟩</a> <a id="8316" href="Agda.Builtin.Reflection.html#7520" class="Postulate">reduce</a> <a id="8323" href="Function.html#2548" class="Function Operator">⟨</a> <a id="8325" href="Agda.Builtin.Reflection.html#7240" class="Postulate">bindTC</a> <a id="8332" href="Function.html#2548" class="Function Operator">⟩</a> <a id="8334" href="Polynomial.Simple.Reflection.html#5651" class="Function">toSoln</a> <a id="8341" href="Polynomial.Simple.Reflection.html#8239" class="Bound">rng</a> <a id="8345" href="Function.html#2548" class="Function Operator">⟨</a> <a id="8347" href="Agda.Builtin.Reflection.html#7240" class="Postulate">bindTC</a> <a id="8354" href="Function.html#2548" class="Function Operator">⟩</a> <a id="8356" href="Agda.Builtin.Reflection.html#7317" class="Postulate">unify</a> <a id="8362" href="Polynomial.Simple.Reflection.html#8225" class="Bound">hole</a>

<a id="8368" class="Comment">-- Use this macro when you want to solve something *under* a lambda. For example:</a>
<a id="8450" class="Comment">-- say you have a long proof, and you just want the solver to deal with an</a>
<a id="8525" class="Comment">-- intermediate step. Call it like so:</a>
<a id="8564" class="Comment">--</a>
<a id="8567" class="Comment">--   lemma₃ : ∀ x y → x + y * 1 + 3 ≈ 2 + 1 + y + x</a>
<a id="8619" class="Comment">--   lemma₃ x y = begin</a>
<a id="8643" class="Comment">--     x + y * 1 + 3 ≈⟨ +-comm x (y * 1) ⟨ +-cong ⟩ refl ⟩</a>
<a id="8702" class="Comment">--     y * 1 + x + 3 ≈⟨ solveOver (x ∷ y ∷ []) Int.ring ⟩</a>
<a id="8760" class="Comment">--     3 + y + x     ≡⟨ refl ⟩</a>
<a id="8791" class="Comment">--     2 + 1 + y + x ∎</a>
<a id="8814" class="Comment">--</a>
<a id="8817" class="Comment">-- The first argument is the free variables, and the second is the</a>
<a id="8884" class="Comment">-- ring implementation (as before).</a>
<a id="8920" class="Comment">--</a>
<a id="8923" class="Comment">-- One thing to note here is that we need to be able to infer *both* sides of</a>
<a id="9001" class="Comment">-- the equality, which the normal equaltional reasoning combinators don&#39;t let you</a>
<a id="9083" class="Comment">-- do. You&#39;ll need the combinators defined in Relation.Binary.Reasoning.Inference.</a>
<a id="9166" class="Comment">-- These are just as powerful as the others, but have slightly better inference properties.</a>

<a id="9259" class="Keyword">macro</a>
  <a id="solveOver"></a><a id="9267" href="Polynomial.Simple.Reflection.html#9267" class="Function">solveOver</a> <a id="9277" class="Symbol">:</a> <a id="9279" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="9284" class="Symbol">→</a> <a id="9286" href="Agda.Builtin.Reflection.html#363" class="Postulate">Name</a> <a id="9291" class="Symbol">→</a> <a id="9293" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="9298" class="Symbol">→</a> <a id="9300" href="Agda.Builtin.Reflection.html#7153" class="Postulate">TC</a> <a id="9303" href="Agda.Builtin.Unit.html#69" class="Record">⊤</a>
  <a id="9307" href="Polynomial.Simple.Reflection.html#9267" class="Function">solveOver</a> <a id="9317" href="Polynomial.Simple.Reflection.html#9317" class="Bound">i′</a> <a id="9320" href="Polynomial.Simple.Reflection.html#9320" class="Bound">rng′</a> <a id="9325" href="Polynomial.Simple.Reflection.html#9325" class="Bound">hole</a> <a id="9330" class="Symbol">=</a> <a id="9332" class="Keyword">do</a>
    <a id="9339" href="Polynomial.Simple.Reflection.html#9339" class="Bound">rng</a> <a id="9343" href="Polynomial.Simple.Reflection.html#263" class="Function Operator">←</a> <a id="9345" href="Polynomial.Simple.Reflection.html#6612" class="Function">checkRing</a> <a id="9355" class="Symbol">(</a><a id="9356" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="9360" href="Polynomial.Simple.Reflection.html#9320" class="Bound">rng′</a> <a id="9365" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="9367" class="Symbol">)</a>
    <a id="9373" class="Symbol">_</a> <a id="9375" href="Polynomial.Simple.Reflection.html#263" class="Function Operator">←</a> <a id="9377" href="Agda.Builtin.Reflection.html#8165" class="Postulate">commitTC</a>
    <a id="9390" href="Polynomial.Simple.Reflection.html#9390" class="Bound">i</a> <a id="9392" href="Polynomial.Simple.Reflection.html#263" class="Function Operator">←</a> <a id="9394" href="Polynomial.Simple.Reflection.html#6434" class="Function">listType</a> <a id="9403" href="Polynomial.Simple.Reflection.html#9339" class="Bound">rng</a> <a id="9407" href="Polynomial.Simple.Reflection.html#9317" class="Bound">i′</a>
    <a id="9414" class="Symbol">_</a> <a id="9416" href="Polynomial.Simple.Reflection.html#263" class="Function Operator">←</a> <a id="9418" href="Agda.Builtin.Reflection.html#8165" class="Postulate">commitTC</a>
    <a id="9431" href="Agda.Builtin.Reflection.html#7414" class="Postulate">inferType</a> <a id="9441" href="Polynomial.Simple.Reflection.html#9325" class="Bound">hole</a> <a id="9446" href="Function.html#2548" class="Function Operator">⟨</a> <a id="9448" href="Agda.Builtin.Reflection.html#7240" class="Postulate">bindTC</a> <a id="9455" href="Function.html#2548" class="Function Operator">⟩</a> <a id="9457" href="Agda.Builtin.Reflection.html#7520" class="Postulate">reduce</a> <a id="9464" href="Function.html#2548" class="Function Operator">⟨</a> <a id="9466" href="Agda.Builtin.Reflection.html#7240" class="Postulate">bindTC</a> <a id="9473" href="Function.html#2548" class="Function Operator">⟩</a> <a id="9475" href="Polynomial.Simple.Reflection.html#6728" class="Function">toSoln′</a> <a id="9483" href="Polynomial.Simple.Reflection.html#9339" class="Bound">rng</a> <a id="9487" href="Polynomial.Simple.Reflection.html#9390" class="Bound">i</a> <a id="9489" href="Function.html#2548" class="Function Operator">⟨</a> <a id="9491" href="Agda.Builtin.Reflection.html#7240" class="Postulate">bindTC</a> <a id="9498" href="Function.html#2548" class="Function Operator">⟩</a> <a id="9500" href="Agda.Builtin.Reflection.html#7317" class="Postulate">unify</a> <a id="9506" href="Polynomial.Simple.Reflection.html#9325" class="Bound">hole</a>
</pre></body></html>