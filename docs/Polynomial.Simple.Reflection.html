<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Polynomial.Simple.Reflection</title><link rel="stylesheet" href="Agda.css"></head><body><pre><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Option">--without-K</a> <a id="25" class="Option">--safe</a> <a id="32" class="Symbol">#-}</a>

<a id="37" class="Keyword">module</a> <a id="44" href="Polynomial.Simple.Reflection.html" class="Module">Polynomial.Simple.Reflection</a> <a id="73" class="Keyword">where</a>

<a id="80" class="Keyword">open</a> <a id="85" class="Keyword">import</a> <a id="92" href="Agda.Builtin.Reflection.html" class="Module">Agda.Builtin.Reflection</a>
<a id="116" class="Keyword">open</a> <a id="121" class="Keyword">import</a> <a id="128" href="Reflection.html" class="Module">Reflection</a>
<a id="139" class="Keyword">open</a> <a id="144" class="Keyword">import</a> <a id="151" href="Function.html" class="Module">Function</a>
<a id="160" class="Keyword">open</a> <a id="165" class="Keyword">import</a> <a id="172" href="Data.Unit.html" class="Module">Data.Unit</a> <a id="182" class="Keyword">using</a> <a id="188" class="Symbol">(</a><a id="189" href="Agda.Builtin.Unit.html#69" class="Record">⊤</a><a id="190" class="Symbol">;</a> <a id="192" href="Agda.Builtin.Unit.html#106" class="InductiveConstructor">tt</a><a id="194" class="Symbol">)</a>
<a id="196" class="Keyword">open</a> <a id="201" class="Keyword">import</a> <a id="208" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="217" class="Symbol">as</a> <a id="220" class="Module">ℕ</a> <a id="222" class="Keyword">using</a> <a id="228" class="Symbol">(</a><a id="229" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a><a id="230" class="Symbol">;</a> <a id="232" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a><a id="235" class="Symbol">;</a> <a id="237" href="Agda.Builtin.Nat.html#115" class="InductiveConstructor">zero</a><a id="241" class="Symbol">)</a>
<a id="243" class="Keyword">open</a> <a id="248" class="Keyword">import</a> <a id="255" href="Data.List.html" class="Module">Data.List</a> <a id="265" class="Symbol">as</a> <a id="268" class="Module">List</a> <a id="273" class="Keyword">using</a> <a id="279" class="Symbol">(</a><a id="280" href="Agda.Builtin.List.html#80" class="Datatype">List</a><a id="284" class="Symbol">;</a> <a id="286" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">_∷_</a><a id="289" class="Symbol">;</a> <a id="291" href="Data.List.Base.html#9863" class="InductiveConstructor">[]</a><a id="293" class="Symbol">;</a> <a id="295" href="Data.List.Base.html#3600" class="Function">foldr</a><a id="300" class="Symbol">)</a>
<a id="302" class="Keyword">open</a> <a id="307" class="Keyword">import</a> <a id="314" href="Reflection.Helpers.html" class="Module">Reflection.Helpers</a>

<a id="334" class="Keyword">module</a> <a id="Internal"></a><a id="341" href="Polynomial.Simple.Reflection.html#341" class="Module">Internal</a> <a id="350" class="Symbol">(</a><a id="351" href="Polynomial.Simple.Reflection.html#351" class="Bound">rng</a> <a id="355" class="Symbol">:</a> <a id="357" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a><a id="361" class="Symbol">)</a> <a id="363" class="Keyword">where</a>
  <a id="371" class="Keyword">open</a> <a id="376" class="Keyword">import</a> <a id="383" href="Polynomial.Simple.Solver.html" class="Module">Polynomial.Simple.Solver</a> <a id="408" class="Keyword">renaming</a> <a id="417" class="Symbol">(</a><a id="418" href="Polynomial.Simple.Solver.html#2736" class="Function">solve</a> <a id="424" class="Symbol">to</a> <a id="427" href="Polynomial.Simple.Solver.html#2736" class="Function">solve′</a><a id="433" class="Symbol">)</a>
  <a id="437" class="Keyword">open</a> <a id="442" class="Keyword">import</a> <a id="449" href="Data.String.html" class="Module">Data.String</a>
  <a id="463" class="Keyword">open</a> <a id="468" class="Keyword">import</a> <a id="475" href="Relation.Nullary.html" class="Module">Relation.Nullary</a> <a id="492" class="Keyword">using</a> <a id="498" class="Symbol">(</a><a id="499" href="Relation.Nullary.html#570" class="Datatype">Dec</a><a id="502" class="Symbol">;</a> <a id="504" href="Relation.Nullary.html#606" class="InductiveConstructor">yes</a><a id="507" class="Symbol">;</a> <a id="509" href="Relation.Nullary.html#633" class="InductiveConstructor">no</a><a id="511" class="Symbol">)</a>
  <a id="515" class="Keyword">import</a> <a id="522" href="Data.Vec.html" class="Module">Data.Vec</a> <a id="531" class="Symbol">as</a> <a id="534" class="Module">Vec</a>
  <a id="540" class="Keyword">import</a> <a id="547" href="Data.Fin.html" class="Module">Data.Fin</a> <a id="556" class="Symbol">as</a> <a id="559" class="Module">Fin</a>
  <a id="565" class="Keyword">open</a> <a id="570" class="Keyword">import</a> <a id="577" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="588" class="Symbol">as</a> <a id="591" class="Module">Maybe</a> <a id="597" class="Keyword">using</a> <a id="603" class="Symbol">(</a><a id="604" href="Data.Maybe.Base.html#710" class="Datatype">Maybe</a><a id="609" class="Symbol">;</a> <a id="611" href="Data.Maybe.Base.html#748" class="InductiveConstructor">just</a><a id="615" class="Symbol">;</a> <a id="617" href="Data.Maybe.Base.html#778" class="InductiveConstructor">nothing</a><a id="624" class="Symbol">)</a>
  <a id="628" class="Keyword">open</a> <a id="633" href="Polynomial.Simple.AlmostCommutativeRing.html#941" class="Module">AlmostCommutativeRing</a>

  <a id="658" class="Keyword">open</a> <a id="663" class="Keyword">import</a> <a id="670" href="Data.Nat.Table.html" class="Module">Data.Nat.Table</a>

  <a id="688" class="Keyword">module</a> <a id="695" href="Polynomial.Simple.Reflection.html#695" class="Module">_</a> <a id="697" class="Symbol">(</a><a id="698" href="Polynomial.Simple.Reflection.html#698" class="Bound">numVars</a> <a id="706" class="Symbol">:</a> <a id="708" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a><a id="709" class="Symbol">)</a> <a id="711" class="Keyword">where</a>

    <a id="722" class="Comment">-- This function applies the hidden arguments that the constructors</a>
    <a id="794" class="Comment">-- that Expr needs. The first is the universe level, the second is the</a>
    <a id="869" class="Comment">-- type it contains, and the third is the number of variables it&#39;s</a>
    <a id="940" class="Comment">-- indexed by. All three of these could likely be inferred, but to</a>
    <a id="1011" class="Comment">-- make things easier we supply the third because we know it.</a>
    <a id="1077" class="Keyword">infixr</a> <a id="1084" class="Number">5</a> <a id="1086" href="Polynomial.Simple.Reflection.html#1096" class="Function Operator">E⟅∷⟆_</a>
    <a id="1096" href="Polynomial.Simple.Reflection.html#1096" class="Function Operator">E⟅∷⟆_</a> <a id="1102" class="Symbol">:</a> <a id="1104" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="1109" class="Symbol">(</a><a id="1110" href="Agda.Builtin.Reflection.html#3041" class="Datatype">Arg</a> <a id="1114" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a><a id="1118" class="Symbol">)</a> <a id="1120" class="Symbol">→</a> <a id="1122" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="1127" class="Symbol">(</a><a id="1128" href="Agda.Builtin.Reflection.html#3041" class="Datatype">Arg</a> <a id="1132" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a><a id="1136" class="Symbol">)</a>
    <a id="1142" href="Polynomial.Simple.Reflection.html#1096" class="Function Operator">E⟅∷⟆</a> <a id="1147" href="Polynomial.Simple.Reflection.html#1147" class="Bound">xs</a> <a id="1150" class="Symbol">=</a> <a id="1152" class="Number">1</a> <a id="1154" href="Reflection.Helpers.html#1287" class="Function Operator">⋯⟅∷⟆</a>
              <a id="1173" class="Symbol">(</a><a id="1174" class="Keyword">quote</a> <a id="1180" href="Polynomial.Simple.AlmostCommutativeRing.html#1079" class="Field">Carrier</a> <a id="1188" href="Function.html#2548" class="Function Operator">⟨</a> <a id="1190" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="1194" href="Function.html#2548" class="Function Operator">⟩</a> <a id="1196" class="Number">2</a> <a id="1198" href="Reflection.Helpers.html#1287" class="Function Operator">⋯⟅∷⟆</a> <a id="1203" href="Polynomial.Simple.Reflection.html#351" class="Bound">rng</a> <a id="1207" href="Reflection.Helpers.html#1158" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="1211" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="1213" class="Symbol">)</a> <a id="1215" href="Reflection.Helpers.html#1218" class="InductiveConstructor Operator">⟅∷⟆</a>
              <a id="1233" href="Reflection.Helpers.html#1392" class="Function">natTerm</a> <a id="1241" href="Polynomial.Simple.Reflection.html#698" class="Bound">numVars</a> <a id="1249" href="Reflection.Helpers.html#1218" class="InductiveConstructor Operator">⟅∷⟆</a>
              <a id="1267" href="Polynomial.Simple.Reflection.html#1147" class="Bound">xs</a>

    <a id="1275" class="Comment">-- A constant expression.</a>
    <a id="1305" href="Polynomial.Simple.Reflection.html#1305" class="Function">constExpr</a> <a id="1315" class="Symbol">:</a> <a id="1317" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="1322" class="Symbol">→</a> <a id="1324" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
    <a id="1333" href="Polynomial.Simple.Reflection.html#1305" class="Function">constExpr</a> <a id="1343" href="Polynomial.Simple.Reflection.html#1343" class="Bound">x</a> <a id="1345" class="Symbol">=</a> <a id="1347" class="Keyword">quote</a> <a id="1353" href="Polynomial.Expr.html#290" class="InductiveConstructor">Κ</a> <a id="1355" href="Function.html#2548" class="Function Operator">⟨</a> <a id="1357" href="Agda.Builtin.Reflection.html#4648" class="InductiveConstructor">con</a> <a id="1361" href="Function.html#2548" class="Function Operator">⟩</a> <a id="1363" href="Polynomial.Simple.Reflection.html#1096" class="Function Operator">E⟅∷⟆</a> <a id="1368" href="Polynomial.Simple.Reflection.html#1343" class="Bound">x</a> <a id="1370" href="Reflection.Helpers.html#1158" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="1374" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>

    <a id="1382" class="Keyword">module</a> <a id="ToExpr"></a><a id="1389" href="Polynomial.Simple.Reflection.html#1389" class="Module">ToExpr</a> <a id="1396" class="Symbol">(</a><a id="1397" href="Polynomial.Simple.Reflection.html#1397" class="Bound">varExpr</a> <a id="1405" class="Symbol">:</a> <a id="1407" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="1409" class="Symbol">→</a> <a id="1411" href="Data.Maybe.Base.html#710" class="Datatype">Maybe</a> <a id="1417" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a><a id="1421" class="Symbol">)</a> <a id="1423" class="Keyword">where</a>
      <a id="1435" class="Keyword">mutual</a>
        <a id="1450" class="Comment">-- Application of a ring operator often doesn&#39;t have a type as</a>
        <a id="1521" class="Comment">-- simple as &quot;Carrier → Carrier → Carrier&quot;: there may be hidden</a>
        <a id="1593" class="Comment">-- arguments, etc. Here, we do our best to handle those cases,</a>
        <a id="1664" class="Comment">-- by just taking the last two explicit arguments.</a>
        <a id="1723" href="Polynomial.Simple.Reflection.html#1723" class="Function">getBinOp</a> <a id="1732" class="Symbol">:</a> <a id="1734" href="Agda.Builtin.Reflection.html#363" class="Postulate">Name</a> <a id="1739" class="Symbol">→</a> <a id="1741" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="1746" class="Symbol">(</a><a id="1747" href="Agda.Builtin.Reflection.html#3041" class="Datatype">Arg</a> <a id="1751" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a><a id="1755" class="Symbol">)</a> <a id="1757" class="Symbol">→</a> <a id="1759" href="Agda.Builtin.Reflection.html#7153" class="Postulate">TC</a> <a id="1762" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
        <a id="1775" href="Polynomial.Simple.Reflection.html#1723" class="Function">getBinOp</a> <a id="1784" href="Polynomial.Simple.Reflection.html#1784" class="Bound">nm</a> <a id="1787" class="Symbol">(</a><a id="1788" href="Polynomial.Simple.Reflection.html#1788" class="Bound">x</a> <a id="1790" href="Reflection.Helpers.html#1158" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="1794" href="Polynomial.Simple.Reflection.html#1794" class="Bound">y</a> <a id="1796" href="Reflection.Helpers.html#1158" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="1800" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="1802" class="Symbol">)</a> <a id="1804" class="Symbol">=</a> <a id="1806" href="Agda.Builtin.Reflection.html#4648" class="InductiveConstructor">con</a> <a id="1810" href="Polynomial.Simple.Reflection.html#1784" class="Bound">nm</a> <a id="1813" href="Function.html#994" class="Function Operator">∘′</a> <a id="1816" href="Polynomial.Simple.Reflection.html#1096" class="Function Operator">E⟅∷⟆_</a> <a id="1822" href="Reflection.Helpers.html#989" class="Function Operator">&lt;$&gt;</a> <a id="1826" class="Symbol">⦇</a> <a id="1828" href="Polynomial.Simple.Reflection.html#3138" class="Function">toExpr</a> <a id="1835" href="Polynomial.Simple.Reflection.html#1788" class="Bound">x</a> <a id="1837" href="Reflection.Helpers.html#1158" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="1841" class="Symbol">⦇</a> <a id="1843" href="Polynomial.Simple.Reflection.html#3138" class="Function">toExpr</a> <a id="1850" href="Polynomial.Simple.Reflection.html#1794" class="Bound">y</a> <a id="1852" href="Reflection.Helpers.html#1158" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="1856" href="Reflection.Helpers.html#569" class="Function">pure</a> <a id="1861" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a> <a id="1864" class="Symbol">⦈</a> <a id="1866" class="Symbol">⦈</a>
        <a id="1876" href="Polynomial.Simple.Reflection.html#1723" class="CatchallClause Function">getBinOp</a><a id="1884" class="CatchallClause"> </a><a id="1885" href="Polynomial.Simple.Reflection.html#1885" class="CatchallClause Bound">nm</a><a id="1887" class="CatchallClause"> </a><a id="1888" class="CatchallClause Symbol">(</a><a id="1889" href="Polynomial.Simple.Reflection.html#1889" class="CatchallClause Bound">x</a><a id="1890" class="CatchallClause"> </a><a id="1891" href="Agda.Builtin.List.html#132" class="CatchallClause InductiveConstructor Operator">∷</a><a id="1892" class="CatchallClause"> </a><a id="1893" href="Polynomial.Simple.Reflection.html#1893" class="CatchallClause Bound">xs</a><a id="1895" class="CatchallClause Symbol">)</a> <a id="1897" class="Symbol">=</a> <a id="1899" href="Polynomial.Simple.Reflection.html#1723" class="Function">getBinOp</a> <a id="1908" href="Polynomial.Simple.Reflection.html#1885" class="Bound">nm</a> <a id="1911" href="Polynomial.Simple.Reflection.html#1893" class="Bound">xs</a>
        <a id="1922" href="Polynomial.Simple.Reflection.html#1723" class="CatchallClause Function">getBinOp</a><a id="1930" class="CatchallClause"> </a><a id="1931" class="CatchallClause Symbol">_</a><a id="1932" class="CatchallClause"> </a><a id="1933" class="CatchallClause Symbol">_</a> <a id="1935" class="Symbol">=</a> <a id="1937" href="Agda.Builtin.Reflection.html#7354" class="Postulate">typeError</a> <a id="1947" class="Symbol">(</a><a id="1948" href="Agda.Builtin.Reflection.html#6852" class="InductiveConstructor">strErr</a> <a id="1955" class="String">&quot;getBinOp&quot;</a> <a id="1966" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="1968" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="1970" class="Symbol">)</a>

        <a id="1981" href="Polynomial.Simple.Reflection.html#1981" class="Function">getUnOp</a> <a id="1989" class="Symbol">:</a> <a id="1991" href="Agda.Builtin.Reflection.html#363" class="Postulate">Name</a> <a id="1996" class="Symbol">→</a> <a id="1998" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="2003" class="Symbol">(</a><a id="2004" href="Agda.Builtin.Reflection.html#3041" class="Datatype">Arg</a> <a id="2008" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a><a id="2012" class="Symbol">)</a> <a id="2014" class="Symbol">→</a> <a id="2016" href="Agda.Builtin.Reflection.html#7153" class="Postulate">TC</a> <a id="2019" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
        <a id="2032" href="Polynomial.Simple.Reflection.html#1981" class="Function">getUnOp</a> <a id="2040" href="Polynomial.Simple.Reflection.html#2040" class="Bound">nm</a> <a id="2043" class="Symbol">(</a><a id="2044" href="Polynomial.Simple.Reflection.html#2044" class="Bound">x</a> <a id="2046" href="Reflection.Helpers.html#1158" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="2050" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="2052" class="Symbol">)</a> <a id="2054" class="Symbol">=</a> <a id="2056" class="Symbol">(λ</a> <a id="2059" href="Polynomial.Simple.Reflection.html#2059" class="Bound">x′</a> <a id="2062" class="Symbol">→</a> <a id="2064" href="Polynomial.Simple.Reflection.html#2040" class="Bound">nm</a> <a id="2067" href="Function.html#2548" class="Function Operator">⟨</a> <a id="2069" href="Agda.Builtin.Reflection.html#4648" class="InductiveConstructor">con</a> <a id="2073" href="Function.html#2548" class="Function Operator">⟩</a> <a id="2075" href="Polynomial.Simple.Reflection.html#1096" class="Function Operator">E⟅∷⟆</a> <a id="2080" href="Polynomial.Simple.Reflection.html#2059" class="Bound">x′</a> <a id="2083" href="Reflection.Helpers.html#1158" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="2087" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="2089" class="Symbol">)</a> <a id="2091" href="Reflection.Helpers.html#989" class="Function Operator">&lt;$&gt;</a> <a id="2095" href="Polynomial.Simple.Reflection.html#3138" class="Function">toExpr</a> <a id="2102" href="Polynomial.Simple.Reflection.html#2044" class="Bound">x</a>
        <a id="2112" href="Polynomial.Simple.Reflection.html#1981" class="CatchallClause Function">getUnOp</a><a id="2119" class="CatchallClause"> </a><a id="2120" href="Polynomial.Simple.Reflection.html#2120" class="CatchallClause Bound">nm</a><a id="2122" class="CatchallClause"> </a><a id="2123" class="CatchallClause Symbol">(</a><a id="2124" href="Polynomial.Simple.Reflection.html#2124" class="CatchallClause Bound">x</a><a id="2125" class="CatchallClause"> </a><a id="2126" href="Agda.Builtin.List.html#132" class="CatchallClause InductiveConstructor Operator">∷</a><a id="2127" class="CatchallClause"> </a><a id="2128" href="Polynomial.Simple.Reflection.html#2128" class="CatchallClause Bound">xs</a><a id="2130" class="CatchallClause Symbol">)</a> <a id="2132" class="Symbol">=</a> <a id="2134" href="Polynomial.Simple.Reflection.html#1981" class="Function">getUnOp</a> <a id="2142" href="Polynomial.Simple.Reflection.html#2120" class="Bound">nm</a> <a id="2145" href="Polynomial.Simple.Reflection.html#2128" class="Bound">xs</a>
        <a id="2156" href="Polynomial.Simple.Reflection.html#1981" class="CatchallClause Function">getUnOp</a><a id="2163" class="CatchallClause"> </a><a id="2164" class="CatchallClause Symbol">_</a><a id="2165" class="CatchallClause"> </a><a id="2166" class="CatchallClause Symbol">_</a> <a id="2168" class="Symbol">=</a> <a id="2170" href="Agda.Builtin.Reflection.html#7354" class="Postulate">typeError</a> <a id="2180" class="Symbol">(</a><a id="2181" href="Agda.Builtin.Reflection.html#6852" class="InductiveConstructor">strErr</a> <a id="2188" class="String">&quot;getUnOp&quot;</a> <a id="2198" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="2200" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="2202" class="Symbol">)</a>

        <a id="2213" href="Polynomial.Simple.Reflection.html#2213" class="Function">getExp</a> <a id="2220" class="Symbol">:</a> <a id="2222" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="2227" class="Symbol">(</a><a id="2228" href="Agda.Builtin.Reflection.html#3041" class="Datatype">Arg</a> <a id="2232" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a><a id="2236" class="Symbol">)</a> <a id="2238" class="Symbol">→</a> <a id="2240" href="Agda.Builtin.Reflection.html#7153" class="Postulate">TC</a> <a id="2243" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
        <a id="2256" href="Polynomial.Simple.Reflection.html#2213" class="Function">getExp</a> <a id="2263" class="Symbol">(</a><a id="2264" href="Polynomial.Simple.Reflection.html#2264" class="Bound">x</a> <a id="2266" href="Reflection.Helpers.html#1158" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="2270" href="Polynomial.Simple.Reflection.html#2270" class="Bound">y</a> <a id="2272" href="Reflection.Helpers.html#1158" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="2276" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="2278" class="Symbol">)</a> <a id="2280" class="Symbol">=</a> <a id="2282" class="Symbol">(λ</a> <a id="2285" href="Polynomial.Simple.Reflection.html#2285" class="Bound">x′</a> <a id="2288" class="Symbol">→</a> <a id="2290" class="Keyword">quote</a> <a id="2296" href="Polynomial.Expr.html#414" class="InductiveConstructor Operator">_⊛_</a> <a id="2300" href="Function.html#2548" class="Function Operator">⟨</a> <a id="2302" href="Agda.Builtin.Reflection.html#4648" class="InductiveConstructor">con</a> <a id="2306" href="Function.html#2548" class="Function Operator">⟩</a> <a id="2308" href="Polynomial.Simple.Reflection.html#1096" class="Function Operator">E⟅∷⟆</a> <a id="2313" href="Polynomial.Simple.Reflection.html#2285" class="Bound">x′</a> <a id="2316" href="Reflection.Helpers.html#1158" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="2320" href="Polynomial.Simple.Reflection.html#2270" class="Bound">y</a> <a id="2322" href="Reflection.Helpers.html#1158" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="2326" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="2328" class="Symbol">)</a> <a id="2330" href="Reflection.Helpers.html#989" class="Function Operator">&lt;$&gt;</a> <a id="2334" href="Polynomial.Simple.Reflection.html#3138" class="Function">toExpr</a> <a id="2341" href="Polynomial.Simple.Reflection.html#2264" class="Bound">x</a>
        <a id="2351" href="Polynomial.Simple.Reflection.html#2213" class="CatchallClause Function">getExp</a><a id="2357" class="CatchallClause"> </a><a id="2358" class="CatchallClause Symbol">(</a><a id="2359" href="Polynomial.Simple.Reflection.html#2359" class="CatchallClause Bound">x</a><a id="2360" class="CatchallClause"> </a><a id="2361" href="Agda.Builtin.List.html#132" class="CatchallClause InductiveConstructor Operator">∷</a><a id="2362" class="CatchallClause"> </a><a id="2363" href="Polynomial.Simple.Reflection.html#2363" class="CatchallClause Bound">xs</a><a id="2365" class="CatchallClause Symbol">)</a> <a id="2367" class="Symbol">=</a> <a id="2369" href="Polynomial.Simple.Reflection.html#2213" class="Function">getExp</a> <a id="2376" href="Polynomial.Simple.Reflection.html#2363" class="Bound">xs</a>
        <a id="2387" href="Polynomial.Simple.Reflection.html#2213" class="CatchallClause Function">getExp</a><a id="2393" class="CatchallClause"> </a><a id="2394" class="CatchallClause Symbol">_</a> <a id="2396" class="Symbol">=</a> <a id="2398" href="Agda.Builtin.Reflection.html#7354" class="Postulate">typeError</a> <a id="2408" class="Symbol">(</a><a id="2409" href="Agda.Builtin.Reflection.html#6852" class="InductiveConstructor">strErr</a> <a id="2416" class="String">&quot;getExp&quot;</a> <a id="2425" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="2427" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="2429" class="Symbol">)</a>

        <a id="2440" class="Comment">-- When trying to figure out the shape of an expression, one of</a>
        <a id="2512" class="Comment">-- the difficult tasks is recognizing where constants in the</a>
        <a id="2581" class="Comment">-- underlying ring are used. If we were only dealing with ℕ, we</a>
        <a id="2653" class="Comment">-- might look for its constructors: however, we want to deal with</a>
        <a id="2727" class="Comment">-- arbitrary types which implement AlmostCommutativeRing. If the</a>
        <a id="2800" class="Comment">-- Term type contained type information we might be able to</a>
        <a id="2868" class="Comment">-- recognize it there, but it doesn&#39;t.</a>
        <a id="2915" class="Comment">--</a>
        <a id="2926" class="Comment">-- We&#39;re in luck, though, because all other cases in the following</a>
        <a id="3001" class="Comment">-- function *are* recognizable. As a result, the &quot;catch-all&quot; case</a>
        <a id="3075" class="Comment">-- will just assume that it has a constant expression.</a>
        <a id="3138" href="Polynomial.Simple.Reflection.html#3138" class="Function">toExpr</a> <a id="3145" class="Symbol">:</a> <a id="3147" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="3152" class="Symbol">→</a> <a id="3154" href="Agda.Builtin.Reflection.html#7153" class="Postulate">TC</a> <a id="3157" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
        <a id="3170" href="Polynomial.Simple.Reflection.html#3138" class="Function">toExpr</a> <a id="3177" class="Symbol">(</a><a id="3178" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="3182" class="Symbol">(</a><a id="3183" class="Keyword">quote</a> <a id="3189" href="Polynomial.Simple.AlmostCommutativeRing.html#1159" class="Field Operator">_+_</a><a id="3192" class="Symbol">)</a> <a id="3194" href="Polynomial.Simple.Reflection.html#3194" class="Bound">xs</a><a id="3196" class="Symbol">)</a> <a id="3198" class="Symbol">=</a> <a id="3200" href="Polynomial.Simple.Reflection.html#1723" class="Function">getBinOp</a> <a id="3209" class="Symbol">(</a><a id="3210" class="Keyword">quote</a> <a id="3216" href="Polynomial.Expr.html#336" class="InductiveConstructor Operator">_⊕_</a><a id="3219" class="Symbol">)</a> <a id="3221" href="Polynomial.Simple.Reflection.html#3194" class="Bound">xs</a>
        <a id="3232" href="Polynomial.Simple.Reflection.html#3138" class="Function">toExpr</a> <a id="3239" class="Symbol">(</a><a id="3240" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="3244" class="Symbol">(</a><a id="3245" class="Keyword">quote</a> <a id="3251" href="Polynomial.Simple.AlmostCommutativeRing.html#1201" class="Field Operator">_*_</a><a id="3254" class="Symbol">)</a> <a id="3256" href="Polynomial.Simple.Reflection.html#3256" class="Bound">xs</a><a id="3258" class="Symbol">)</a> <a id="3260" class="Symbol">=</a> <a id="3262" href="Polynomial.Simple.Reflection.html#1723" class="Function">getBinOp</a> <a id="3271" class="Symbol">(</a><a id="3272" class="Keyword">quote</a> <a id="3278" href="Polynomial.Expr.html#375" class="InductiveConstructor Operator">_⊗_</a><a id="3281" class="Symbol">)</a> <a id="3283" href="Polynomial.Simple.Reflection.html#3256" class="Bound">xs</a>
        <a id="3294" href="Polynomial.Simple.Reflection.html#3138" class="Function">toExpr</a> <a id="3301" class="Symbol">(</a><a id="3302" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="3306" class="Symbol">(</a><a id="3307" class="Keyword">quote</a> <a id="3313" href="Polynomial.Simple.AlmostCommutativeRing.html#2094" class="Function Operator">_^_</a><a id="3316" class="Symbol">)</a> <a id="3318" href="Polynomial.Simple.Reflection.html#3318" class="Bound">xs</a><a id="3320" class="Symbol">)</a> <a id="3322" class="Symbol">=</a> <a id="3324" href="Polynomial.Simple.Reflection.html#2213" class="Function">getExp</a> <a id="3331" href="Polynomial.Simple.Reflection.html#3318" class="Bound">xs</a>
        <a id="3342" href="Polynomial.Simple.Reflection.html#3138" class="Function">toExpr</a> <a id="3349" class="Symbol">(</a><a id="3350" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="3354" class="Symbol">(</a><a id="3355" class="Keyword">quote</a> <a id="3361" href="Polynomial.Simple.AlmostCommutativeRing.html#1243" class="Field Operator">-_</a><a id="3363" class="Symbol">)</a> <a id="3365" href="Polynomial.Simple.Reflection.html#3365" class="Bound">xs</a><a id="3367" class="Symbol">)</a> <a id="3369" class="Symbol">=</a> <a id="3371" href="Polynomial.Simple.Reflection.html#1981" class="Function">getUnOp</a> <a id="3379" class="Symbol">(</a><a id="3380" class="Keyword">quote</a> <a id="3386" href="Polynomial.Expr.html#446" class="InductiveConstructor Operator">⊝_</a><a id="3388" class="Symbol">)</a> <a id="3390" href="Polynomial.Simple.Reflection.html#3365" class="Bound">xs</a>
        <a id="3401" href="Polynomial.Simple.Reflection.html#3138" class="Function">toExpr</a> <a id="3408" href="Polynomial.Simple.Reflection.html#3408" class="Bound">v</a><a id="3409" class="Symbol">@(</a><a id="3411" href="Agda.Builtin.Reflection.html#4592" class="InductiveConstructor">var</a> <a id="3415" href="Polynomial.Simple.Reflection.html#3415" class="Bound">x</a> <a id="3417" class="Symbol">_)</a> <a id="3420" class="Symbol">=</a> <a id="3422" href="Reflection.Helpers.html#569" class="Function">pure</a> <a id="3427" href="Function.html#1927" class="Function Operator">$</a> <a id="3429" href="Data.Maybe.Base.html#1730" class="Function">Maybe.fromMaybe</a> <a id="3445" class="Symbol">(</a><a id="3446" href="Polynomial.Simple.Reflection.html#1305" class="Function">constExpr</a> <a id="3456" href="Polynomial.Simple.Reflection.html#3408" class="Bound">v</a><a id="3457" class="Symbol">)</a> <a id="3459" class="Symbol">(</a><a id="3460" href="Polynomial.Simple.Reflection.html#1397" class="Bound">varExpr</a> <a id="3468" href="Polynomial.Simple.Reflection.html#3415" class="Bound">x</a><a id="3469" class="Symbol">)</a>
        <a id="3479" href="Polynomial.Simple.Reflection.html#3138" class="CatchallClause Function">toExpr</a><a id="3485" class="CatchallClause"> </a><a id="3486" href="Polynomial.Simple.Reflection.html#3486" class="CatchallClause Bound">t</a> <a id="3488" class="Symbol">=</a> <a id="3490" href="Reflection.Helpers.html#569" class="Function">pure</a> <a id="3495" href="Function.html#1927" class="Function Operator">$</a> <a id="3497" href="Polynomial.Simple.Reflection.html#1305" class="Function">constExpr</a> <a id="3507" href="Polynomial.Simple.Reflection.html#3486" class="Bound">t</a>

    <a id="3514" href="Polynomial.Simple.Reflection.html#3514" class="Function">callSolver</a> <a id="3525" class="Symbol">:</a> <a id="3527" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="3532" href="Agda.Builtin.String.html#165" class="Postulate">String</a> <a id="3539" class="Symbol">→</a> <a id="3541" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="3546" class="Symbol">→</a> <a id="3548" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="3553" class="Symbol">→</a> <a id="3555" href="Agda.Builtin.Reflection.html#7153" class="Postulate">TC</a> <a id="3558" class="Symbol">(</a><a id="3559" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="3564" class="Symbol">(</a><a id="3565" href="Agda.Builtin.Reflection.html#3041" class="Datatype">Arg</a> <a id="3569" href="Agda.Builtin.Reflection.html#4561" class="Function">Type</a><a id="3573" class="Symbol">))</a>
    <a id="3580" href="Polynomial.Simple.Reflection.html#3514" class="Function">callSolver</a> <a id="3591" href="Polynomial.Simple.Reflection.html#3591" class="Bound">nms</a> <a id="3595" href="Polynomial.Simple.Reflection.html#3595" class="Bound">lhs</a> <a id="3599" href="Polynomial.Simple.Reflection.html#3599" class="Bound">rhs</a> <a id="3603" class="Symbol">=</a> <a id="3605" class="Keyword">do</a>
      <a id="3614" href="Polynomial.Simple.Reflection.html#3614" class="Bound">lhs′</a> <a id="3619" href="Reflection.Helpers.html#738" class="Function Operator">←</a> <a id="3621" href="Polynomial.Simple.Reflection.html#3138" class="Function">toExpr</a> <a id="3628" href="Polynomial.Simple.Reflection.html#3595" class="Bound">lhs</a>
      <a id="3638" href="Polynomial.Simple.Reflection.html#3638" class="Bound">rhs′</a> <a id="3643" href="Reflection.Helpers.html#738" class="Function Operator">←</a> <a id="3645" href="Polynomial.Simple.Reflection.html#3138" class="Function">toExpr</a> <a id="3652" href="Polynomial.Simple.Reflection.html#3599" class="Bound">rhs</a>
      <a id="3662" href="Reflection.Helpers.html#569" class="Function">pure</a> <a id="3667" href="Function.html#1927" class="Function Operator">$</a>
        <a id="3677" class="Number">2</a> <a id="3679" href="Reflection.Helpers.html#1287" class="Function Operator">⋯⟅∷⟆</a>
        <a id="3692" href="Polynomial.Simple.Reflection.html#351" class="Bound">rng</a> <a id="3696" href="Reflection.Helpers.html#1158" class="InductiveConstructor Operator">⟨∷⟩</a>
        <a id="3708" href="Reflection.Helpers.html#1392" class="Function">natTerm</a> <a id="3716" href="Polynomial.Simple.Reflection.html#698" class="Bound">numVars</a> <a id="3724" href="Reflection.Helpers.html#1158" class="InductiveConstructor Operator">⟨∷⟩</a>
        <a id="3736" href="Reflection.Helpers.html#1932" class="Function">vlams</a> <a id="3742" href="Polynomial.Simple.Reflection.html#3591" class="Bound">nms</a> <a id="3746" class="Symbol">(</a><a id="3747" class="Keyword">quote</a> <a id="3753" href="Polynomial.Simple.Solver.html#3377" class="Function Operator">_⊜_</a> <a id="3757" href="Function.html#2548" class="Function Operator">⟨</a> <a id="3759" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="3763" href="Function.html#2548" class="Function Operator">⟩</a> <a id="3765" class="Number">2</a> <a id="3767" href="Reflection.Helpers.html#1287" class="Function Operator">⋯⟅∷⟆</a> <a id="3772" href="Polynomial.Simple.Reflection.html#351" class="Bound">rng</a> <a id="3776" href="Reflection.Helpers.html#1158" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="3780" href="Reflection.Helpers.html#1392" class="Function">natTerm</a> <a id="3788" href="Polynomial.Simple.Reflection.html#698" class="Bound">numVars</a> <a id="3796" href="Reflection.Helpers.html#1158" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="3800" href="Polynomial.Simple.Reflection.html#3614" class="Bound">lhs′</a> <a id="3805" href="Reflection.Helpers.html#1158" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="3809" href="Polynomial.Simple.Reflection.html#3638" class="Bound">rhs′</a> <a id="3814" href="Reflection.Helpers.html#1158" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="3818" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="3820" class="Symbol">)</a> <a id="3822" href="Reflection.Helpers.html#1158" class="InductiveConstructor Operator">⟨∷⟩</a>
        <a id="3834" href="Reflection.Helpers.html#1833" class="Function">hlams</a> <a id="3840" href="Polynomial.Simple.Reflection.html#3591" class="Bound">nms</a> <a id="3844" class="Symbol">(</a><a id="3845" class="Keyword">quote</a> <a id="3851" href="Polynomial.Simple.AlmostCommutativeRing.html#2172" class="Function">refl</a> <a id="3856" href="Function.html#2548" class="Function Operator">⟨</a> <a id="3858" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="3862" href="Function.html#2548" class="Function Operator">⟩</a> <a id="3864" class="Number">2</a> <a id="3866" href="Reflection.Helpers.html#1287" class="Function Operator">⋯⟅∷⟆</a> <a id="3871" href="Polynomial.Simple.Reflection.html#351" class="Bound">rng</a> <a id="3875" href="Reflection.Helpers.html#1158" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="3879" class="Number">1</a> <a id="3881" href="Reflection.Helpers.html#1287" class="Function Operator">⋯⟅∷⟆</a> <a id="3886" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="3888" class="Symbol">)</a> <a id="3890" href="Reflection.Helpers.html#1158" class="InductiveConstructor Operator">⟨∷⟩</a>
        <a id="3902" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>
      <a id="3911" class="Keyword">where</a>
      <a id="3923" href="Polynomial.Simple.Reflection.html#3923" class="Function">varExpr</a> <a id="3931" class="Symbol">:</a> <a id="3933" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="3935" class="Symbol">→</a> <a id="3937" href="Data.Maybe.Base.html#710" class="Datatype">Maybe</a> <a id="3943" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
      <a id="3954" href="Polynomial.Simple.Reflection.html#3923" class="Function">varExpr</a> <a id="3962" href="Polynomial.Simple.Reflection.html#3962" class="Bound">i</a> <a id="3964" class="Keyword">with</a> <a id="3969" href="Polynomial.Simple.Reflection.html#3962" class="Bound">i</a> <a id="3971" href="Data.Nat.Properties.html#5343" class="Function Operator">ℕ.&lt;?</a> <a id="3976" href="Polynomial.Simple.Reflection.html#698" class="Bound">numVars</a>
      <a id="3990" class="Symbol">...</a> <a id="3994" class="Symbol">|</a> <a id="3996" href="Relation.Nullary.html#606" class="InductiveConstructor">yes</a> <a id="4000" class="Symbol">_</a> <a id="4002" class="Symbol">=</a> <a id="4004" href="Data.Maybe.Base.html#748" class="InductiveConstructor">just</a> <a id="4009" class="Symbol">(</a><a id="4010" href="Agda.Builtin.Reflection.html#4592" class="InductiveConstructor">var</a> <a id="4014" class="Bound">i</a> <a id="4016" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="4018" class="Symbol">)</a>
      <a id="4026" class="Symbol">...</a> <a id="4030" class="Symbol">|</a> <a id="4032" href="Relation.Nullary.html#633" class="InductiveConstructor">no</a> <a id="4035" class="Symbol">_</a> <a id="4037" class="Symbol">=</a> <a id="4039" href="Data.Maybe.Base.html#778" class="InductiveConstructor">nothing</a>
      <a id="4053" class="Keyword">open</a> <a id="4058" href="Polynomial.Simple.Reflection.html#1389" class="Module">ToExpr</a> <a id="4065" href="Polynomial.Simple.Reflection.html#3923" class="Function">varExpr</a>

    <a id="4078" href="Polynomial.Simple.Reflection.html#4078" class="Function">constructSoln</a> <a id="4092" class="Symbol">:</a> <a id="4094" href="Data.Nat.Table.html#425" class="Function">Table</a> <a id="4100" class="Symbol">→</a> <a id="4102" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="4107" class="Symbol">→</a> <a id="4109" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="4114" class="Symbol">→</a> <a id="4116" href="Agda.Builtin.Reflection.html#7153" class="Postulate">TC</a> <a id="4119" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
    <a id="4128" href="Polynomial.Simple.Reflection.html#4078" class="Function">constructSoln</a> <a id="4142" href="Polynomial.Simple.Reflection.html#4142" class="Bound">t</a> <a id="4144" href="Polynomial.Simple.Reflection.html#4144" class="Bound">lhs</a> <a id="4148" href="Polynomial.Simple.Reflection.html#4148" class="Bound">rhs</a> <a id="4152" class="Symbol">=</a> <a id="4154" class="Keyword">do</a>
      <a id="4163" href="Polynomial.Simple.Reflection.html#4163" class="Bound">lhs′</a> <a id="4168" href="Reflection.Helpers.html#738" class="Function Operator">←</a> <a id="4170" href="Polynomial.Simple.Reflection.html#3138" class="Function">toExpr</a> <a id="4177" href="Polynomial.Simple.Reflection.html#4144" class="Bound">lhs</a>
      <a id="4187" href="Polynomial.Simple.Reflection.html#4187" class="Bound">rhs′</a> <a id="4192" href="Reflection.Helpers.html#738" class="Function Operator">←</a> <a id="4194" href="Polynomial.Simple.Reflection.html#3138" class="Function">toExpr</a> <a id="4201" href="Polynomial.Simple.Reflection.html#4148" class="Bound">rhs</a>
      <a id="4211" href="Reflection.Helpers.html#569" class="Function">pure</a> <a id="4216" href="Function.html#1927" class="Function Operator">$</a>
        <a id="4226" class="Keyword">quote</a> <a id="4232" href="Relation.Binary.Core.html#5860" class="Function">trans</a> <a id="4238" href="Function.html#2548" class="Function Operator">⟨</a> <a id="4240" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="4244" href="Function.html#2548" class="Function Operator">⟩</a>
          <a id="4256" class="Number">2</a> <a id="4258" href="Reflection.Helpers.html#1287" class="Function Operator">⋯⟅∷⟆</a>
          <a id="4273" href="Polynomial.Simple.Reflection.html#351" class="Bound">rng</a> <a id="4277" href="Reflection.Helpers.html#1158" class="InductiveConstructor Operator">⟨∷⟩</a>
          <a id="4291" class="Number">3</a> <a id="4293" href="Reflection.Helpers.html#1287" class="Function Operator">⋯⟅∷⟆</a>
          <a id="4308" class="Symbol">(</a><a id="4309" class="Keyword">quote</a> <a id="4315" href="Relation.Binary.Core.html#5834" class="Function">sym</a> <a id="4319" href="Function.html#2548" class="Function Operator">⟨</a> <a id="4321" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="4325" href="Function.html#2548" class="Function Operator">⟩</a>
              <a id="4341" class="Symbol">(</a><a id="4342" class="Number">2</a> <a id="4344" href="Reflection.Helpers.html#1287" class="Function Operator">⋯⟅∷⟆</a>
              <a id="4363" href="Polynomial.Simple.Reflection.html#351" class="Bound">rng</a> <a id="4367" href="Reflection.Helpers.html#1158" class="InductiveConstructor Operator">⟨∷⟩</a>
              <a id="4385" class="Number">2</a> <a id="4387" href="Reflection.Helpers.html#1287" class="Function Operator">⋯⟅∷⟆</a>
              <a id="4406" class="Symbol">(</a><a id="4407" class="Keyword">quote</a> <a id="4413" href="Polynomial.Simple.Solver.html#2045" class="Function">Ops.correct</a> <a id="4425" href="Function.html#2548" class="Function Operator">⟨</a> <a id="4427" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="4431" href="Function.html#2548" class="Function Operator">⟩</a> <a id="4433" class="Number">2</a> <a id="4435" href="Reflection.Helpers.html#1287" class="Function Operator">⋯⟅∷⟆</a> <a id="4440" href="Polynomial.Simple.Reflection.html#351" class="Bound">rng</a> <a id="4444" href="Reflection.Helpers.html#1158" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="4448" class="Number">1</a> <a id="4450" href="Reflection.Helpers.html#1287" class="Function Operator">⋯⟅∷⟆</a> <a id="4455" href="Polynomial.Simple.Reflection.html#4163" class="Bound">lhs′</a> <a id="4460" href="Reflection.Helpers.html#1158" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="4464" href="Polynomial.Simple.Reflection.html#4769" class="Function">ρ</a> <a id="4466" href="Reflection.Helpers.html#1158" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="4470" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="4472" class="Symbol">)</a> <a id="4474" href="Reflection.Helpers.html#1158" class="InductiveConstructor Operator">⟨∷⟩</a>
              <a id="4492" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="4494" class="Symbol">))</a>
          <a id="4507" href="Reflection.Helpers.html#1158" class="InductiveConstructor Operator">⟨∷⟩</a>
          <a id="4521" class="Symbol">(</a><a id="4522" class="Keyword">quote</a> <a id="4528" href="Polynomial.Simple.Solver.html#2045" class="Function">Ops.correct</a> <a id="4540" href="Function.html#2548" class="Function Operator">⟨</a> <a id="4542" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="4546" href="Function.html#2548" class="Function Operator">⟩</a> <a id="4548" class="Number">2</a> <a id="4550" href="Reflection.Helpers.html#1287" class="Function Operator">⋯⟅∷⟆</a> <a id="4555" href="Polynomial.Simple.Reflection.html#351" class="Bound">rng</a> <a id="4559" href="Reflection.Helpers.html#1158" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="4563" class="Number">1</a> <a id="4565" href="Reflection.Helpers.html#1287" class="Function Operator">⋯⟅∷⟆</a> <a id="4570" href="Polynomial.Simple.Reflection.html#4187" class="Bound">rhs′</a> <a id="4575" href="Reflection.Helpers.html#1158" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="4579" href="Polynomial.Simple.Reflection.html#4769" class="Function">ρ</a> <a id="4581" href="Reflection.Helpers.html#1158" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="4585" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="4587" class="Symbol">)</a> <a id="4589" href="Reflection.Helpers.html#1158" class="InductiveConstructor Operator">⟨∷⟩</a>
          <a id="4603" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>
      <a id="4612" class="Keyword">where</a>
      <a id="4624" href="Polynomial.Simple.Reflection.html#4624" class="Function">varExpr</a> <a id="4632" class="Symbol">:</a> <a id="4634" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="4636" class="Symbol">→</a> <a id="4638" href="Data.Maybe.Base.html#710" class="Datatype">Maybe</a> <a id="4644" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
      <a id="4655" href="Polynomial.Simple.Reflection.html#4624" class="Function">varExpr</a> <a id="4663" href="Polynomial.Simple.Reflection.html#4663" class="Bound">i</a> <a id="4665" class="Symbol">=</a> <a id="4667" href="Data.Maybe.Base.html#2139" class="Function">Maybe.map</a> <a id="4677" class="Symbol">(λ</a> <a id="4680" href="Polynomial.Simple.Reflection.html#4680" class="Bound">x</a> <a id="4682" class="Symbol">→</a> <a id="4684" class="Keyword">quote</a> <a id="4690" href="Polynomial.Expr.html#311" class="InductiveConstructor">Ι</a> <a id="4692" href="Function.html#2548" class="Function Operator">⟨</a> <a id="4694" href="Agda.Builtin.Reflection.html#4648" class="InductiveConstructor">con</a> <a id="4698" href="Function.html#2548" class="Function Operator">⟩</a> <a id="4700" href="Polynomial.Simple.Reflection.html#1096" class="Function Operator">E⟅∷⟆</a> <a id="4705" href="Reflection.Helpers.html#1502" class="Function">finTerm</a> <a id="4713" href="Polynomial.Simple.Reflection.html#4680" class="Bound">x</a> <a id="4715" href="Reflection.Helpers.html#1158" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="4719" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="4721" class="Symbol">)</a> <a id="4723" class="Symbol">(</a><a id="4724" href="Data.Nat.Table.html#943" class="Function">member</a> <a id="4731" href="Polynomial.Simple.Reflection.html#4663" class="Bound">i</a> <a id="4733" href="Polynomial.Simple.Reflection.html#4142" class="Bound">t</a><a id="4734" class="Symbol">)</a>

      <a id="4743" class="Keyword">open</a> <a id="4748" href="Polynomial.Simple.Reflection.html#1389" class="Module">ToExpr</a> <a id="4755" href="Polynomial.Simple.Reflection.html#4624" class="Function">varExpr</a>
      <a id="4769" href="Polynomial.Simple.Reflection.html#4769" class="Function">ρ</a> <a id="4771" class="Symbol">:</a> <a id="4773" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
      <a id="4784" href="Polynomial.Simple.Reflection.html#4769" class="Function">ρ</a> <a id="4786" class="Symbol">=</a> <a id="4788" href="Reflection.Helpers.html#1634" class="Function">curriedTerm</a> <a id="4800" href="Polynomial.Simple.Reflection.html#4142" class="Bound">t</a>

  <a id="Internal.toSoln"></a><a id="4805" href="Polynomial.Simple.Reflection.html#4805" class="Function">toSoln</a> <a id="4812" class="Symbol">:</a> <a id="4814" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="4819" class="Symbol">→</a> <a id="4821" href="Agda.Builtin.Reflection.html#7153" class="Postulate">TC</a> <a id="4824" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
  <a id="4831" href="Polynomial.Simple.Reflection.html#4805" class="Function">toSoln</a> <a id="4838" href="Polynomial.Simple.Reflection.html#4838" class="Bound">t′</a> <a id="4841" class="Symbol">=</a> <a id="4843" href="Polynomial.Simple.Reflection.html#4868" class="Function">go</a> <a id="4846" class="Number">0</a> <a id="4848" href="Function.html#1104" class="Function">id</a> <a id="4851" href="Polynomial.Simple.Reflection.html#4838" class="Bound">t′</a>
    <a id="4858" class="Keyword">where</a>
    <a id="4868" href="Polynomial.Simple.Reflection.html#4868" class="Function">go</a> <a id="4871" class="Symbol">:</a> <a id="4873" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="4875" class="Symbol">→</a> <a id="4877" class="Symbol">(</a><a id="4878" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="4883" href="Agda.Builtin.String.html#165" class="Postulate">String</a> <a id="4890" class="Symbol">→</a> <a id="4892" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="4897" href="Agda.Builtin.String.html#165" class="Postulate">String</a><a id="4903" class="Symbol">)</a> <a id="4905" class="Symbol">→</a> <a id="4907" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="4912" class="Symbol">→</a> <a id="4914" href="Agda.Builtin.Reflection.html#7153" class="Postulate">TC</a> <a id="4917" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
    <a id="4926" href="Polynomial.Simple.Reflection.html#4868" class="Function">go</a> <a id="4929" href="Polynomial.Simple.Reflection.html#4929" class="Bound">i</a> <a id="4931" href="Polynomial.Simple.Reflection.html#4931" class="Bound">k</a> <a id="4933" class="Symbol">(</a><a id="4934" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="4938" href="Polynomial.Simple.Reflection.html#4938" class="Bound">f</a> <a id="4940" class="Symbol">(</a>            <a id="4953" href="Polynomial.Simple.Reflection.html#4953" class="Bound">lhs</a> <a id="4957" href="Reflection.Helpers.html#1158" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="4961" href="Polynomial.Simple.Reflection.html#4961" class="Bound">rhs</a> <a id="4965" href="Reflection.Helpers.html#1158" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="4969" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="4971" class="Symbol">))</a> <a id="4974" class="Symbol">=</a> <a id="4976" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="4980" class="Symbol">(</a><a id="4981" class="Keyword">quote</a> <a id="4987" href="Polynomial.Simple.Solver.html#2736" class="Function">solve′</a><a id="4993" class="Symbol">)</a> <a id="4995" href="Reflection.Helpers.html#989" class="Function Operator">&lt;$&gt;</a> <a id="4999" href="Polynomial.Simple.Reflection.html#3514" class="Function">callSolver</a> <a id="5010" href="Polynomial.Simple.Reflection.html#4929" class="Bound">i</a> <a id="5012" class="Symbol">(</a><a id="5013" href="Polynomial.Simple.Reflection.html#4931" class="Bound">k</a> <a id="5015" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="5017" class="Symbol">)</a> <a id="5019" href="Polynomial.Simple.Reflection.html#4953" class="Bound">lhs</a> <a id="5023" href="Polynomial.Simple.Reflection.html#4961" class="Bound">rhs</a>
    <a id="5031" href="Polynomial.Simple.Reflection.html#4868" class="CatchallClause Function">go</a><a id="5033" class="CatchallClause"> </a><a id="5034" href="Polynomial.Simple.Reflection.html#5034" class="CatchallClause Bound">i</a><a id="5035" class="CatchallClause"> </a><a id="5036" href="Polynomial.Simple.Reflection.html#5036" class="CatchallClause Bound">k</a><a id="5037" class="CatchallClause"> </a><a id="5038" class="CatchallClause Symbol">(</a><a id="5039" href="Agda.Builtin.Reflection.html#4705" class="CatchallClause InductiveConstructor">def</a><a id="5042" class="CatchallClause"> </a><a id="5043" href="Polynomial.Simple.Reflection.html#5043" class="CatchallClause Bound">f</a><a id="5044" class="CatchallClause"> </a><a id="5045" class="CatchallClause Symbol">(</a><a id="5046" class="CatchallClause">    </a><a id="5050" class="CatchallClause Symbol">_</a><a id="5051" class="CatchallClause"> </a><a id="5052" href="Agda.Builtin.List.html#132" class="CatchallClause InductiveConstructor Operator">∷</a><a id="5053" class="CatchallClause"> </a><a id="5054" class="CatchallClause Symbol">_</a><a id="5055" class="CatchallClause"> </a><a id="5056" href="Agda.Builtin.List.html#132" class="CatchallClause InductiveConstructor Operator">∷</a><a id="5057" class="CatchallClause"> </a><a id="5058" href="Polynomial.Simple.Reflection.html#5058" class="CatchallClause Bound">lhs</a><a id="5061" class="CatchallClause"> </a><a id="5062" href="Reflection.Helpers.html#1158" class="CatchallClause InductiveConstructor Operator">⟨∷⟩</a><a id="5065" class="CatchallClause"> </a><a id="5066" href="Polynomial.Simple.Reflection.html#5066" class="CatchallClause Bound">rhs</a><a id="5069" class="CatchallClause"> </a><a id="5070" href="Reflection.Helpers.html#1158" class="CatchallClause InductiveConstructor Operator">⟨∷⟩</a><a id="5073" class="CatchallClause"> </a><a id="5074" href="Agda.Builtin.List.html#117" class="CatchallClause InductiveConstructor">[]</a><a id="5076" class="CatchallClause Symbol">))</a> <a id="5079" class="Symbol">=</a> <a id="5081" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="5085" class="Symbol">(</a><a id="5086" class="Keyword">quote</a> <a id="5092" href="Polynomial.Simple.Solver.html#2736" class="Function">solve′</a><a id="5098" class="Symbol">)</a> <a id="5100" href="Reflection.Helpers.html#989" class="Function Operator">&lt;$&gt;</a> <a id="5104" href="Polynomial.Simple.Reflection.html#3514" class="Function">callSolver</a> <a id="5115" href="Polynomial.Simple.Reflection.html#5034" class="Bound">i</a> <a id="5117" class="Symbol">(</a><a id="5118" href="Polynomial.Simple.Reflection.html#5036" class="Bound">k</a> <a id="5120" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="5122" class="Symbol">)</a> <a id="5124" href="Polynomial.Simple.Reflection.html#5058" class="Bound">lhs</a> <a id="5128" href="Polynomial.Simple.Reflection.html#5066" class="Bound">rhs</a>
    <a id="5136" href="Polynomial.Simple.Reflection.html#4868" class="CatchallClause Function">go</a><a id="5138" class="CatchallClause"> </a><a id="5139" href="Polynomial.Simple.Reflection.html#5139" class="CatchallClause Bound">i</a><a id="5140" class="CatchallClause"> </a><a id="5141" href="Polynomial.Simple.Reflection.html#5141" class="CatchallClause Bound">k</a><a id="5142" class="CatchallClause"> </a><a id="5143" class="CatchallClause Symbol">(</a><a id="5144" href="Agda.Builtin.Reflection.html#4705" class="CatchallClause InductiveConstructor">def</a><a id="5147" class="CatchallClause"> </a><a id="5148" href="Polynomial.Simple.Reflection.html#5148" class="CatchallClause Bound">f</a><a id="5149" class="CatchallClause"> </a><a id="5150" class="CatchallClause Symbol">(_</a><a id="5152" class="CatchallClause"> </a><a id="5153" href="Agda.Builtin.List.html#132" class="CatchallClause InductiveConstructor Operator">∷</a><a id="5154" class="CatchallClause"> </a><a id="5155" class="CatchallClause Symbol">_</a><a id="5156" class="CatchallClause"> </a><a id="5157" href="Agda.Builtin.List.html#132" class="CatchallClause InductiveConstructor Operator">∷</a><a id="5158" class="CatchallClause"> </a><a id="5159" class="CatchallClause Symbol">_</a><a id="5160" class="CatchallClause"> </a><a id="5161" href="Agda.Builtin.List.html#132" class="CatchallClause InductiveConstructor Operator">∷</a><a id="5162" class="CatchallClause"> </a><a id="5163" href="Polynomial.Simple.Reflection.html#5163" class="CatchallClause Bound">lhs</a><a id="5166" class="CatchallClause"> </a><a id="5167" href="Reflection.Helpers.html#1158" class="CatchallClause InductiveConstructor Operator">⟨∷⟩</a><a id="5170" class="CatchallClause"> </a><a id="5171" href="Polynomial.Simple.Reflection.html#5171" class="CatchallClause Bound">rhs</a><a id="5174" class="CatchallClause"> </a><a id="5175" href="Reflection.Helpers.html#1158" class="CatchallClause InductiveConstructor Operator">⟨∷⟩</a><a id="5178" class="CatchallClause"> </a><a id="5179" href="Agda.Builtin.List.html#117" class="CatchallClause InductiveConstructor">[]</a><a id="5181" class="CatchallClause Symbol">))</a> <a id="5184" class="Symbol">=</a> <a id="5186" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="5190" class="Symbol">(</a><a id="5191" class="Keyword">quote</a> <a id="5197" href="Polynomial.Simple.Solver.html#2736" class="Function">solve′</a><a id="5203" class="Symbol">)</a> <a id="5205" href="Reflection.Helpers.html#989" class="Function Operator">&lt;$&gt;</a> <a id="5209" href="Polynomial.Simple.Reflection.html#3514" class="Function">callSolver</a> <a id="5220" href="Polynomial.Simple.Reflection.html#5139" class="Bound">i</a> <a id="5222" class="Symbol">(</a><a id="5223" href="Polynomial.Simple.Reflection.html#5141" class="Bound">k</a> <a id="5225" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="5227" class="Symbol">)</a> <a id="5229" href="Polynomial.Simple.Reflection.html#5163" class="Bound">lhs</a> <a id="5233" href="Polynomial.Simple.Reflection.html#5171" class="Bound">rhs</a>
    <a id="5241" href="Polynomial.Simple.Reflection.html#4868" class="Function">go</a> <a id="5244" href="Polynomial.Simple.Reflection.html#5244" class="Bound">i</a> <a id="5246" href="Polynomial.Simple.Reflection.html#5246" class="Bound">k</a> <a id="5248" class="Symbol">(</a><a id="5249" href="Agda.Builtin.Reflection.html#4880" class="InductiveConstructor">pi</a> <a id="5252" href="Polynomial.Simple.Reflection.html#5252" class="Bound">a</a> <a id="5254" class="Symbol">(</a><a id="5255" href="Agda.Builtin.Reflection.html#3308" class="InductiveConstructor">abs</a> <a id="5259" href="Polynomial.Simple.Reflection.html#5259" class="Bound">s</a> <a id="5261" href="Polynomial.Simple.Reflection.html#5261" class="Bound">x</a><a id="5262" class="Symbol">))</a> <a id="5265" class="Symbol">=</a> <a id="5267" href="Polynomial.Simple.Reflection.html#4868" class="Function">go</a> <a id="5270" class="Symbol">(</a><a id="5271" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="5275" href="Polynomial.Simple.Reflection.html#5244" class="Bound">i</a><a id="5276" class="Symbol">)</a> <a id="5278" class="Symbol">(</a><a id="5279" href="Polynomial.Simple.Reflection.html#5246" class="Bound">k</a> <a id="5281" href="Function.html#805" class="Function Operator">∘</a> <a id="5283" class="Symbol">(</a><a id="5284" href="Polynomial.Simple.Reflection.html#5259" class="Bound">s</a> <a id="5286" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷_</a><a id="5288" class="Symbol">))</a> <a id="5291" href="Polynomial.Simple.Reflection.html#5261" class="Bound">x</a>
    <a id="5297" href="Polynomial.Simple.Reflection.html#4868" class="CatchallClause Function">go</a><a id="5299" class="CatchallClause"> </a><a id="5300" href="Polynomial.Simple.Reflection.html#5300" class="CatchallClause Bound">i</a><a id="5301" class="CatchallClause"> </a><a id="5302" href="Polynomial.Simple.Reflection.html#5302" class="CatchallClause Bound">k</a><a id="5303" class="CatchallClause"> </a><a id="5304" href="Polynomial.Simple.Reflection.html#5304" class="CatchallClause Bound">t</a> <a id="5306" class="Symbol">=</a> <a id="5308" href="Agda.Builtin.Reflection.html#7354" class="Postulate">typeError</a> <a id="5318" class="Symbol">(</a><a id="5319" href="Agda.Builtin.Reflection.html#6852" class="InductiveConstructor">strErr</a> <a id="5326" class="String">&quot;Malformed call to solve.&quot;</a> <a id="5353" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a>
                          <a id="5381" href="Agda.Builtin.Reflection.html#6852" class="InductiveConstructor">strErr</a> <a id="5388" class="String">&quot;Expected target type to be like: ∀ x y → x + y ≈ y + x.&quot;</a> <a id="5446" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a>
                          <a id="5474" href="Agda.Builtin.Reflection.html#6852" class="InductiveConstructor">strErr</a> <a id="5481" class="String">&quot;Instead: &quot;</a> <a id="5493" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a>
                          <a id="5521" href="Agda.Builtin.Reflection.html#6883" class="InductiveConstructor">termErr</a> <a id="5529" href="Polynomial.Simple.Reflection.html#4838" class="Bound">t′</a> <a id="5532" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a>
                          <a id="5560" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="5562" class="Symbol">)</a>

  <a id="Internal.listType"></a><a id="5567" href="Polynomial.Simple.Reflection.html#5567" class="Function">listType</a> <a id="5576" class="Symbol">:</a> <a id="5578" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="5583" class="Symbol">→</a> <a id="5585" href="Agda.Builtin.Reflection.html#7153" class="Postulate">TC</a> <a id="5588" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
  <a id="5595" href="Polynomial.Simple.Reflection.html#5567" class="Function">listType</a> <a id="5604" href="Polynomial.Simple.Reflection.html#5604" class="Bound">t</a> <a id="5606" class="Symbol">=</a>
    <a id="5612" href="Agda.Builtin.Reflection.html#7447" class="Postulate">checkType</a> <a id="5622" href="Polynomial.Simple.Reflection.html#5604" class="Bound">t</a> <a id="5624" class="Symbol">(</a><a id="5625" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="5629" class="Symbol">(</a><a id="5630" class="Keyword">quote</a> <a id="5636" href="Agda.Builtin.List.html#80" class="Datatype">List</a><a id="5640" class="Symbol">)</a> <a id="5642" class="Symbol">(</a><a id="5643" class="Number">1</a> <a id="5645" href="Reflection.Helpers.html#1287" class="Function Operator">⋯⟅∷⟆</a> <a id="5650" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="5654" class="Symbol">(</a><a id="5655" class="Keyword">quote</a> <a id="5661" href="Polynomial.Simple.AlmostCommutativeRing.html#1079" class="Field">Carrier</a><a id="5668" class="Symbol">)</a> <a id="5670" class="Symbol">(</a><a id="5671" class="Number">2</a> <a id="5673" href="Reflection.Helpers.html#1287" class="Function Operator">⋯⟅∷⟆</a> <a id="5678" href="Polynomial.Simple.Reflection.html#351" class="Bound">rng</a> <a id="5682" href="Reflection.Helpers.html#1158" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="5686" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="5688" class="Symbol">)</a> <a id="5690" href="Reflection.Helpers.html#1158" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="5694" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="5696" class="Symbol">))</a> <a id="5699" href="Function.html#2548" class="Function Operator">⟨</a> <a id="5701" href="Agda.Builtin.Reflection.html#7240" class="Postulate">bindTC</a> <a id="5708" href="Function.html#2548" class="Function Operator">⟩</a> <a id="5710" href="Agda.Builtin.Reflection.html#7487" class="Postulate">normalise</a>

  <a id="Internal.checkRing"></a><a id="5723" href="Polynomial.Simple.Reflection.html#5723" class="Function">checkRing</a> <a id="5733" class="Symbol">:</a> <a id="5735" href="Agda.Builtin.Reflection.html#7153" class="Postulate">TC</a> <a id="5738" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
  <a id="5745" href="Polynomial.Simple.Reflection.html#5723" class="Function">checkRing</a> <a id="5755" class="Symbol">=</a> <a id="5757" href="Agda.Builtin.Reflection.html#7447" class="Postulate">checkType</a> <a id="5767" href="Polynomial.Simple.Reflection.html#351" class="Bound">rng</a> <a id="5771" class="Symbol">(</a><a id="5772" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="5776" class="Symbol">(</a><a id="5777" class="Keyword">quote</a> <a id="5783" href="Polynomial.Simple.AlmostCommutativeRing.html#941" class="Record">AlmostCommutativeRing</a><a id="5804" class="Symbol">)</a> <a id="5806" class="Symbol">(</a><a id="5807" href="Agda.Builtin.Reflection.html#5048" class="InductiveConstructor">unknown</a> <a id="5815" href="Reflection.Helpers.html#1158" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="5819" href="Agda.Builtin.Reflection.html#5048" class="InductiveConstructor">unknown</a> <a id="5827" href="Reflection.Helpers.html#1158" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="5831" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="5833" class="Symbol">))</a>

  <a id="Internal.toSoln′"></a><a id="5839" href="Polynomial.Simple.Reflection.html#5839" class="Function">toSoln′</a> <a id="5847" class="Symbol">:</a> <a id="5849" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>  <a id="5855" class="Symbol">→</a> <a id="5857" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="5862" class="Symbol">→</a> <a id="5864" href="Agda.Builtin.Reflection.html#7153" class="Postulate">TC</a> <a id="5867" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
  <a id="5874" href="Polynomial.Simple.Reflection.html#5839" class="Function">toSoln′</a> <a id="5882" href="Polynomial.Simple.Reflection.html#5882" class="Bound">t′</a> <a id="5885" href="Polynomial.Simple.Reflection.html#5885" class="Bound">xs′</a> <a id="5889" class="Symbol">=</a> <a id="5891" href="Polynomial.Simple.Reflection.html#6500" class="Function">go</a> <a id="5894" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a> <a id="5897" href="Polynomial.Simple.Reflection.html#5882" class="Bound">t′</a> <a id="5900" href="Polynomial.Simple.Reflection.html#5885" class="Bound">xs′</a>
    <a id="5908" class="Keyword">where</a>
    <a id="5918" href="Polynomial.Simple.Reflection.html#5918" class="Function">go′</a> <a id="5922" class="Symbol">:</a> <a id="5924" href="Data.Nat.Table.html#425" class="Function">Table</a> <a id="5930" class="Symbol">→</a> <a id="5932" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="5937" class="Symbol">→</a> <a id="5939" href="Agda.Builtin.Reflection.html#7153" class="Postulate">TC</a> <a id="5942" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
    <a id="5951" href="Polynomial.Simple.Reflection.html#5918" class="Function">go′</a> <a id="5955" href="Polynomial.Simple.Reflection.html#5955" class="Bound">i</a> <a id="5957" class="Symbol">(</a><a id="5958" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="5962" href="Polynomial.Simple.Reflection.html#5962" class="Bound">f</a> <a id="5964" class="Symbol">(</a>            <a id="5977" href="Polynomial.Simple.Reflection.html#5977" class="Bound">lhs</a> <a id="5981" href="Reflection.Helpers.html#1158" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="5985" href="Polynomial.Simple.Reflection.html#5985" class="Bound">rhs</a> <a id="5989" href="Reflection.Helpers.html#1158" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="5993" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="5995" class="Symbol">))</a> <a id="5998" class="Symbol">=</a> <a id="6000" href="Polynomial.Simple.Reflection.html#4078" class="Function">constructSoln</a> <a id="6014" class="Symbol">(</a><a id="6015" href="Data.List.Base.html#4466" class="Function">List.length</a> <a id="6027" href="Polynomial.Simple.Reflection.html#5955" class="Bound">i</a><a id="6028" class="Symbol">)</a> <a id="6030" href="Polynomial.Simple.Reflection.html#5955" class="Bound">i</a> <a id="6032" href="Polynomial.Simple.Reflection.html#5977" class="Bound">lhs</a> <a id="6036" href="Polynomial.Simple.Reflection.html#5985" class="Bound">rhs</a>
    <a id="6044" href="Polynomial.Simple.Reflection.html#5918" class="CatchallClause Function">go′</a><a id="6047" class="CatchallClause"> </a><a id="6048" href="Polynomial.Simple.Reflection.html#6048" class="CatchallClause Bound">i</a><a id="6049" class="CatchallClause"> </a><a id="6050" class="CatchallClause Symbol">(</a><a id="6051" href="Agda.Builtin.Reflection.html#4705" class="CatchallClause InductiveConstructor">def</a><a id="6054" class="CatchallClause"> </a><a id="6055" href="Polynomial.Simple.Reflection.html#6055" class="CatchallClause Bound">f</a><a id="6056" class="CatchallClause"> </a><a id="6057" class="CatchallClause Symbol">(_</a><a id="6059" class="CatchallClause"> </a><a id="6060" href="Agda.Builtin.List.html#132" class="CatchallClause InductiveConstructor Operator">∷</a><a id="6061" class="CatchallClause"> </a><a id="6062" class="CatchallClause Symbol">_</a><a id="6063" class="CatchallClause"> </a><a id="6064" href="Agda.Builtin.List.html#132" class="CatchallClause InductiveConstructor Operator">∷</a><a id="6065" class="CatchallClause">     </a><a id="6070" href="Polynomial.Simple.Reflection.html#6070" class="CatchallClause Bound">lhs</a><a id="6073" class="CatchallClause"> </a><a id="6074" href="Reflection.Helpers.html#1158" class="CatchallClause InductiveConstructor Operator">⟨∷⟩</a><a id="6077" class="CatchallClause"> </a><a id="6078" href="Polynomial.Simple.Reflection.html#6078" class="CatchallClause Bound">rhs</a><a id="6081" class="CatchallClause"> </a><a id="6082" href="Reflection.Helpers.html#1158" class="CatchallClause InductiveConstructor Operator">⟨∷⟩</a><a id="6085" class="CatchallClause"> </a><a id="6086" href="Agda.Builtin.List.html#117" class="CatchallClause InductiveConstructor">[]</a><a id="6088" class="CatchallClause Symbol">))</a> <a id="6091" class="Symbol">=</a> <a id="6093" href="Polynomial.Simple.Reflection.html#4078" class="Function">constructSoln</a> <a id="6107" class="Symbol">(</a><a id="6108" href="Data.List.Base.html#4466" class="Function">List.length</a> <a id="6120" href="Polynomial.Simple.Reflection.html#6048" class="Bound">i</a><a id="6121" class="Symbol">)</a> <a id="6123" href="Polynomial.Simple.Reflection.html#6048" class="Bound">i</a> <a id="6125" href="Polynomial.Simple.Reflection.html#6070" class="Bound">lhs</a> <a id="6129" href="Polynomial.Simple.Reflection.html#6078" class="Bound">rhs</a>
    <a id="6137" href="Polynomial.Simple.Reflection.html#5918" class="CatchallClause Function">go′</a><a id="6140" class="CatchallClause"> </a><a id="6141" href="Polynomial.Simple.Reflection.html#6141" class="CatchallClause Bound">i</a><a id="6142" class="CatchallClause"> </a><a id="6143" class="CatchallClause Symbol">(</a><a id="6144" href="Agda.Builtin.Reflection.html#4705" class="CatchallClause InductiveConstructor">def</a><a id="6147" class="CatchallClause"> </a><a id="6148" href="Polynomial.Simple.Reflection.html#6148" class="CatchallClause Bound">f</a><a id="6149" class="CatchallClause"> </a><a id="6150" class="CatchallClause Symbol">(_</a><a id="6152" class="CatchallClause"> </a><a id="6153" href="Agda.Builtin.List.html#132" class="CatchallClause InductiveConstructor Operator">∷</a><a id="6154" class="CatchallClause"> </a><a id="6155" class="CatchallClause Symbol">_</a><a id="6156" class="CatchallClause"> </a><a id="6157" href="Agda.Builtin.List.html#132" class="CatchallClause InductiveConstructor Operator">∷</a><a id="6158" class="CatchallClause"> </a><a id="6159" class="CatchallClause Symbol">_</a><a id="6160" class="CatchallClause"> </a><a id="6161" href="Agda.Builtin.List.html#132" class="CatchallClause InductiveConstructor Operator">∷</a><a id="6162" class="CatchallClause"> </a><a id="6163" href="Polynomial.Simple.Reflection.html#6163" class="CatchallClause Bound">lhs</a><a id="6166" class="CatchallClause"> </a><a id="6167" href="Reflection.Helpers.html#1158" class="CatchallClause InductiveConstructor Operator">⟨∷⟩</a><a id="6170" class="CatchallClause"> </a><a id="6171" href="Polynomial.Simple.Reflection.html#6171" class="CatchallClause Bound">rhs</a><a id="6174" class="CatchallClause"> </a><a id="6175" href="Reflection.Helpers.html#1158" class="CatchallClause InductiveConstructor Operator">⟨∷⟩</a><a id="6178" class="CatchallClause"> </a><a id="6179" href="Agda.Builtin.List.html#117" class="CatchallClause InductiveConstructor">[]</a><a id="6181" class="CatchallClause Symbol">))</a> <a id="6184" class="Symbol">=</a> <a id="6186" href="Polynomial.Simple.Reflection.html#4078" class="Function">constructSoln</a> <a id="6200" class="Symbol">(</a><a id="6201" href="Data.List.Base.html#4466" class="Function">List.length</a> <a id="6213" href="Polynomial.Simple.Reflection.html#6141" class="Bound">i</a><a id="6214" class="Symbol">)</a> <a id="6216" href="Polynomial.Simple.Reflection.html#6141" class="Bound">i</a> <a id="6218" href="Polynomial.Simple.Reflection.html#6163" class="Bound">lhs</a> <a id="6222" href="Polynomial.Simple.Reflection.html#6171" class="Bound">rhs</a>
    <a id="6230" href="Polynomial.Simple.Reflection.html#5918" class="CatchallClause Function">go′</a><a id="6233" class="CatchallClause"> </a><a id="6234" class="CatchallClause Symbol">_</a><a id="6235" class="CatchallClause"> </a><a id="6236" class="CatchallClause Symbol">_</a> <a id="6238" class="Symbol">=</a> <a id="6240" href="Agda.Builtin.Reflection.html#7354" class="Postulate">typeError</a> <a id="6250" class="Symbol">(</a><a id="6251" href="Agda.Builtin.Reflection.html#6852" class="InductiveConstructor">strErr</a> <a id="6258" class="String">&quot;Malformed call to solveOver.&quot;</a> <a id="6289" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a>
                         <a id="6316" href="Agda.Builtin.Reflection.html#6852" class="InductiveConstructor">strErr</a> <a id="6323" class="String">&quot;Target type should be an equality like x + y ≈ y + x.&quot;</a> <a id="6379" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a>
                         <a id="6406" href="Agda.Builtin.Reflection.html#6852" class="InductiveConstructor">strErr</a> <a id="6413" class="String">&quot;Instead: &quot;</a> <a id="6425" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a>
                         <a id="6452" href="Agda.Builtin.Reflection.html#6883" class="InductiveConstructor">termErr</a> <a id="6460" href="Polynomial.Simple.Reflection.html#5885" class="Bound">xs′</a> <a id="6464" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a>
                         <a id="6491" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="6493" class="Symbol">)</a>

    <a id="6500" href="Polynomial.Simple.Reflection.html#6500" class="Function">go</a> <a id="6503" class="Symbol">:</a> <a id="6505" href="Data.Nat.Table.html#425" class="Function">Table</a> <a id="6511" class="Symbol">→</a> <a id="6513" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="6518" class="Symbol">→</a> <a id="6520" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="6525" class="Symbol">→</a> <a id="6527" href="Agda.Builtin.Reflection.html#7153" class="Postulate">TC</a> <a id="6530" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
    <a id="6539" href="Polynomial.Simple.Reflection.html#6500" class="Function">go</a> <a id="6542" href="Polynomial.Simple.Reflection.html#6542" class="Bound">t</a> <a id="6544" class="Symbol">(</a><a id="6545" href="Agda.Builtin.Reflection.html#4648" class="InductiveConstructor">con</a> <a id="6549" class="Symbol">(</a><a id="6550" class="Keyword">quote</a> <a id="6556" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">List._∷_</a><a id="6564" class="Symbol">)</a> <a id="6566" class="Symbol">(_</a> <a id="6569" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="6571" class="Symbol">_</a> <a id="6573" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="6575" href="Agda.Builtin.Reflection.html#4592" class="InductiveConstructor">var</a> <a id="6579" href="Polynomial.Simple.Reflection.html#6579" class="Bound">i</a> <a id="6581" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a> <a id="6584" href="Reflection.Helpers.html#1158" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="6588" href="Polynomial.Simple.Reflection.html#6588" class="Bound">xs</a> <a id="6591" href="Reflection.Helpers.html#1158" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="6595" class="Symbol">_))</a> <a id="6599" href="Polynomial.Simple.Reflection.html#6599" class="Bound">ys</a> <a id="6602" class="Symbol">=</a> <a id="6604" href="Polynomial.Simple.Reflection.html#6500" class="Function">go</a> <a id="6607" class="Symbol">(</a><a id="6608" href="Data.Nat.Table.html#590" class="Function">insert</a> <a id="6615" href="Polynomial.Simple.Reflection.html#6579" class="Bound">i</a> <a id="6617" href="Polynomial.Simple.Reflection.html#6542" class="Bound">t</a><a id="6618" class="Symbol">)</a> <a id="6620" href="Polynomial.Simple.Reflection.html#6588" class="Bound">xs</a> <a id="6623" href="Polynomial.Simple.Reflection.html#6599" class="Bound">ys</a>
    <a id="6630" href="Polynomial.Simple.Reflection.html#6500" class="Function">go</a> <a id="6633" href="Polynomial.Simple.Reflection.html#6633" class="Bound">t</a> <a id="6635" class="Symbol">(</a><a id="6636" href="Agda.Builtin.Reflection.html#4648" class="InductiveConstructor">con</a> <a id="6640" class="Symbol">(</a><a id="6641" class="Keyword">quote</a> <a id="6647" href="Agda.Builtin.List.html#117" class="InductiveConstructor">List.List.[]</a><a id="6659" class="Symbol">)</a> <a id="6661" class="Symbol">_)</a> <a id="6664" href="Polynomial.Simple.Reflection.html#6664" class="Bound">xs</a> <a id="6667" class="Symbol">=</a> <a id="6669" href="Polynomial.Simple.Reflection.html#5918" class="Function">go′</a> <a id="6673" href="Polynomial.Simple.Reflection.html#6633" class="Bound">t</a> <a id="6675" href="Polynomial.Simple.Reflection.html#6664" class="Bound">xs</a>
    <a id="6682" href="Polynomial.Simple.Reflection.html#6500" class="CatchallClause Function">go</a><a id="6684" class="CatchallClause"> </a><a id="6685" href="Polynomial.Simple.Reflection.html#6685" class="CatchallClause Bound">i</a><a id="6686" class="CatchallClause"> </a><a id="6687" href="Polynomial.Simple.Reflection.html#6687" class="CatchallClause Bound">k</a><a id="6688" class="CatchallClause"> </a><a id="6689" href="Polynomial.Simple.Reflection.html#6689" class="CatchallClause Bound">t</a> <a id="6691" class="Symbol">=</a> <a id="6693" href="Agda.Builtin.Reflection.html#7354" class="Postulate">typeError</a> <a id="6703" class="Symbol">(</a><a id="6704" href="Agda.Builtin.Reflection.html#6852" class="InductiveConstructor">strErr</a> <a id="6711" class="String">&quot;Malformed call to solveOver.&quot;</a> <a id="6742" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a>
                          <a id="6770" href="Agda.Builtin.Reflection.html#6852" class="InductiveConstructor">strErr</a> <a id="6777" class="String">&quot;First argument should be a list of free variables.&quot;</a> <a id="6830" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a>
                          <a id="6858" href="Agda.Builtin.Reflection.html#6852" class="InductiveConstructor">strErr</a> <a id="6865" class="String">&quot;Instead: &quot;</a> <a id="6877" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a>
                          <a id="6905" href="Agda.Builtin.Reflection.html#6883" class="InductiveConstructor">termErr</a> <a id="6913" href="Polynomial.Simple.Reflection.html#5882" class="Bound">t′</a> <a id="6916" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a>
                          <a id="6944" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="6946" class="Symbol">)</a>
<a id="6948" class="Keyword">open</a> <a id="6953" href="Polynomial.Simple.Reflection.html#341" class="Module">Internal</a>

<a id="6963" class="Comment">-- This is the main macro you&#39;ll probably be using. Call it like this:</a>
<a id="7034" class="Comment">--</a>
<a id="7037" class="Comment">--   lemma : ∀ x y → x + y ≈ y + x</a>
<a id="7072" class="Comment">--   lemma = solve TypeRing</a>
<a id="7100" class="Comment">--</a>
<a id="7103" class="Comment">-- where TypRing is your implementation of AlmostCommutativeRing. (Find some</a>
<a id="7180" class="Comment">-- example implementations in Polynomial.Solver.Ring.AlmostCommutativeRing.Instances).</a>
<a id="7267" class="Keyword">macro</a>
  <a id="solve"></a><a id="7275" href="Polynomial.Simple.Reflection.html#7275" class="Function">solve</a> <a id="7281" class="Symbol">:</a> <a id="7283" href="Agda.Builtin.Reflection.html#363" class="Postulate">Name</a> <a id="7288" class="Symbol">→</a> <a id="7290" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="7295" class="Symbol">→</a> <a id="7297" href="Agda.Builtin.Reflection.html#7153" class="Postulate">TC</a> <a id="7300" href="Agda.Builtin.Unit.html#69" class="Record">⊤</a>
  <a id="7304" href="Polynomial.Simple.Reflection.html#7275" class="Function">solve</a> <a id="7310" href="Polynomial.Simple.Reflection.html#7310" class="Bound">rng′</a> <a id="7315" href="Polynomial.Simple.Reflection.html#7315" class="Bound">hole</a> <a id="7320" class="Symbol">=</a> <a id="7322" class="Keyword">do</a>
    <a id="7329" href="Polynomial.Simple.Reflection.html#7329" class="Bound">rng</a> <a id="7333" href="Reflection.Helpers.html#738" class="Function Operator">←</a> <a id="7335" href="Polynomial.Simple.Reflection.html#5723" class="Function">checkRing</a> <a id="7345" class="Symbol">(</a><a id="7346" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="7350" href="Polynomial.Simple.Reflection.html#7310" class="Bound">rng′</a> <a id="7355" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="7357" class="Symbol">)</a>
    <a id="7363" href="Agda.Builtin.Reflection.html#8165" class="Postulate">commitTC</a>
    <a id="7376" href="Polynomial.Simple.Reflection.html#7376" class="Bound">soln</a> <a id="7381" href="Reflection.Helpers.html#738" class="Function Operator">←</a> <a id="7383" href="Agda.Builtin.Reflection.html#7414" class="Postulate">inferType</a> <a id="7393" href="Polynomial.Simple.Reflection.html#7315" class="Bound">hole</a> <a id="7398" href="Function.html#2548" class="Function Operator">⟨</a> <a id="7400" href="Agda.Builtin.Reflection.html#7240" class="Postulate">bindTC</a> <a id="7407" href="Function.html#2548" class="Function Operator">⟩</a> <a id="7409" href="Agda.Builtin.Reflection.html#7520" class="Postulate">reduce</a> <a id="7416" href="Function.html#2548" class="Function Operator">⟨</a> <a id="7418" href="Agda.Builtin.Reflection.html#7240" class="Postulate">bindTC</a> <a id="7425" href="Function.html#2548" class="Function Operator">⟩</a> <a id="7427" href="Polynomial.Simple.Reflection.html#4805" class="Function">toSoln</a> <a id="7434" href="Polynomial.Simple.Reflection.html#7329" class="Bound">rng</a>
    <a id="7442" href="Agda.Builtin.Reflection.html#8165" class="Postulate">commitTC</a>
    <a id="7455" href="Agda.Builtin.Reflection.html#7317" class="Postulate">unify</a> <a id="7461" href="Polynomial.Simple.Reflection.html#7315" class="Bound">hole</a> <a id="7466" href="Polynomial.Simple.Reflection.html#7376" class="Bound">soln</a>

<a id="7472" class="Comment">-- Use this macro when you want to solve something *under* a lambda. For example:</a>
<a id="7554" class="Comment">-- say you have a long proof, and you just want the solver to deal with an</a>
<a id="7629" class="Comment">-- intermediate step. Call it like so:</a>
<a id="7668" class="Comment">--</a>
<a id="7671" class="Comment">--   lemma₃ : ∀ x y → x + y * 1 + 3 ≈ 2 + 1 + y + x</a>
<a id="7723" class="Comment">--   lemma₃ x y = begin</a>
<a id="7747" class="Comment">--     x + y * 1 + 3 ≈⟨ +-comm x (y * 1) ⟨ +-cong ⟩ refl ⟩</a>
<a id="7806" class="Comment">--     y * 1 + x + 3 ≈⟨ solveOver (x ∷ y ∷ []) Int.ring ⟩</a>
<a id="7864" class="Comment">--     3 + y + x     ≡⟨ refl ⟩</a>
<a id="7895" class="Comment">--     2 + 1 + y + x ∎</a>
<a id="7918" class="Comment">--</a>
<a id="7921" class="Comment">-- The first argument is the free variables, and the second is the</a>
<a id="7988" class="Comment">-- ring implementation (as before).</a>
<a id="8024" class="Comment">--</a>
<a id="8027" class="Comment">-- One thing to note here is that we need to be able to infer *both* sides of</a>
<a id="8105" class="Comment">-- the equality, which the normal equaltional reasoning combinators don&#39;t let you</a>
<a id="8187" class="Comment">-- do. You&#39;ll need the combinators defined in Relation.Binary.Reasoning.Inference.</a>
<a id="8270" class="Comment">-- These are just as powerful as the others, but have slightly better inference properties.</a>

<a id="8363" class="Keyword">macro</a>
  <a id="solveOver"></a><a id="8371" href="Polynomial.Simple.Reflection.html#8371" class="Function">solveOver</a> <a id="8381" class="Symbol">:</a> <a id="8383" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="8388" class="Symbol">→</a> <a id="8390" href="Agda.Builtin.Reflection.html#363" class="Postulate">Name</a> <a id="8395" class="Symbol">→</a> <a id="8397" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="8402" class="Symbol">→</a> <a id="8404" href="Agda.Builtin.Reflection.html#7153" class="Postulate">TC</a> <a id="8407" href="Agda.Builtin.Unit.html#69" class="Record">⊤</a>
  <a id="8411" href="Polynomial.Simple.Reflection.html#8371" class="Function">solveOver</a> <a id="8421" href="Polynomial.Simple.Reflection.html#8421" class="Bound">i′</a> <a id="8424" href="Polynomial.Simple.Reflection.html#8424" class="Bound">rng′</a> <a id="8429" href="Polynomial.Simple.Reflection.html#8429" class="Bound">hole</a> <a id="8434" class="Symbol">=</a> <a id="8436" class="Keyword">do</a>
    <a id="8443" href="Polynomial.Simple.Reflection.html#8443" class="Bound">rng</a> <a id="8447" href="Reflection.Helpers.html#738" class="Function Operator">←</a> <a id="8449" href="Polynomial.Simple.Reflection.html#5723" class="Function">checkRing</a> <a id="8459" class="Symbol">(</a><a id="8460" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="8464" href="Polynomial.Simple.Reflection.html#8424" class="Bound">rng′</a> <a id="8469" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="8471" class="Symbol">)</a>
    <a id="8477" href="Agda.Builtin.Reflection.html#8165" class="Postulate">commitTC</a>
    <a id="8490" href="Polynomial.Simple.Reflection.html#8490" class="Bound">i</a> <a id="8492" href="Reflection.Helpers.html#738" class="Function Operator">←</a> <a id="8494" href="Polynomial.Simple.Reflection.html#5567" class="Function">listType</a> <a id="8503" href="Polynomial.Simple.Reflection.html#8443" class="Bound">rng</a> <a id="8507" href="Polynomial.Simple.Reflection.html#8421" class="Bound">i′</a>
    <a id="8514" href="Agda.Builtin.Reflection.html#8165" class="Postulate">commitTC</a>
    <a id="8527" href="Polynomial.Simple.Reflection.html#8527" class="Bound">soln</a> <a id="8532" href="Reflection.Helpers.html#738" class="Function Operator">←</a> <a id="8534" href="Agda.Builtin.Reflection.html#7414" class="Postulate">inferType</a> <a id="8544" href="Polynomial.Simple.Reflection.html#8429" class="Bound">hole</a> <a id="8549" href="Function.html#2548" class="Function Operator">⟨</a> <a id="8551" href="Agda.Builtin.Reflection.html#7240" class="Postulate">bindTC</a> <a id="8558" href="Function.html#2548" class="Function Operator">⟩</a> <a id="8560" href="Agda.Builtin.Reflection.html#7520" class="Postulate">reduce</a> <a id="8567" href="Function.html#2548" class="Function Operator">⟨</a> <a id="8569" href="Agda.Builtin.Reflection.html#7240" class="Postulate">bindTC</a> <a id="8576" href="Function.html#2548" class="Function Operator">⟩</a> <a id="8578" href="Polynomial.Simple.Reflection.html#5839" class="Function">toSoln′</a> <a id="8586" href="Polynomial.Simple.Reflection.html#8443" class="Bound">rng</a> <a id="8590" href="Polynomial.Simple.Reflection.html#8490" class="Bound">i</a>
    <a id="8596" href="Agda.Builtin.Reflection.html#8165" class="Postulate">commitTC</a>
    <a id="8609" href="Agda.Builtin.Reflection.html#7317" class="Postulate">unify</a> <a id="8615" href="Polynomial.Simple.Reflection.html#8429" class="Bound">hole</a> <a id="8620" href="Polynomial.Simple.Reflection.html#8527" class="Bound">soln</a>
</pre></body></html>