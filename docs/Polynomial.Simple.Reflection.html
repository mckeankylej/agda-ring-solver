<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Polynomial.Simple.Reflection</title><link rel="stylesheet" href="Agda.css"></head><body><pre><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Option">--without-K</a> <a id="25" class="Option">--safe</a> <a id="32" class="Symbol">#-}</a>

<a id="37" class="Keyword">module</a> <a id="44" href="Polynomial.Simple.Reflection.html" class="Module">Polynomial.Simple.Reflection</a> <a id="73" class="Keyword">where</a>

<a id="80" class="Keyword">open</a> <a id="85" class="Keyword">import</a> <a id="92" href="Agda.Builtin.Reflection.html" class="Module">Agda.Builtin.Reflection</a>
<a id="116" class="Keyword">open</a> <a id="121" class="Keyword">import</a> <a id="128" href="Reflection.html" class="Module">Reflection</a>
<a id="139" class="Keyword">open</a> <a id="144" class="Keyword">import</a> <a id="151" href="Function.html" class="Module">Function</a>
<a id="160" class="Keyword">open</a> <a id="165" class="Keyword">import</a> <a id="172" href="Data.Unit.html" class="Module">Data.Unit</a> <a id="182" class="Keyword">using</a> <a id="188" class="Symbol">(</a><a id="189" href="Agda.Builtin.Unit.html#69" class="Record">⊤</a><a id="190" class="Symbol">)</a>
<a id="192" class="Keyword">open</a> <a id="197" class="Keyword">import</a> <a id="204" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="213" class="Symbol">as</a> <a id="216" class="Module">ℕ</a> <a id="218" class="Keyword">using</a> <a id="224" class="Symbol">(</a><a id="225" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a><a id="226" class="Symbol">;</a> <a id="228" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a><a id="231" class="Symbol">;</a> <a id="233" href="Agda.Builtin.Nat.html#115" class="InductiveConstructor">zero</a><a id="237" class="Symbol">)</a>
<a id="239" class="Keyword">open</a> <a id="244" class="Keyword">import</a> <a id="251" href="Data.List.html" class="Module">Data.List</a> <a id="261" class="Symbol">as</a> <a id="264" class="Module">List</a> <a id="269" class="Keyword">using</a> <a id="275" class="Symbol">(</a><a id="276" href="Agda.Builtin.List.html#80" class="Datatype">List</a><a id="280" class="Symbol">;</a> <a id="282" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">_∷_</a><a id="285" class="Symbol">;</a> <a id="287" href="Data.List.Base.html#9863" class="InductiveConstructor">[]</a><a id="289" class="Symbol">;</a> <a id="291" href="Data.List.Base.html#3600" class="Function">foldr</a><a id="296" class="Symbol">)</a>

<a id="_&gt;&gt;=_"></a><a id="299" href="Polynomial.Simple.Reflection.html#299" class="Function Operator">_&gt;&gt;=_</a> <a id="305" class="Symbol">:</a> <a id="307" class="Symbol">{</a><a id="308" href="Polynomial.Simple.Reflection.html#308" class="Bound">A</a> <a id="310" href="Polynomial.Simple.Reflection.html#310" class="Bound">B</a> <a id="312" class="Symbol">:</a> <a id="314" class="PrimitiveType">Set</a><a id="317" class="Symbol">}</a> <a id="319" class="Symbol">→</a> <a id="321" href="Agda.Builtin.Reflection.html#7153" class="Postulate">TC</a> <a id="324" href="Polynomial.Simple.Reflection.html#308" class="Bound">A</a> <a id="326" class="Symbol">→</a> <a id="328" class="Symbol">(</a><a id="329" href="Polynomial.Simple.Reflection.html#308" class="Bound">A</a> <a id="331" class="Symbol">→</a> <a id="333" href="Agda.Builtin.Reflection.html#7153" class="Postulate">TC</a> <a id="336" href="Polynomial.Simple.Reflection.html#310" class="Bound">B</a><a id="337" class="Symbol">)</a> <a id="339" class="Symbol">→</a> <a id="341" href="Agda.Builtin.Reflection.html#7153" class="Postulate">TC</a> <a id="344" href="Polynomial.Simple.Reflection.html#310" class="Bound">B</a>
<a id="346" href="Polynomial.Simple.Reflection.html#299" class="Function Operator">_&gt;&gt;=_</a> <a id="352" class="Symbol">=</a> <a id="354" href="Agda.Builtin.Reflection.html#7240" class="Postulate">bindTC</a>

<a id="362" class="Keyword">module</a> <a id="Internal"></a><a id="369" href="Polynomial.Simple.Reflection.html#369" class="Module">Internal</a> <a id="378" class="Symbol">(</a><a id="379" href="Polynomial.Simple.Reflection.html#379" class="Bound">rng</a> <a id="383" class="Symbol">:</a> <a id="385" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a><a id="389" class="Symbol">)</a> <a id="391" class="Keyword">where</a>
  <a id="399" class="Keyword">open</a> <a id="404" class="Keyword">import</a> <a id="411" href="Polynomial.Simple.Solver.html" class="Module">Polynomial.Simple.Solver</a> <a id="436" class="Keyword">renaming</a> <a id="445" class="Symbol">(</a><a id="446" href="Polynomial.Simple.Solver.html#2840" class="Function">solve</a> <a id="452" class="Symbol">to</a> <a id="455" href="Polynomial.Simple.Solver.html#2840" class="Function">solve′</a><a id="461" class="Symbol">)</a>
  <a id="465" class="Keyword">open</a> <a id="470" class="Keyword">import</a> <a id="477" href="Data.String.html" class="Module">Data.String</a>
  <a id="491" class="Keyword">open</a> <a id="496" class="Keyword">import</a> <a id="503" href="Relation.Nullary.html" class="Module">Relation.Nullary</a> <a id="520" class="Keyword">using</a> <a id="526" class="Symbol">(</a><a id="527" href="Relation.Nullary.html#570" class="Datatype">Dec</a><a id="530" class="Symbol">;</a> <a id="532" href="Relation.Nullary.html#606" class="InductiveConstructor">yes</a><a id="535" class="Symbol">;</a> <a id="537" href="Relation.Nullary.html#633" class="InductiveConstructor">no</a><a id="539" class="Symbol">)</a>
  <a id="543" class="Keyword">import</a> <a id="550" href="Data.Vec.html" class="Module">Data.Vec</a> <a id="559" class="Symbol">as</a> <a id="562" class="Module">Vec</a>
  <a id="568" class="Keyword">import</a> <a id="575" href="Data.Fin.html" class="Module">Data.Fin</a> <a id="584" class="Symbol">as</a> <a id="587" class="Module">Fin</a>
  <a id="593" class="Keyword">open</a> <a id="598" class="Keyword">import</a> <a id="605" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="616" class="Symbol">as</a> <a id="619" class="Module">Maybe</a> <a id="625" class="Keyword">using</a> <a id="631" class="Symbol">(</a><a id="632" href="Data.Maybe.Base.html#710" class="Datatype">Maybe</a><a id="637" class="Symbol">;</a> <a id="639" href="Data.Maybe.Base.html#748" class="InductiveConstructor">just</a><a id="643" class="Symbol">;</a> <a id="645" href="Data.Maybe.Base.html#778" class="InductiveConstructor">nothing</a><a id="652" class="Symbol">)</a>

  <a id="657" class="Keyword">open</a> <a id="662" class="Keyword">import</a> <a id="669" href="Data.Nat.Table.html" class="Module">Data.Nat.Table</a>

  <a id="687" class="Comment">-- Some patterns to decrease verbosity</a>
  <a id="728" class="Keyword">infixr</a> <a id="735" class="Number">5</a> <a id="737" href="Polynomial.Simple.Reflection.html#759" class="InductiveConstructor Operator">_⟨∷⟩_</a> <a id="743" href="Polynomial.Simple.Reflection.html#821" class="InductiveConstructor Operator">_⟅∷⟆_</a>
  <a id="751" class="Keyword">pattern</a> <a id="Internal._⟨∷⟩_"></a><a id="759" href="Polynomial.Simple.Reflection.html#759" class="InductiveConstructor Operator">_⟨∷⟩_</a> <a id="765" href="Polynomial.Simple.Reflection.html#804" class="Bound">x</a> <a id="767" href="Polynomial.Simple.Reflection.html#808" class="Bound">xs</a> <a id="770" class="Symbol">=</a> <a id="772" href="Agda.Builtin.Reflection.html#3069" class="InductiveConstructor">arg</a> <a id="776" class="Symbol">(</a><a id="777" href="Agda.Builtin.Reflection.html#2981" class="InductiveConstructor">arg-info</a> <a id="786" href="Agda.Builtin.Reflection.html#2549" class="InductiveConstructor">visible</a> <a id="794" href="Agda.Builtin.Reflection.html#2806" class="InductiveConstructor">relevant</a><a id="802" class="Symbol">)</a> <a id="804" href="Polynomial.Simple.Reflection.html#804" class="Bound">x</a> <a id="806" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="808" href="Polynomial.Simple.Reflection.html#808" class="Bound">xs</a>
  <a id="813" class="Keyword">pattern</a> <a id="Internal._⟅∷⟆_"></a><a id="821" href="Polynomial.Simple.Reflection.html#821" class="InductiveConstructor Operator">_⟅∷⟆_</a> <a id="827" href="Polynomial.Simple.Reflection.html#865" class="Bound">x</a> <a id="829" href="Polynomial.Simple.Reflection.html#869" class="Bound">xs</a> <a id="832" class="Symbol">=</a> <a id="834" href="Agda.Builtin.Reflection.html#3069" class="InductiveConstructor">arg</a> <a id="838" class="Symbol">(</a><a id="839" href="Agda.Builtin.Reflection.html#2981" class="InductiveConstructor">arg-info</a> <a id="848" href="Agda.Builtin.Reflection.html#2557" class="InductiveConstructor">hidden</a> <a id="855" href="Agda.Builtin.Reflection.html#2806" class="InductiveConstructor">relevant</a><a id="863" class="Symbol">)</a> <a id="865" href="Polynomial.Simple.Reflection.html#865" class="Bound">x</a> <a id="867" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="869" href="Polynomial.Simple.Reflection.html#869" class="Bound">xs</a>

  <a id="875" class="Keyword">infixr</a> <a id="882" class="Number">5</a> <a id="884" href="Polynomial.Simple.Reflection.html#893" class="Function Operator">_⋯⟅∷⟆_</a>
  <a id="Internal._⋯⟅∷⟆_"></a><a id="893" href="Polynomial.Simple.Reflection.html#893" class="Function Operator">_⋯⟅∷⟆_</a> <a id="900" class="Symbol">:</a> <a id="902" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="904" class="Symbol">→</a> <a id="906" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="911" class="Symbol">(</a><a id="912" href="Agda.Builtin.Reflection.html#3041" class="Datatype">Arg</a> <a id="916" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a><a id="920" class="Symbol">)</a> <a id="922" class="Symbol">→</a> <a id="924" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="929" class="Symbol">(</a><a id="930" href="Agda.Builtin.Reflection.html#3041" class="Datatype">Arg</a> <a id="934" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a><a id="938" class="Symbol">)</a>
  <a id="942" href="Agda.Builtin.Nat.html#115" class="InductiveConstructor">zero</a>  <a id="948" href="Polynomial.Simple.Reflection.html#893" class="Function Operator">⋯⟅∷⟆</a> <a id="953" href="Polynomial.Simple.Reflection.html#953" class="Bound">xs</a> <a id="956" class="Symbol">=</a> <a id="958" href="Polynomial.Simple.Reflection.html#953" class="Bound">xs</a>
  <a id="963" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="967" href="Polynomial.Simple.Reflection.html#967" class="Bound">i</a> <a id="969" href="Polynomial.Simple.Reflection.html#893" class="Function Operator">⋯⟅∷⟆</a> <a id="974" href="Polynomial.Simple.Reflection.html#974" class="Bound">xs</a> <a id="977" class="Symbol">=</a> <a id="979" href="Agda.Builtin.Reflection.html#5048" class="InductiveConstructor">unknown</a> <a id="987" href="Polynomial.Simple.Reflection.html#821" class="InductiveConstructor Operator">⟅∷⟆</a>  <a id="992" href="Polynomial.Simple.Reflection.html#967" class="Bound">i</a> <a id="994" href="Polynomial.Simple.Reflection.html#893" class="Function Operator">⋯⟅∷⟆</a> <a id="999" href="Polynomial.Simple.Reflection.html#974" class="Bound">xs</a>

  <a id="Internal.natTerm"></a><a id="1005" href="Polynomial.Simple.Reflection.html#1005" class="Function">natTerm</a> <a id="1013" class="Symbol">:</a> <a id="1015" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="1017" class="Symbol">→</a> <a id="1019" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
  <a id="1026" href="Polynomial.Simple.Reflection.html#1005" class="Function">natTerm</a> <a id="1034" href="Agda.Builtin.Nat.html#115" class="InductiveConstructor">zero</a> <a id="1039" class="Symbol">=</a> <a id="1041" class="Keyword">quote</a> <a id="1047" href="Agda.Builtin.Nat.html#115" class="InductiveConstructor">zero</a> <a id="1052" href="Function.html#2548" class="Function Operator">⟨</a> <a id="1054" href="Agda.Builtin.Reflection.html#4648" class="InductiveConstructor">con</a> <a id="1058" href="Function.html#2548" class="Function Operator">⟩</a> <a id="1060" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>
  <a id="1065" href="Polynomial.Simple.Reflection.html#1005" class="Function">natTerm</a> <a id="1073" class="Symbol">(</a><a id="1074" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="1078" href="Polynomial.Simple.Reflection.html#1078" class="Bound">i</a><a id="1079" class="Symbol">)</a> <a id="1081" class="Symbol">=</a> <a id="1083" class="Keyword">quote</a> <a id="1089" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="1093" href="Function.html#2548" class="Function Operator">⟨</a> <a id="1095" href="Agda.Builtin.Reflection.html#4648" class="InductiveConstructor">con</a> <a id="1099" href="Function.html#2548" class="Function Operator">⟩</a> <a id="1101" href="Polynomial.Simple.Reflection.html#1005" class="Function">natTerm</a> <a id="1109" href="Polynomial.Simple.Reflection.html#1078" class="Bound">i</a> <a id="1111" href="Polynomial.Simple.Reflection.html#759" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="1115" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>

  <a id="Internal.finTerm"></a><a id="1121" href="Polynomial.Simple.Reflection.html#1121" class="Function">finTerm</a> <a id="1129" class="Symbol">:</a> <a id="1131" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="1133" class="Symbol">→</a> <a id="1135" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
  <a id="1142" href="Polynomial.Simple.Reflection.html#1121" class="Function">finTerm</a> <a id="1150" href="Agda.Builtin.Nat.html#115" class="InductiveConstructor">zero</a> <a id="1155" class="Symbol">=</a> <a id="1157" class="Keyword">quote</a> <a id="1163" href="Data.Fin.Base.html#973" class="InductiveConstructor">Fin.zero</a> <a id="1172" href="Function.html#2548" class="Function Operator">⟨</a> <a id="1174" href="Agda.Builtin.Reflection.html#4648" class="InductiveConstructor">con</a> <a id="1178" href="Function.html#2548" class="Function Operator">⟩</a> <a id="1180" class="Number">1</a> <a id="1182" href="Polynomial.Simple.Reflection.html#893" class="Function Operator">⋯⟅∷⟆</a> <a id="1187" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>
  <a id="1192" href="Polynomial.Simple.Reflection.html#1121" class="Function">finTerm</a> <a id="1200" class="Symbol">(</a><a id="1201" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="1205" href="Polynomial.Simple.Reflection.html#1205" class="Bound">i</a><a id="1206" class="Symbol">)</a> <a id="1208" class="Symbol">=</a> <a id="1210" class="Keyword">quote</a> <a id="1216" href="Data.Fin.Base.html#1004" class="InductiveConstructor">Fin.suc</a> <a id="1224" href="Function.html#2548" class="Function Operator">⟨</a> <a id="1226" href="Agda.Builtin.Reflection.html#4648" class="InductiveConstructor">con</a> <a id="1230" href="Function.html#2548" class="Function Operator">⟩</a> <a id="1232" class="Number">1</a> <a id="1234" href="Polynomial.Simple.Reflection.html#893" class="Function Operator">⋯⟅∷⟆</a> <a id="1239" href="Polynomial.Simple.Reflection.html#1121" class="Function">finTerm</a> <a id="1247" href="Polynomial.Simple.Reflection.html#1205" class="Bound">i</a> <a id="1249" href="Polynomial.Simple.Reflection.html#759" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="1253" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>

  <a id="Internal.curriedTerm"></a><a id="1259" href="Polynomial.Simple.Reflection.html#1259" class="Function">curriedTerm</a> <a id="1271" class="Symbol">:</a> <a id="1273" href="Data.Nat.Table.html#425" class="Function">Table</a> <a id="1279" class="Symbol">→</a> <a id="1281" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
  <a id="1288" href="Polynomial.Simple.Reflection.html#1259" class="Function">curriedTerm</a> <a id="1300" class="Symbol">=</a> <a id="1302" href="Polynomial.Simple.Reflection.html#1324" class="Function">go</a> <a id="1305" href="Agda.Builtin.Nat.html#115" class="InductiveConstructor">zero</a>
    <a id="1314" class="Keyword">where</a>
    <a id="1324" href="Polynomial.Simple.Reflection.html#1324" class="Function">go</a> <a id="1327" class="Symbol">:</a> <a id="1329" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="1331" class="Symbol">→</a> <a id="1333" href="Data.Nat.Table.html#425" class="Function">Table</a> <a id="1339" class="Symbol">→</a> <a id="1341" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
    <a id="1350" href="Polynomial.Simple.Reflection.html#1324" class="Function">go</a> <a id="1353" href="Polynomial.Simple.Reflection.html#1353" class="Bound">k</a> <a id="1355" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a> <a id="1358" class="Symbol">=</a> <a id="1360" class="Keyword">quote</a> <a id="1366" href="Data.Vec.html#813" class="InductiveConstructor">Vec.[]</a> <a id="1373" href="Function.html#2548" class="Function Operator">⟨</a> <a id="1375" href="Agda.Builtin.Reflection.html#4648" class="InductiveConstructor">con</a> <a id="1379" href="Function.html#2548" class="Function Operator">⟩</a> <a id="1381" class="Number">2</a> <a id="1383" href="Polynomial.Simple.Reflection.html#893" class="Function Operator">⋯⟅∷⟆</a> <a id="1388" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>
    <a id="1395" href="Polynomial.Simple.Reflection.html#1324" class="Function">go</a> <a id="1398" href="Polynomial.Simple.Reflection.html#1398" class="Bound">k</a> <a id="1400" class="Symbol">(</a><a id="1401" href="Polynomial.Simple.Reflection.html#1401" class="Bound">x</a> <a id="1403" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="1405" href="Polynomial.Simple.Reflection.html#1405" class="Bound">xs</a><a id="1407" class="Symbol">)</a> <a id="1409" class="Symbol">=</a> <a id="1411" class="Keyword">quote</a> <a id="1417" href="Data.Vec.html#832" class="InductiveConstructor Operator">Vec._∷_</a> <a id="1425" href="Function.html#2548" class="Function Operator">⟨</a> <a id="1427" href="Agda.Builtin.Reflection.html#4648" class="InductiveConstructor">con</a> <a id="1431" href="Function.html#2548" class="Function Operator">⟩</a> <a id="1433" class="Number">2</a> <a id="1435" href="Polynomial.Simple.Reflection.html#893" class="Function Operator">⋯⟅∷⟆</a> <a id="1440" class="Number">1</a> <a id="1442" href="Polynomial.Simple.Reflection.html#893" class="Function Operator">⋯⟅∷⟆</a> <a id="1447" href="Agda.Builtin.Reflection.html#4592" class="InductiveConstructor">var</a> <a id="1451" class="Symbol">(</a><a id="1452" href="Polynomial.Simple.Reflection.html#1398" class="Bound">k</a> <a id="1454" href="Agda.Builtin.Nat.html#230" class="Primitive Operator">ℕ.+</a> <a id="1458" href="Polynomial.Simple.Reflection.html#1401" class="Bound">x</a><a id="1459" class="Symbol">)</a> <a id="1461" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a> <a id="1464" href="Polynomial.Simple.Reflection.html#759" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="1468" href="Polynomial.Simple.Reflection.html#1324" class="Function">go</a> <a id="1471" class="Symbol">(</a><a id="1472" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="1476" class="Symbol">(</a><a id="1477" href="Polynomial.Simple.Reflection.html#1398" class="Bound">k</a> <a id="1479" href="Agda.Builtin.Nat.html#230" class="Primitive Operator">ℕ.+</a> <a id="1483" href="Polynomial.Simple.Reflection.html#1401" class="Bound">x</a><a id="1484" class="Symbol">))</a> <a id="1487" href="Polynomial.Simple.Reflection.html#1405" class="Bound">xs</a> <a id="1490" href="Polynomial.Simple.Reflection.html#759" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="1494" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>

  <a id="Internal.hlams"></a><a id="1500" href="Polynomial.Simple.Reflection.html#1500" class="Function">hlams</a> <a id="1506" class="Symbol">:</a> <a id="1508" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="1513" href="Agda.Builtin.String.html#165" class="Postulate">String</a> <a id="1520" class="Symbol">→</a> <a id="1522" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="1527" class="Symbol">→</a> <a id="1529" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
  <a id="1536" href="Polynomial.Simple.Reflection.html#1500" class="Function">hlams</a> <a id="1542" href="Polynomial.Simple.Reflection.html#1542" class="Bound">vs</a> <a id="1545" href="Polynomial.Simple.Reflection.html#1545" class="Bound">xs</a> <a id="1548" class="Symbol">=</a> <a id="1550" href="Data.List.Base.html#3600" class="Function">foldr</a> <a id="1556" class="Symbol">(λ</a> <a id="1559" href="Polynomial.Simple.Reflection.html#1559" class="Bound">v</a> <a id="1561" href="Polynomial.Simple.Reflection.html#1561" class="Bound">vs</a> <a id="1564" class="Symbol">→</a> <a id="1566" href="Agda.Builtin.Reflection.html#4762" class="InductiveConstructor">lam</a> <a id="1570" href="Agda.Builtin.Reflection.html#2557" class="InductiveConstructor">hidden</a> <a id="1577" class="Symbol">(</a><a id="1578" href="Agda.Builtin.Reflection.html#3308" class="InductiveConstructor">abs</a> <a id="1582" href="Polynomial.Simple.Reflection.html#1559" class="Bound">v</a> <a id="1584" href="Polynomial.Simple.Reflection.html#1561" class="Bound">vs</a><a id="1586" class="Symbol">))</a> <a id="1589" href="Polynomial.Simple.Reflection.html#1545" class="Bound">xs</a> <a id="1592" href="Polynomial.Simple.Reflection.html#1542" class="Bound">vs</a>

  <a id="Internal.vlams"></a><a id="1598" href="Polynomial.Simple.Reflection.html#1598" class="Function">vlams</a> <a id="1604" class="Symbol">:</a> <a id="1606" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="1611" href="Agda.Builtin.String.html#165" class="Postulate">String</a> <a id="1618" class="Symbol">→</a> <a id="1620" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="1625" class="Symbol">→</a> <a id="1627" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
  <a id="1634" href="Polynomial.Simple.Reflection.html#1598" class="Function">vlams</a> <a id="1640" href="Polynomial.Simple.Reflection.html#1640" class="Bound">vs</a> <a id="1643" href="Polynomial.Simple.Reflection.html#1643" class="Bound">xs</a> <a id="1646" class="Symbol">=</a> <a id="1648" href="Data.List.Base.html#3600" class="Function">foldr</a> <a id="1654" class="Symbol">(λ</a> <a id="1657" href="Polynomial.Simple.Reflection.html#1657" class="Bound">v</a> <a id="1659" href="Polynomial.Simple.Reflection.html#1659" class="Bound">vs</a> <a id="1662" class="Symbol">→</a> <a id="1664" href="Agda.Builtin.Reflection.html#4762" class="InductiveConstructor">lam</a> <a id="1668" href="Agda.Builtin.Reflection.html#2549" class="InductiveConstructor">visible</a> <a id="1676" class="Symbol">(</a><a id="1677" href="Agda.Builtin.Reflection.html#3308" class="InductiveConstructor">abs</a> <a id="1681" href="Polynomial.Simple.Reflection.html#1657" class="Bound">v</a> <a id="1683" href="Polynomial.Simple.Reflection.html#1659" class="Bound">vs</a><a id="1685" class="Symbol">))</a> <a id="1688" href="Polynomial.Simple.Reflection.html#1643" class="Bound">xs</a> <a id="1691" href="Polynomial.Simple.Reflection.html#1640" class="Bound">vs</a>

  <a id="1697" class="Keyword">module</a> <a id="1704" href="Polynomial.Simple.Reflection.html#1704" class="Module">_</a> <a id="1706" class="Symbol">(</a><a id="1707" href="Polynomial.Simple.Reflection.html#1707" class="Bound">numVars</a> <a id="1715" class="Symbol">:</a> <a id="1717" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a><a id="1718" class="Symbol">)</a> <a id="1720" class="Keyword">where</a>

    <a id="1731" class="Comment">-- This function applies the hidden arguments that the constructors</a>
    <a id="1803" class="Comment">-- that Expr needs. The first is the universe level, the second is the</a>
    <a id="1878" class="Comment">-- type it contains, and the third is the number of variables it&#39;s</a>
    <a id="1949" class="Comment">-- indexed by. All three of these could likely be inferred, but to</a>
    <a id="2020" class="Comment">-- make things easier we supply the third because we know it.</a>
    <a id="2086" class="Keyword">infixr</a> <a id="2093" class="Number">5</a> <a id="2095" href="Polynomial.Simple.Reflection.html#2105" class="Function Operator">E⟅∷⟆_</a>
    <a id="2105" href="Polynomial.Simple.Reflection.html#2105" class="Function Operator">E⟅∷⟆_</a> <a id="2111" class="Symbol">:</a> <a id="2113" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="2118" class="Symbol">(</a><a id="2119" href="Agda.Builtin.Reflection.html#3041" class="Datatype">Arg</a> <a id="2123" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a><a id="2127" class="Symbol">)</a> <a id="2129" class="Symbol">→</a> <a id="2131" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="2136" class="Symbol">(</a><a id="2137" href="Agda.Builtin.Reflection.html#3041" class="Datatype">Arg</a> <a id="2141" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a><a id="2145" class="Symbol">)</a>
    <a id="2151" href="Polynomial.Simple.Reflection.html#2105" class="Function Operator">E⟅∷⟆</a> <a id="2156" href="Polynomial.Simple.Reflection.html#2156" class="Bound">xs</a> <a id="2159" class="Symbol">=</a> <a id="2161" class="Number">1</a> <a id="2163" href="Polynomial.Simple.Reflection.html#893" class="Function Operator">⋯⟅∷⟆</a>
              <a id="2182" class="Symbol">(</a><a id="2183" class="Keyword">quote</a> <a id="2189" href="Polynomial.Simple.AlmostCommutativeRing.html#1079" class="Field">AlmostCommutativeRing.Carrier</a> <a id="2219" href="Function.html#2548" class="Function Operator">⟨</a> <a id="2221" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="2225" href="Function.html#2548" class="Function Operator">⟩</a> <a id="2227" class="Number">2</a> <a id="2229" href="Polynomial.Simple.Reflection.html#893" class="Function Operator">⋯⟅∷⟆</a> <a id="2234" href="Polynomial.Simple.Reflection.html#379" class="Bound">rng</a> <a id="2238" href="Polynomial.Simple.Reflection.html#759" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="2242" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="2244" class="Symbol">)</a> <a id="2246" href="Polynomial.Simple.Reflection.html#821" class="InductiveConstructor Operator">⟅∷⟆</a>
              <a id="2264" href="Polynomial.Simple.Reflection.html#1005" class="Function">natTerm</a> <a id="2272" href="Polynomial.Simple.Reflection.html#1707" class="Bound">numVars</a> <a id="2280" href="Polynomial.Simple.Reflection.html#821" class="InductiveConstructor Operator">⟅∷⟆</a>
              <a id="2298" href="Polynomial.Simple.Reflection.html#2156" class="Bound">xs</a>

    <a id="2306" class="Comment">-- A constant expression.</a>
    <a id="2336" href="Polynomial.Simple.Reflection.html#2336" class="Function">constExpr</a> <a id="2346" class="Symbol">:</a> <a id="2348" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="2353" class="Symbol">→</a> <a id="2355" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
    <a id="2364" href="Polynomial.Simple.Reflection.html#2336" class="Function">constExpr</a> <a id="2374" href="Polynomial.Simple.Reflection.html#2374" class="Bound">x</a> <a id="2376" class="Symbol">=</a> <a id="2378" class="Keyword">quote</a> <a id="2384" href="Polynomial.Expr.html#290" class="InductiveConstructor">Κ</a> <a id="2386" href="Function.html#2548" class="Function Operator">⟨</a> <a id="2388" href="Agda.Builtin.Reflection.html#4648" class="InductiveConstructor">con</a> <a id="2392" href="Function.html#2548" class="Function Operator">⟩</a> <a id="2394" href="Polynomial.Simple.Reflection.html#2105" class="Function Operator">E⟅∷⟆</a> <a id="2399" href="Polynomial.Simple.Reflection.html#2374" class="Bound">x</a> <a id="2401" href="Polynomial.Simple.Reflection.html#759" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="2405" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>

    <a id="2413" class="Keyword">module</a> <a id="ToExpr"></a><a id="2420" href="Polynomial.Simple.Reflection.html#2420" class="Module">ToExpr</a> <a id="2427" class="Symbol">(</a><a id="2428" href="Polynomial.Simple.Reflection.html#2428" class="Bound">varExpr</a> <a id="2436" class="Symbol">:</a> <a id="2438" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="2440" class="Symbol">→</a> <a id="2442" href="Data.Maybe.Base.html#710" class="Datatype">Maybe</a> <a id="2448" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a><a id="2452" class="Symbol">)</a> <a id="2454" class="Keyword">where</a>
      <a id="2466" class="Keyword">mutual</a>
        <a id="2481" class="Comment">-- Application of a ring operator often doesn&#39;t have a type as</a>
        <a id="2552" class="Comment">-- simple as &quot;Carrier → Carrier → Carrier&quot;: there may be hidden</a>
        <a id="2624" class="Comment">-- arguments, etc. Here, we do our best to handle those cases,</a>
        <a id="2695" class="Comment">-- by just taking the last two explicit arguments.</a>
        <a id="2754" href="Polynomial.Simple.Reflection.html#2754" class="Function">getBinOp</a> <a id="2763" class="Symbol">:</a> <a id="2765" href="Agda.Builtin.Reflection.html#363" class="Postulate">Name</a> <a id="2770" class="Symbol">→</a> <a id="2772" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="2777" class="Symbol">(</a><a id="2778" href="Agda.Builtin.Reflection.html#3041" class="Datatype">Arg</a> <a id="2782" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a><a id="2786" class="Symbol">)</a> <a id="2788" class="Symbol">→</a> <a id="2790" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
        <a id="2803" href="Polynomial.Simple.Reflection.html#2754" class="Function">getBinOp</a> <a id="2812" href="Polynomial.Simple.Reflection.html#2812" class="Bound">nm</a> <a id="2815" class="Symbol">(</a><a id="2816" href="Polynomial.Simple.Reflection.html#2816" class="Bound">x</a> <a id="2818" href="Polynomial.Simple.Reflection.html#759" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="2822" href="Polynomial.Simple.Reflection.html#2822" class="Bound">y</a> <a id="2824" href="Polynomial.Simple.Reflection.html#759" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="2828" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="2830" class="Symbol">)</a> <a id="2832" class="Symbol">=</a> <a id="2834" href="Polynomial.Simple.Reflection.html#2812" class="Bound">nm</a> <a id="2837" href="Function.html#2548" class="Function Operator">⟨</a> <a id="2839" href="Agda.Builtin.Reflection.html#4648" class="InductiveConstructor">con</a> <a id="2843" href="Function.html#2548" class="Function Operator">⟩</a> <a id="2845" href="Polynomial.Simple.Reflection.html#2105" class="Function Operator">E⟅∷⟆</a> <a id="2850" href="Polynomial.Simple.Reflection.html#4033" class="Function">toExpr</a> <a id="2857" href="Polynomial.Simple.Reflection.html#2816" class="Bound">x</a> <a id="2859" href="Polynomial.Simple.Reflection.html#759" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="2863" href="Polynomial.Simple.Reflection.html#4033" class="Function">toExpr</a> <a id="2870" href="Polynomial.Simple.Reflection.html#2822" class="Bound">y</a> <a id="2872" href="Polynomial.Simple.Reflection.html#759" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="2876" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>
        <a id="2887" href="Polynomial.Simple.Reflection.html#2754" class="CatchallClause Function">getBinOp</a><a id="2895" class="CatchallClause"> </a><a id="2896" href="Polynomial.Simple.Reflection.html#2896" class="CatchallClause Bound">nm</a><a id="2898" class="CatchallClause"> </a><a id="2899" class="CatchallClause Symbol">(</a><a id="2900" href="Polynomial.Simple.Reflection.html#2900" class="CatchallClause Bound">x</a><a id="2901" class="CatchallClause"> </a><a id="2902" href="Agda.Builtin.List.html#132" class="CatchallClause InductiveConstructor Operator">∷</a><a id="2903" class="CatchallClause"> </a><a id="2904" href="Polynomial.Simple.Reflection.html#2904" class="CatchallClause Bound">xs</a><a id="2906" class="CatchallClause Symbol">)</a> <a id="2908" class="Symbol">=</a> <a id="2910" href="Polynomial.Simple.Reflection.html#2754" class="Function">getBinOp</a> <a id="2919" href="Polynomial.Simple.Reflection.html#2896" class="Bound">nm</a> <a id="2922" href="Polynomial.Simple.Reflection.html#2904" class="Bound">xs</a>
        <a id="2933" href="Polynomial.Simple.Reflection.html#2754" class="CatchallClause Function">getBinOp</a><a id="2941" class="CatchallClause"> </a><a id="2942" class="CatchallClause Symbol">_</a><a id="2943" class="CatchallClause"> </a><a id="2944" class="CatchallClause Symbol">_</a> <a id="2946" class="Symbol">=</a> <a id="2948" href="Agda.Builtin.Reflection.html#5048" class="InductiveConstructor">unknown</a>

        <a id="2965" href="Polynomial.Simple.Reflection.html#2965" class="Function">getUnOp</a> <a id="2973" class="Symbol">:</a> <a id="2975" href="Agda.Builtin.Reflection.html#363" class="Postulate">Name</a> <a id="2980" class="Symbol">→</a> <a id="2982" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="2987" class="Symbol">(</a><a id="2988" href="Agda.Builtin.Reflection.html#3041" class="Datatype">Arg</a> <a id="2992" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a><a id="2996" class="Symbol">)</a> <a id="2998" class="Symbol">→</a> <a id="3000" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
        <a id="3013" href="Polynomial.Simple.Reflection.html#2965" class="Function">getUnOp</a> <a id="3021" href="Polynomial.Simple.Reflection.html#3021" class="Bound">nm</a> <a id="3024" class="Symbol">(</a><a id="3025" href="Polynomial.Simple.Reflection.html#3025" class="Bound">x</a> <a id="3027" href="Polynomial.Simple.Reflection.html#759" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="3031" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="3033" class="Symbol">)</a> <a id="3035" class="Symbol">=</a> <a id="3037" href="Polynomial.Simple.Reflection.html#3021" class="Bound">nm</a> <a id="3040" href="Function.html#2548" class="Function Operator">⟨</a> <a id="3042" href="Agda.Builtin.Reflection.html#4648" class="InductiveConstructor">con</a> <a id="3046" href="Function.html#2548" class="Function Operator">⟩</a> <a id="3048" href="Polynomial.Simple.Reflection.html#2105" class="Function Operator">E⟅∷⟆</a> <a id="3053" href="Polynomial.Simple.Reflection.html#4033" class="Function">toExpr</a> <a id="3060" href="Polynomial.Simple.Reflection.html#3025" class="Bound">x</a> <a id="3062" href="Polynomial.Simple.Reflection.html#759" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="3066" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>
        <a id="3077" href="Polynomial.Simple.Reflection.html#2965" class="CatchallClause Function">getUnOp</a><a id="3084" class="CatchallClause"> </a><a id="3085" href="Polynomial.Simple.Reflection.html#3085" class="CatchallClause Bound">nm</a><a id="3087" class="CatchallClause"> </a><a id="3088" class="CatchallClause Symbol">(</a><a id="3089" href="Polynomial.Simple.Reflection.html#3089" class="CatchallClause Bound">x</a><a id="3090" class="CatchallClause"> </a><a id="3091" href="Agda.Builtin.List.html#132" class="CatchallClause InductiveConstructor Operator">∷</a><a id="3092" class="CatchallClause"> </a><a id="3093" href="Polynomial.Simple.Reflection.html#3093" class="CatchallClause Bound">xs</a><a id="3095" class="CatchallClause Symbol">)</a> <a id="3097" class="Symbol">=</a> <a id="3099" href="Polynomial.Simple.Reflection.html#2965" class="Function">getUnOp</a> <a id="3107" href="Polynomial.Simple.Reflection.html#3085" class="Bound">nm</a> <a id="3110" href="Polynomial.Simple.Reflection.html#3093" class="Bound">xs</a>
        <a id="3121" href="Polynomial.Simple.Reflection.html#2965" class="CatchallClause Function">getUnOp</a><a id="3128" class="CatchallClause"> </a><a id="3129" class="CatchallClause Symbol">_</a><a id="3130" class="CatchallClause"> </a><a id="3131" class="CatchallClause Symbol">_</a> <a id="3133" class="Symbol">=</a> <a id="3135" href="Agda.Builtin.Reflection.html#5048" class="InductiveConstructor">unknown</a>

        <a id="3152" href="Polynomial.Simple.Reflection.html#3152" class="Function">getExp</a> <a id="3159" class="Symbol">:</a> <a id="3161" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="3166" class="Symbol">(</a><a id="3167" href="Agda.Builtin.Reflection.html#3041" class="Datatype">Arg</a> <a id="3171" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a><a id="3175" class="Symbol">)</a> <a id="3177" class="Symbol">→</a> <a id="3179" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
        <a id="3192" href="Polynomial.Simple.Reflection.html#3152" class="Function">getExp</a> <a id="3199" class="Symbol">(</a><a id="3200" href="Polynomial.Simple.Reflection.html#3200" class="Bound">x</a> <a id="3202" href="Polynomial.Simple.Reflection.html#759" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="3206" href="Polynomial.Simple.Reflection.html#3206" class="Bound">y</a> <a id="3208" href="Polynomial.Simple.Reflection.html#759" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="3212" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="3214" class="Symbol">)</a> <a id="3216" class="Symbol">=</a> <a id="3218" class="Keyword">quote</a> <a id="3224" href="Polynomial.Expr.html#414" class="InductiveConstructor Operator">_⊛_</a> <a id="3228" href="Function.html#2548" class="Function Operator">⟨</a> <a id="3230" href="Agda.Builtin.Reflection.html#4648" class="InductiveConstructor">con</a> <a id="3234" href="Function.html#2548" class="Function Operator">⟩</a> <a id="3236" href="Polynomial.Simple.Reflection.html#2105" class="Function Operator">E⟅∷⟆</a> <a id="3241" href="Polynomial.Simple.Reflection.html#4033" class="Function">toExpr</a> <a id="3248" href="Polynomial.Simple.Reflection.html#3200" class="Bound">x</a> <a id="3250" href="Polynomial.Simple.Reflection.html#759" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="3254" href="Polynomial.Simple.Reflection.html#3206" class="Bound">y</a> <a id="3256" href="Polynomial.Simple.Reflection.html#759" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="3260" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>
        <a id="3271" href="Polynomial.Simple.Reflection.html#3152" class="CatchallClause Function">getExp</a><a id="3277" class="CatchallClause"> </a><a id="3278" class="CatchallClause Symbol">(</a><a id="3279" href="Polynomial.Simple.Reflection.html#3279" class="CatchallClause Bound">x</a><a id="3280" class="CatchallClause"> </a><a id="3281" href="Agda.Builtin.List.html#132" class="CatchallClause InductiveConstructor Operator">∷</a><a id="3282" class="CatchallClause"> </a><a id="3283" href="Polynomial.Simple.Reflection.html#3283" class="CatchallClause Bound">xs</a><a id="3285" class="CatchallClause Symbol">)</a> <a id="3287" class="Symbol">=</a> <a id="3289" href="Polynomial.Simple.Reflection.html#3152" class="Function">getExp</a> <a id="3296" href="Polynomial.Simple.Reflection.html#3283" class="Bound">xs</a>
        <a id="3307" href="Polynomial.Simple.Reflection.html#3152" class="CatchallClause Function">getExp</a><a id="3313" class="CatchallClause"> </a><a id="3314" class="CatchallClause Symbol">_</a> <a id="3316" class="Symbol">=</a> <a id="3318" href="Agda.Builtin.Reflection.html#5048" class="InductiveConstructor">unknown</a>

        <a id="3335" class="Comment">-- When trying to figure out the shape of an expression, one of</a>
        <a id="3407" class="Comment">-- the difficult tasks is recognizing where constants in the</a>
        <a id="3476" class="Comment">-- underlying ring are used. If we were only dealing with ℕ, we</a>
        <a id="3548" class="Comment">-- might look for its constructors: however, we want to deal with</a>
        <a id="3622" class="Comment">-- arbitrary types which implement AlmostCommutativeRing. If the</a>
        <a id="3695" class="Comment">-- Term type contained type information we might be able to</a>
        <a id="3763" class="Comment">-- recognize it there, but it doesn&#39;t.</a>
        <a id="3810" class="Comment">--</a>
        <a id="3821" class="Comment">-- We&#39;re in luck, though, because all other cases in the following</a>
        <a id="3896" class="Comment">-- function *are* recognizable. As a result, the &quot;catch-all&quot; case</a>
        <a id="3970" class="Comment">-- will just assume that it has a constant expression.</a>
        <a id="4033" href="Polynomial.Simple.Reflection.html#4033" class="Function">toExpr</a> <a id="4040" class="Symbol">:</a> <a id="4042" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="4047" class="Symbol">→</a> <a id="4049" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
        <a id="4062" href="Polynomial.Simple.Reflection.html#4033" class="Function">toExpr</a> <a id="4069" class="Symbol">(</a><a id="4070" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="4074" class="Symbol">(</a><a id="4075" class="Keyword">quote</a> <a id="4081" href="Polynomial.Simple.AlmostCommutativeRing.html#1159" class="Field Operator">AlmostCommutativeRing._+_</a><a id="4106" class="Symbol">)</a> <a id="4108" href="Polynomial.Simple.Reflection.html#4108" class="Bound">xs</a><a id="4110" class="Symbol">)</a> <a id="4112" class="Symbol">=</a> <a id="4114" href="Polynomial.Simple.Reflection.html#2754" class="Function">getBinOp</a> <a id="4123" class="Symbol">(</a><a id="4124" class="Keyword">quote</a> <a id="4130" href="Polynomial.Expr.html#336" class="InductiveConstructor Operator">_⊕_</a><a id="4133" class="Symbol">)</a> <a id="4135" href="Polynomial.Simple.Reflection.html#4108" class="Bound">xs</a>
        <a id="4146" href="Polynomial.Simple.Reflection.html#4033" class="Function">toExpr</a> <a id="4153" class="Symbol">(</a><a id="4154" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="4158" class="Symbol">(</a><a id="4159" class="Keyword">quote</a> <a id="4165" href="Polynomial.Simple.AlmostCommutativeRing.html#1201" class="Field Operator">AlmostCommutativeRing._*_</a><a id="4190" class="Symbol">)</a> <a id="4192" href="Polynomial.Simple.Reflection.html#4192" class="Bound">xs</a><a id="4194" class="Symbol">)</a> <a id="4196" class="Symbol">=</a> <a id="4198" href="Polynomial.Simple.Reflection.html#2754" class="Function">getBinOp</a> <a id="4207" class="Symbol">(</a><a id="4208" class="Keyword">quote</a> <a id="4214" href="Polynomial.Expr.html#375" class="InductiveConstructor Operator">_⊗_</a><a id="4217" class="Symbol">)</a> <a id="4219" href="Polynomial.Simple.Reflection.html#4192" class="Bound">xs</a>
        <a id="4230" href="Polynomial.Simple.Reflection.html#4033" class="Function">toExpr</a> <a id="4237" class="Symbol">(</a><a id="4238" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="4242" class="Symbol">(</a><a id="4243" class="Keyword">quote</a> <a id="4249" href="Polynomial.Simple.AlmostCommutativeRing.html#2094" class="Function Operator">AlmostCommutativeRing._^_</a><a id="4274" class="Symbol">)</a> <a id="4276" href="Polynomial.Simple.Reflection.html#4276" class="Bound">xs</a><a id="4278" class="Symbol">)</a> <a id="4280" class="Symbol">=</a> <a id="4282" href="Polynomial.Simple.Reflection.html#3152" class="Function">getExp</a> <a id="4289" href="Polynomial.Simple.Reflection.html#4276" class="Bound">xs</a>
        <a id="4300" href="Polynomial.Simple.Reflection.html#4033" class="Function">toExpr</a> <a id="4307" class="Symbol">(</a><a id="4308" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="4312" class="Symbol">(</a><a id="4313" class="Keyword">quote</a> <a id="4319" href="Polynomial.Simple.AlmostCommutativeRing.html#1243" class="Field Operator">AlmostCommutativeRing.-_</a><a id="4343" class="Symbol">)</a> <a id="4345" href="Polynomial.Simple.Reflection.html#4345" class="Bound">xs</a><a id="4347" class="Symbol">)</a> <a id="4349" class="Symbol">=</a> <a id="4351" href="Polynomial.Simple.Reflection.html#2965" class="Function">getUnOp</a> <a id="4359" class="Symbol">(</a><a id="4360" class="Keyword">quote</a> <a id="4366" href="Polynomial.Expr.html#446" class="InductiveConstructor Operator">⊝_</a><a id="4368" class="Symbol">)</a> <a id="4370" href="Polynomial.Simple.Reflection.html#4345" class="Bound">xs</a>
        <a id="4381" href="Polynomial.Simple.Reflection.html#4033" class="Function">toExpr</a> <a id="4388" href="Polynomial.Simple.Reflection.html#4388" class="Bound">v</a><a id="4389" class="Symbol">@(</a><a id="4391" href="Agda.Builtin.Reflection.html#4592" class="InductiveConstructor">var</a> <a id="4395" href="Polynomial.Simple.Reflection.html#4395" class="Bound">x</a> <a id="4397" class="Symbol">_)</a> <a id="4400" class="Symbol">=</a> <a id="4402" href="Data.Maybe.Base.html#1730" class="Function">Maybe.fromMaybe</a> <a id="4418" class="Symbol">(</a><a id="4419" href="Polynomial.Simple.Reflection.html#2336" class="Function">constExpr</a> <a id="4429" href="Polynomial.Simple.Reflection.html#4388" class="Bound">v</a><a id="4430" class="Symbol">)</a> <a id="4432" class="Symbol">(</a><a id="4433" href="Polynomial.Simple.Reflection.html#2428" class="Bound">varExpr</a> <a id="4441" href="Polynomial.Simple.Reflection.html#4395" class="Bound">x</a><a id="4442" class="Symbol">)</a>
        <a id="4452" href="Polynomial.Simple.Reflection.html#4033" class="CatchallClause Function">toExpr</a><a id="4458" class="CatchallClause"> </a><a id="4459" href="Polynomial.Simple.Reflection.html#4459" class="CatchallClause Bound">t</a> <a id="4461" class="Symbol">=</a> <a id="4463" href="Polynomial.Simple.Reflection.html#2336" class="Function">constExpr</a> <a id="4473" href="Polynomial.Simple.Reflection.html#4459" class="Bound">t</a>

    <a id="4480" href="Polynomial.Simple.Reflection.html#4480" class="Function">mkSolver</a> <a id="4489" class="Symbol">:</a> <a id="4491" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="4496" href="Agda.Builtin.String.html#165" class="Postulate">String</a> <a id="4503" class="Symbol">→</a> <a id="4505" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="4510" class="Symbol">→</a> <a id="4512" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="4517" class="Symbol">→</a> <a id="4519" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="4524" class="Symbol">(</a><a id="4525" href="Agda.Builtin.Reflection.html#3041" class="Datatype">Arg</a> <a id="4529" href="Agda.Builtin.Reflection.html#4561" class="Function">Type</a><a id="4533" class="Symbol">)</a>
    <a id="4539" href="Polynomial.Simple.Reflection.html#4480" class="Function">mkSolver</a> <a id="4548" href="Polynomial.Simple.Reflection.html#4548" class="Bound">nms</a> <a id="4552" href="Polynomial.Simple.Reflection.html#4552" class="Bound">lhs</a> <a id="4556" href="Polynomial.Simple.Reflection.html#4556" class="Bound">rhs</a> <a id="4560" class="Symbol">=</a>
        <a id="4570" class="Number">2</a> <a id="4572" href="Polynomial.Simple.Reflection.html#893" class="Function Operator">⋯⟅∷⟆</a>
        <a id="4585" href="Polynomial.Simple.Reflection.html#379" class="Bound">rng</a> <a id="4589" href="Polynomial.Simple.Reflection.html#759" class="InductiveConstructor Operator">⟨∷⟩</a>
        <a id="4601" href="Polynomial.Simple.Reflection.html#1005" class="Function">natTerm</a> <a id="4609" href="Polynomial.Simple.Reflection.html#1707" class="Bound">numVars</a> <a id="4617" href="Polynomial.Simple.Reflection.html#759" class="InductiveConstructor Operator">⟨∷⟩</a>
        <a id="4629" href="Polynomial.Simple.Reflection.html#1598" class="Function">vlams</a> <a id="4635" href="Polynomial.Simple.Reflection.html#4548" class="Bound">nms</a> <a id="4639" class="Symbol">(</a><a id="4640" class="Keyword">quote</a> <a id="4646" href="Polynomial.Simple.Solver.html#3481" class="Function Operator">_⊜_</a> <a id="4650" href="Function.html#2548" class="Function Operator">⟨</a> <a id="4652" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="4656" href="Function.html#2548" class="Function Operator">⟩</a> <a id="4658" class="Number">2</a> <a id="4660" href="Polynomial.Simple.Reflection.html#893" class="Function Operator">⋯⟅∷⟆</a> <a id="4665" href="Polynomial.Simple.Reflection.html#379" class="Bound">rng</a> <a id="4669" href="Polynomial.Simple.Reflection.html#759" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="4673" href="Polynomial.Simple.Reflection.html#1005" class="Function">natTerm</a> <a id="4681" href="Polynomial.Simple.Reflection.html#1707" class="Bound">numVars</a> <a id="4689" href="Polynomial.Simple.Reflection.html#759" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="4693" href="Polynomial.Simple.Reflection.html#4033" class="Function">toExpr</a> <a id="4700" href="Polynomial.Simple.Reflection.html#4552" class="Bound">lhs</a> <a id="4704" href="Polynomial.Simple.Reflection.html#759" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="4708" href="Polynomial.Simple.Reflection.html#4033" class="Function">toExpr</a> <a id="4715" href="Polynomial.Simple.Reflection.html#4556" class="Bound">rhs</a> <a id="4719" href="Polynomial.Simple.Reflection.html#759" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="4723" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="4725" class="Symbol">)</a> <a id="4727" href="Polynomial.Simple.Reflection.html#759" class="InductiveConstructor Operator">⟨∷⟩</a>
        <a id="4739" href="Polynomial.Simple.Reflection.html#1500" class="Function">hlams</a> <a id="4745" href="Polynomial.Simple.Reflection.html#4548" class="Bound">nms</a> <a id="4749" class="Symbol">(</a><a id="4750" class="Keyword">quote</a> <a id="4756" href="Polynomial.Simple.AlmostCommutativeRing.html#2172" class="Function">AlmostCommutativeRing.refl</a> <a id="4783" href="Function.html#2548" class="Function Operator">⟨</a> <a id="4785" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="4789" href="Function.html#2548" class="Function Operator">⟩</a> <a id="4791" class="Number">2</a> <a id="4793" href="Polynomial.Simple.Reflection.html#893" class="Function Operator">⋯⟅∷⟆</a> <a id="4798" href="Polynomial.Simple.Reflection.html#379" class="Bound">rng</a> <a id="4802" href="Polynomial.Simple.Reflection.html#759" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="4806" class="Number">1</a> <a id="4808" href="Polynomial.Simple.Reflection.html#893" class="Function Operator">⋯⟅∷⟆</a> <a id="4813" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="4815" class="Symbol">)</a> <a id="4817" href="Polynomial.Simple.Reflection.html#759" class="InductiveConstructor Operator">⟨∷⟩</a>
        <a id="4829" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>
      <a id="4838" class="Keyword">where</a>
      <a id="4850" href="Polynomial.Simple.Reflection.html#4850" class="Function">varExpr</a> <a id="4858" class="Symbol">:</a> <a id="4860" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="4862" class="Symbol">→</a> <a id="4864" href="Data.Maybe.Base.html#710" class="Datatype">Maybe</a> <a id="4870" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
      <a id="4881" href="Polynomial.Simple.Reflection.html#4850" class="Function">varExpr</a> <a id="4889" href="Polynomial.Simple.Reflection.html#4889" class="Bound">i</a> <a id="4891" class="Keyword">with</a> <a id="4896" href="Polynomial.Simple.Reflection.html#4889" class="Bound">i</a> <a id="4898" href="Data.Nat.Properties.html#5343" class="Function Operator">ℕ.&lt;?</a> <a id="4903" href="Polynomial.Simple.Reflection.html#1707" class="Bound">numVars</a>
      <a id="4917" class="Symbol">...</a> <a id="4921" class="Symbol">|</a> <a id="4923" href="Relation.Nullary.html#606" class="InductiveConstructor">yes</a> <a id="4927" class="Symbol">_</a> <a id="4929" class="Symbol">=</a> <a id="4931" href="Data.Maybe.Base.html#748" class="InductiveConstructor">just</a> <a id="4936" class="Symbol">(</a><a id="4937" href="Agda.Builtin.Reflection.html#4592" class="InductiveConstructor">var</a> <a id="4941" class="Bound">i</a> <a id="4943" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="4945" class="Symbol">)</a>
      <a id="4953" class="Symbol">...</a> <a id="4957" class="Symbol">|</a> <a id="4959" href="Relation.Nullary.html#633" class="InductiveConstructor">no</a> <a id="4962" class="Symbol">_</a> <a id="4964" class="Symbol">=</a> <a id="4966" href="Data.Maybe.Base.html#778" class="InductiveConstructor">nothing</a>
      <a id="4980" class="Keyword">open</a> <a id="4985" href="Polynomial.Simple.Reflection.html#2420" class="Module">ToExpr</a> <a id="4992" href="Polynomial.Simple.Reflection.html#4850" class="Function">varExpr</a>

    <a id="5005" href="Polynomial.Simple.Reflection.html#5005" class="Function">mkSolver′</a> <a id="5015" class="Symbol">:</a> <a id="5017" href="Data.Nat.Table.html#425" class="Function">Table</a> <a id="5023" class="Symbol">→</a> <a id="5025" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="5030" class="Symbol">→</a> <a id="5032" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="5037" class="Symbol">→</a> <a id="5039" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
    <a id="5048" href="Polynomial.Simple.Reflection.html#5005" class="Function">mkSolver′</a> <a id="5058" href="Polynomial.Simple.Reflection.html#5058" class="Bound">t</a> <a id="5060" href="Polynomial.Simple.Reflection.html#5060" class="Bound">lhs</a> <a id="5064" href="Polynomial.Simple.Reflection.html#5064" class="Bound">rhs</a> <a id="5068" class="Symbol">=</a>
      <a id="5076" class="Keyword">quote</a> <a id="5082" href="Relation.Binary.Core.html#5860" class="Function">AlmostCommutativeRing.trans</a> <a id="5110" href="Function.html#2548" class="Function Operator">⟨</a> <a id="5112" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="5116" href="Function.html#2548" class="Function Operator">⟩</a>
        <a id="5126" class="Number">2</a> <a id="5128" href="Polynomial.Simple.Reflection.html#893" class="Function Operator">⋯⟅∷⟆</a>
        <a id="5141" href="Polynomial.Simple.Reflection.html#379" class="Bound">rng</a> <a id="5145" href="Polynomial.Simple.Reflection.html#759" class="InductiveConstructor Operator">⟨∷⟩</a>
        <a id="5157" class="Number">3</a> <a id="5159" href="Polynomial.Simple.Reflection.html#893" class="Function Operator">⋯⟅∷⟆</a>
        <a id="5172" class="Symbol">(</a><a id="5173" class="Keyword">quote</a> <a id="5179" href="Relation.Binary.Core.html#5834" class="Function">AlmostCommutativeRing.sym</a> <a id="5205" href="Function.html#2548" class="Function Operator">⟨</a> <a id="5207" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="5211" href="Function.html#2548" class="Function Operator">⟩</a>
            <a id="5225" class="Symbol">(</a><a id="5226" class="Number">2</a> <a id="5228" href="Polynomial.Simple.Reflection.html#893" class="Function Operator">⋯⟅∷⟆</a>
            <a id="5245" href="Polynomial.Simple.Reflection.html#379" class="Bound">rng</a> <a id="5249" href="Polynomial.Simple.Reflection.html#759" class="InductiveConstructor Operator">⟨∷⟩</a>
            <a id="5265" class="Number">2</a> <a id="5267" href="Polynomial.Simple.Reflection.html#893" class="Function Operator">⋯⟅∷⟆</a>
            <a id="5284" class="Symbol">(</a><a id="5285" class="Keyword">quote</a> <a id="5291" href="Polynomial.Simple.Solver.html#2124" class="Function">Ops.correct</a> <a id="5303" href="Function.html#2548" class="Function Operator">⟨</a> <a id="5305" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="5309" href="Function.html#2548" class="Function Operator">⟩</a> <a id="5311" class="Number">2</a> <a id="5313" href="Polynomial.Simple.Reflection.html#893" class="Function Operator">⋯⟅∷⟆</a> <a id="5318" href="Polynomial.Simple.Reflection.html#379" class="Bound">rng</a> <a id="5322" href="Polynomial.Simple.Reflection.html#759" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="5326" class="Number">1</a> <a id="5328" href="Polynomial.Simple.Reflection.html#893" class="Function Operator">⋯⟅∷⟆</a> <a id="5333" href="Polynomial.Simple.Reflection.html#4033" class="Function">toExpr</a> <a id="5340" href="Polynomial.Simple.Reflection.html#5060" class="Bound">lhs</a> <a id="5344" href="Polynomial.Simple.Reflection.html#759" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="5348" href="Polynomial.Simple.Reflection.html#5651" class="Function">ρ</a> <a id="5350" href="Polynomial.Simple.Reflection.html#759" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="5354" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="5356" class="Symbol">)</a> <a id="5358" href="Polynomial.Simple.Reflection.html#759" class="InductiveConstructor Operator">⟨∷⟩</a>
            <a id="5374" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="5376" class="Symbol">))</a>
        <a id="5387" href="Polynomial.Simple.Reflection.html#759" class="InductiveConstructor Operator">⟨∷⟩</a>
        <a id="5399" class="Symbol">(</a><a id="5400" class="Keyword">quote</a> <a id="5406" href="Polynomial.Simple.Solver.html#2124" class="Function">Ops.correct</a> <a id="5418" href="Function.html#2548" class="Function Operator">⟨</a> <a id="5420" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="5424" href="Function.html#2548" class="Function Operator">⟩</a> <a id="5426" class="Number">2</a> <a id="5428" href="Polynomial.Simple.Reflection.html#893" class="Function Operator">⋯⟅∷⟆</a> <a id="5433" href="Polynomial.Simple.Reflection.html#379" class="Bound">rng</a> <a id="5437" href="Polynomial.Simple.Reflection.html#759" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="5441" class="Number">1</a> <a id="5443" href="Polynomial.Simple.Reflection.html#893" class="Function Operator">⋯⟅∷⟆</a> <a id="5448" href="Polynomial.Simple.Reflection.html#4033" class="Function">toExpr</a> <a id="5455" href="Polynomial.Simple.Reflection.html#5064" class="Bound">rhs</a> <a id="5459" href="Polynomial.Simple.Reflection.html#759" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="5463" href="Polynomial.Simple.Reflection.html#5651" class="Function">ρ</a> <a id="5465" href="Polynomial.Simple.Reflection.html#759" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="5469" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="5471" class="Symbol">)</a> <a id="5473" href="Polynomial.Simple.Reflection.html#759" class="InductiveConstructor Operator">⟨∷⟩</a>
        <a id="5485" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>
      <a id="5494" class="Keyword">where</a>
      <a id="5506" href="Polynomial.Simple.Reflection.html#5506" class="Function">varExpr</a> <a id="5514" class="Symbol">:</a> <a id="5516" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="5518" class="Symbol">→</a> <a id="5520" href="Data.Maybe.Base.html#710" class="Datatype">Maybe</a> <a id="5526" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
      <a id="5537" href="Polynomial.Simple.Reflection.html#5506" class="Function">varExpr</a> <a id="5545" href="Polynomial.Simple.Reflection.html#5545" class="Bound">i</a> <a id="5547" class="Symbol">=</a> <a id="5549" href="Data.Maybe.Base.html#2139" class="Function">Maybe.map</a> <a id="5559" class="Symbol">(λ</a> <a id="5562" href="Polynomial.Simple.Reflection.html#5562" class="Bound">x</a> <a id="5564" class="Symbol">→</a> <a id="5566" class="Keyword">quote</a> <a id="5572" href="Polynomial.Expr.html#311" class="InductiveConstructor">Ι</a> <a id="5574" href="Function.html#2548" class="Function Operator">⟨</a> <a id="5576" href="Agda.Builtin.Reflection.html#4648" class="InductiveConstructor">con</a> <a id="5580" href="Function.html#2548" class="Function Operator">⟩</a> <a id="5582" href="Polynomial.Simple.Reflection.html#2105" class="Function Operator">E⟅∷⟆</a> <a id="5587" href="Polynomial.Simple.Reflection.html#1121" class="Function">finTerm</a> <a id="5595" href="Polynomial.Simple.Reflection.html#5562" class="Bound">x</a> <a id="5597" href="Polynomial.Simple.Reflection.html#759" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="5601" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="5603" class="Symbol">)</a> <a id="5605" class="Symbol">(</a><a id="5606" href="Data.Nat.Table.html#943" class="Function">member</a> <a id="5613" href="Polynomial.Simple.Reflection.html#5545" class="Bound">i</a> <a id="5615" href="Polynomial.Simple.Reflection.html#5058" class="Bound">t</a><a id="5616" class="Symbol">)</a>

      <a id="5625" class="Keyword">open</a> <a id="5630" href="Polynomial.Simple.Reflection.html#2420" class="Module">ToExpr</a> <a id="5637" href="Polynomial.Simple.Reflection.html#5506" class="Function">varExpr</a>
      <a id="5651" href="Polynomial.Simple.Reflection.html#5651" class="Function">ρ</a> <a id="5653" class="Symbol">:</a> <a id="5655" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
      <a id="5666" href="Polynomial.Simple.Reflection.html#5651" class="Function">ρ</a> <a id="5668" class="Symbol">=</a> <a id="5670" href="Polynomial.Simple.Reflection.html#1259" class="Function">curriedTerm</a> <a id="5682" href="Polynomial.Simple.Reflection.html#5058" class="Bound">t</a>

  <a id="Internal.toSoln"></a><a id="5687" href="Polynomial.Simple.Reflection.html#5687" class="Function">toSoln</a> <a id="5694" class="Symbol">:</a> <a id="5696" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="5701" class="Symbol">→</a> <a id="5703" href="Agda.Builtin.Reflection.html#7153" class="Postulate">TC</a> <a id="5706" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
  <a id="5713" href="Polynomial.Simple.Reflection.html#5687" class="Function">toSoln</a> <a id="5720" href="Polynomial.Simple.Reflection.html#5720" class="Bound">t′</a> <a id="5723" class="Symbol">=</a> <a id="5725" href="Polynomial.Simple.Reflection.html#5750" class="Function">go</a> <a id="5728" class="Number">0</a> <a id="5730" href="Function.html#1104" class="Function">id</a> <a id="5733" href="Polynomial.Simple.Reflection.html#5720" class="Bound">t′</a>
    <a id="5740" class="Keyword">where</a>
    <a id="5750" href="Polynomial.Simple.Reflection.html#5750" class="Function">go</a> <a id="5753" class="Symbol">:</a> <a id="5755" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="5757" class="Symbol">→</a> <a id="5759" class="Symbol">(</a><a id="5760" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="5765" href="Agda.Builtin.String.html#165" class="Postulate">String</a> <a id="5772" class="Symbol">→</a> <a id="5774" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="5779" href="Agda.Builtin.String.html#165" class="Postulate">String</a><a id="5785" class="Symbol">)</a> <a id="5787" class="Symbol">→</a> <a id="5789" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="5794" class="Symbol">→</a> <a id="5796" href="Agda.Builtin.Reflection.html#7153" class="Postulate">TC</a> <a id="5799" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
    <a id="5808" href="Polynomial.Simple.Reflection.html#5750" class="Function">go</a> <a id="5811" href="Polynomial.Simple.Reflection.html#5811" class="Bound">i</a> <a id="5813" href="Polynomial.Simple.Reflection.html#5813" class="Bound">k</a> <a id="5815" class="Symbol">(</a><a id="5816" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="5820" href="Polynomial.Simple.Reflection.html#5820" class="Bound">f</a> <a id="5822" class="Symbol">(</a>            <a id="5835" href="Polynomial.Simple.Reflection.html#5835" class="Bound">lhs</a> <a id="5839" href="Polynomial.Simple.Reflection.html#759" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="5843" href="Polynomial.Simple.Reflection.html#5843" class="Bound">rhs</a> <a id="5847" href="Polynomial.Simple.Reflection.html#759" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="5851" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="5853" class="Symbol">))</a> <a id="5856" class="Symbol">=</a> <a id="5858" href="Agda.Builtin.Reflection.html#7193" class="Postulate">returnTC</a> <a id="5867" href="Function.html#1927" class="Function Operator">$</a> <a id="5869" class="Keyword">quote</a> <a id="5875" href="Polynomial.Simple.Solver.html#2840" class="Function">solve′</a> <a id="5882" href="Function.html#2548" class="Function Operator">⟨</a> <a id="5884" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="5888" href="Function.html#2548" class="Function Operator">⟩</a> <a id="5890" href="Polynomial.Simple.Reflection.html#4480" class="Function">mkSolver</a> <a id="5899" href="Polynomial.Simple.Reflection.html#5811" class="Bound">i</a> <a id="5901" class="Symbol">(</a><a id="5902" href="Polynomial.Simple.Reflection.html#5813" class="Bound">k</a> <a id="5904" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="5906" class="Symbol">)</a> <a id="5908" href="Polynomial.Simple.Reflection.html#5835" class="Bound">lhs</a> <a id="5912" href="Polynomial.Simple.Reflection.html#5843" class="Bound">rhs</a>
    <a id="5920" href="Polynomial.Simple.Reflection.html#5750" class="CatchallClause Function">go</a><a id="5922" class="CatchallClause"> </a><a id="5923" href="Polynomial.Simple.Reflection.html#5923" class="CatchallClause Bound">i</a><a id="5924" class="CatchallClause"> </a><a id="5925" href="Polynomial.Simple.Reflection.html#5925" class="CatchallClause Bound">k</a><a id="5926" class="CatchallClause"> </a><a id="5927" class="CatchallClause Symbol">(</a><a id="5928" href="Agda.Builtin.Reflection.html#4705" class="CatchallClause InductiveConstructor">def</a><a id="5931" class="CatchallClause"> </a><a id="5932" href="Polynomial.Simple.Reflection.html#5932" class="CatchallClause Bound">f</a><a id="5933" class="CatchallClause"> </a><a id="5934" class="CatchallClause Symbol">(</a><a id="5935" class="CatchallClause">    </a><a id="5939" class="CatchallClause Symbol">_</a><a id="5940" class="CatchallClause"> </a><a id="5941" href="Agda.Builtin.List.html#132" class="CatchallClause InductiveConstructor Operator">∷</a><a id="5942" class="CatchallClause"> </a><a id="5943" class="CatchallClause Symbol">_</a><a id="5944" class="CatchallClause"> </a><a id="5945" href="Agda.Builtin.List.html#132" class="CatchallClause InductiveConstructor Operator">∷</a><a id="5946" class="CatchallClause"> </a><a id="5947" href="Polynomial.Simple.Reflection.html#5947" class="CatchallClause Bound">lhs</a><a id="5950" class="CatchallClause"> </a><a id="5951" href="Polynomial.Simple.Reflection.html#759" class="CatchallClause InductiveConstructor Operator">⟨∷⟩</a><a id="5954" class="CatchallClause"> </a><a id="5955" href="Polynomial.Simple.Reflection.html#5955" class="CatchallClause Bound">rhs</a><a id="5958" class="CatchallClause"> </a><a id="5959" href="Polynomial.Simple.Reflection.html#759" class="CatchallClause InductiveConstructor Operator">⟨∷⟩</a><a id="5962" class="CatchallClause"> </a><a id="5963" href="Agda.Builtin.List.html#117" class="CatchallClause InductiveConstructor">[]</a><a id="5965" class="CatchallClause Symbol">))</a> <a id="5968" class="Symbol">=</a> <a id="5970" href="Agda.Builtin.Reflection.html#7193" class="Postulate">returnTC</a> <a id="5979" href="Function.html#1927" class="Function Operator">$</a> <a id="5981" class="Keyword">quote</a> <a id="5987" href="Polynomial.Simple.Solver.html#2840" class="Function">solve′</a> <a id="5994" href="Function.html#2548" class="Function Operator">⟨</a> <a id="5996" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="6000" href="Function.html#2548" class="Function Operator">⟩</a> <a id="6002" href="Polynomial.Simple.Reflection.html#4480" class="Function">mkSolver</a> <a id="6011" href="Polynomial.Simple.Reflection.html#5923" class="Bound">i</a> <a id="6013" class="Symbol">(</a><a id="6014" href="Polynomial.Simple.Reflection.html#5925" class="Bound">k</a> <a id="6016" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="6018" class="Symbol">)</a> <a id="6020" href="Polynomial.Simple.Reflection.html#5947" class="Bound">lhs</a> <a id="6024" href="Polynomial.Simple.Reflection.html#5955" class="Bound">rhs</a>
    <a id="6032" href="Polynomial.Simple.Reflection.html#5750" class="CatchallClause Function">go</a><a id="6034" class="CatchallClause"> </a><a id="6035" href="Polynomial.Simple.Reflection.html#6035" class="CatchallClause Bound">i</a><a id="6036" class="CatchallClause"> </a><a id="6037" href="Polynomial.Simple.Reflection.html#6037" class="CatchallClause Bound">k</a><a id="6038" class="CatchallClause"> </a><a id="6039" class="CatchallClause Symbol">(</a><a id="6040" href="Agda.Builtin.Reflection.html#4705" class="CatchallClause InductiveConstructor">def</a><a id="6043" class="CatchallClause"> </a><a id="6044" href="Polynomial.Simple.Reflection.html#6044" class="CatchallClause Bound">f</a><a id="6045" class="CatchallClause"> </a><a id="6046" class="CatchallClause Symbol">(_</a><a id="6048" class="CatchallClause"> </a><a id="6049" href="Agda.Builtin.List.html#132" class="CatchallClause InductiveConstructor Operator">∷</a><a id="6050" class="CatchallClause"> </a><a id="6051" class="CatchallClause Symbol">_</a><a id="6052" class="CatchallClause"> </a><a id="6053" href="Agda.Builtin.List.html#132" class="CatchallClause InductiveConstructor Operator">∷</a><a id="6054" class="CatchallClause"> </a><a id="6055" class="CatchallClause Symbol">_</a><a id="6056" class="CatchallClause"> </a><a id="6057" href="Agda.Builtin.List.html#132" class="CatchallClause InductiveConstructor Operator">∷</a><a id="6058" class="CatchallClause"> </a><a id="6059" href="Polynomial.Simple.Reflection.html#6059" class="CatchallClause Bound">lhs</a><a id="6062" class="CatchallClause"> </a><a id="6063" href="Polynomial.Simple.Reflection.html#759" class="CatchallClause InductiveConstructor Operator">⟨∷⟩</a><a id="6066" class="CatchallClause"> </a><a id="6067" href="Polynomial.Simple.Reflection.html#6067" class="CatchallClause Bound">rhs</a><a id="6070" class="CatchallClause"> </a><a id="6071" href="Polynomial.Simple.Reflection.html#759" class="CatchallClause InductiveConstructor Operator">⟨∷⟩</a><a id="6074" class="CatchallClause"> </a><a id="6075" href="Agda.Builtin.List.html#117" class="CatchallClause InductiveConstructor">[]</a><a id="6077" class="CatchallClause Symbol">))</a> <a id="6080" class="Symbol">=</a> <a id="6082" href="Agda.Builtin.Reflection.html#7193" class="Postulate">returnTC</a> <a id="6091" href="Function.html#1927" class="Function Operator">$</a> <a id="6093" class="Keyword">quote</a> <a id="6099" href="Polynomial.Simple.Solver.html#2840" class="Function">solve′</a> <a id="6106" href="Function.html#2548" class="Function Operator">⟨</a> <a id="6108" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="6112" href="Function.html#2548" class="Function Operator">⟩</a> <a id="6114" href="Polynomial.Simple.Reflection.html#4480" class="Function">mkSolver</a> <a id="6123" href="Polynomial.Simple.Reflection.html#6035" class="Bound">i</a> <a id="6125" class="Symbol">(</a><a id="6126" href="Polynomial.Simple.Reflection.html#6037" class="Bound">k</a> <a id="6128" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="6130" class="Symbol">)</a> <a id="6132" href="Polynomial.Simple.Reflection.html#6059" class="Bound">lhs</a> <a id="6136" href="Polynomial.Simple.Reflection.html#6067" class="Bound">rhs</a>
    <a id="6144" href="Polynomial.Simple.Reflection.html#5750" class="Function">go</a> <a id="6147" href="Polynomial.Simple.Reflection.html#6147" class="Bound">i</a> <a id="6149" href="Polynomial.Simple.Reflection.html#6149" class="Bound">k</a> <a id="6151" class="Symbol">(</a><a id="6152" href="Agda.Builtin.Reflection.html#4880" class="InductiveConstructor">pi</a> <a id="6155" href="Polynomial.Simple.Reflection.html#6155" class="Bound">a</a> <a id="6157" class="Symbol">(</a><a id="6158" href="Agda.Builtin.Reflection.html#3308" class="InductiveConstructor">abs</a> <a id="6162" href="Polynomial.Simple.Reflection.html#6162" class="Bound">s</a> <a id="6164" href="Polynomial.Simple.Reflection.html#6164" class="Bound">x</a><a id="6165" class="Symbol">))</a> <a id="6168" class="Symbol">=</a> <a id="6170" href="Polynomial.Simple.Reflection.html#5750" class="Function">go</a> <a id="6173" class="Symbol">(</a><a id="6174" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="6178" href="Polynomial.Simple.Reflection.html#6147" class="Bound">i</a><a id="6179" class="Symbol">)</a> <a id="6181" class="Symbol">(</a><a id="6182" href="Polynomial.Simple.Reflection.html#6149" class="Bound">k</a> <a id="6184" href="Function.html#805" class="Function Operator">∘</a> <a id="6186" class="Symbol">(</a><a id="6187" href="Polynomial.Simple.Reflection.html#6162" class="Bound">s</a> <a id="6189" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷_</a><a id="6191" class="Symbol">))</a> <a id="6194" href="Polynomial.Simple.Reflection.html#6164" class="Bound">x</a>
    <a id="6200" href="Polynomial.Simple.Reflection.html#5750" class="CatchallClause Function">go</a><a id="6202" class="CatchallClause"> </a><a id="6203" href="Polynomial.Simple.Reflection.html#6203" class="CatchallClause Bound">i</a><a id="6204" class="CatchallClause"> </a><a id="6205" href="Polynomial.Simple.Reflection.html#6205" class="CatchallClause Bound">k</a><a id="6206" class="CatchallClause"> </a><a id="6207" href="Polynomial.Simple.Reflection.html#6207" class="CatchallClause Bound">t</a> <a id="6209" class="Symbol">=</a> <a id="6211" href="Agda.Builtin.Reflection.html#7354" class="Postulate">typeError</a> <a id="6221" class="Symbol">(</a><a id="6222" href="Agda.Builtin.Reflection.html#6852" class="InductiveConstructor">strErr</a> <a id="6229" class="String">&quot;Malformed call to solve.&quot;</a> <a id="6256" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a>
                          <a id="6284" href="Agda.Builtin.Reflection.html#6852" class="InductiveConstructor">strErr</a> <a id="6291" class="String">&quot;Expected target type to be like: ∀ x y → x + y ≈ y + x.&quot;</a> <a id="6349" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a>
                          <a id="6377" href="Agda.Builtin.Reflection.html#6852" class="InductiveConstructor">strErr</a> <a id="6384" class="String">&quot;Instead: &quot;</a> <a id="6396" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a>
                          <a id="6424" href="Agda.Builtin.Reflection.html#6883" class="InductiveConstructor">termErr</a> <a id="6432" href="Polynomial.Simple.Reflection.html#5720" class="Bound">t′</a> <a id="6435" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a>
                          <a id="6463" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="6465" class="Symbol">)</a>

  <a id="Internal.listType"></a><a id="6470" href="Polynomial.Simple.Reflection.html#6470" class="Function">listType</a> <a id="6479" class="Symbol">:</a> <a id="6481" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="6486" class="Symbol">→</a> <a id="6488" href="Agda.Builtin.Reflection.html#7153" class="Postulate">TC</a> <a id="6491" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
  <a id="6498" href="Polynomial.Simple.Reflection.html#6470" class="Function">listType</a> <a id="6507" href="Polynomial.Simple.Reflection.html#6507" class="Bound">t</a> <a id="6509" class="Symbol">=</a>
    <a id="6515" href="Agda.Builtin.Reflection.html#7447" class="Postulate">checkType</a> <a id="6525" href="Polynomial.Simple.Reflection.html#6507" class="Bound">t</a> <a id="6527" class="Symbol">(</a><a id="6528" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="6532" class="Symbol">(</a><a id="6533" class="Keyword">quote</a> <a id="6539" href="Agda.Builtin.List.html#80" class="Datatype">List</a><a id="6543" class="Symbol">)</a> <a id="6545" class="Symbol">(</a><a id="6546" class="Number">1</a> <a id="6548" href="Polynomial.Simple.Reflection.html#893" class="Function Operator">⋯⟅∷⟆</a> <a id="6553" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="6557" class="Symbol">(</a><a id="6558" class="Keyword">quote</a> <a id="6564" href="Polynomial.Simple.AlmostCommutativeRing.html#1079" class="Field">AlmostCommutativeRing.Carrier</a><a id="6593" class="Symbol">)</a> <a id="6595" class="Symbol">(</a><a id="6596" class="Number">2</a> <a id="6598" href="Polynomial.Simple.Reflection.html#893" class="Function Operator">⋯⟅∷⟆</a> <a id="6603" href="Polynomial.Simple.Reflection.html#379" class="Bound">rng</a> <a id="6607" href="Polynomial.Simple.Reflection.html#759" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="6611" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="6613" class="Symbol">)</a> <a id="6615" href="Polynomial.Simple.Reflection.html#759" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="6619" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="6621" class="Symbol">))</a> <a id="6624" href="Function.html#2548" class="Function Operator">⟨</a> <a id="6626" href="Agda.Builtin.Reflection.html#7240" class="Postulate">bindTC</a> <a id="6633" href="Function.html#2548" class="Function Operator">⟩</a> <a id="6635" href="Agda.Builtin.Reflection.html#7487" class="Postulate">normalise</a>

  <a id="Internal.checkRing"></a><a id="6648" href="Polynomial.Simple.Reflection.html#6648" class="Function">checkRing</a> <a id="6658" class="Symbol">:</a> <a id="6660" href="Agda.Builtin.Reflection.html#7153" class="Postulate">TC</a> <a id="6663" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
  <a id="6670" href="Polynomial.Simple.Reflection.html#6648" class="Function">checkRing</a> <a id="6680" class="Symbol">=</a> <a id="6682" href="Agda.Builtin.Reflection.html#7447" class="Postulate">checkType</a> <a id="6692" href="Polynomial.Simple.Reflection.html#379" class="Bound">rng</a> <a id="6696" class="Symbol">(</a><a id="6697" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="6701" class="Symbol">(</a><a id="6702" class="Keyword">quote</a> <a id="6708" href="Polynomial.Simple.AlmostCommutativeRing.html#941" class="Record">AlmostCommutativeRing</a><a id="6729" class="Symbol">)</a> <a id="6731" class="Symbol">(</a><a id="6732" href="Agda.Builtin.Reflection.html#5048" class="InductiveConstructor">unknown</a> <a id="6740" href="Polynomial.Simple.Reflection.html#759" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="6744" href="Agda.Builtin.Reflection.html#5048" class="InductiveConstructor">unknown</a> <a id="6752" href="Polynomial.Simple.Reflection.html#759" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="6756" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="6758" class="Symbol">))</a>

  <a id="Internal.toSoln′"></a><a id="6764" href="Polynomial.Simple.Reflection.html#6764" class="Function">toSoln′</a> <a id="6772" class="Symbol">:</a> <a id="6774" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>  <a id="6780" class="Symbol">→</a> <a id="6782" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="6787" class="Symbol">→</a> <a id="6789" href="Agda.Builtin.Reflection.html#7153" class="Postulate">TC</a> <a id="6792" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
  <a id="6799" href="Polynomial.Simple.Reflection.html#6764" class="Function">toSoln′</a> <a id="6807" href="Polynomial.Simple.Reflection.html#6807" class="Bound">t′</a> <a id="6810" href="Polynomial.Simple.Reflection.html#6810" class="Bound">xs′</a> <a id="6814" class="Symbol">=</a> <a id="6816" href="Polynomial.Simple.Reflection.html#7446" class="Function">go</a> <a id="6819" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a> <a id="6822" href="Polynomial.Simple.Reflection.html#6807" class="Bound">t′</a> <a id="6825" href="Polynomial.Simple.Reflection.html#6810" class="Bound">xs′</a>
    <a id="6833" class="Keyword">where</a>
    <a id="6843" href="Polynomial.Simple.Reflection.html#6843" class="Function">go′</a> <a id="6847" class="Symbol">:</a> <a id="6849" href="Data.Nat.Table.html#425" class="Function">Table</a> <a id="6855" class="Symbol">→</a> <a id="6857" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="6862" class="Symbol">→</a> <a id="6864" href="Agda.Builtin.Reflection.html#7153" class="Postulate">TC</a> <a id="6867" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
    <a id="6876" href="Polynomial.Simple.Reflection.html#6843" class="Function">go′</a> <a id="6880" href="Polynomial.Simple.Reflection.html#6880" class="Bound">i</a> <a id="6882" class="Symbol">(</a><a id="6883" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="6887" href="Polynomial.Simple.Reflection.html#6887" class="Bound">f</a> <a id="6889" class="Symbol">(</a>            <a id="6902" href="Polynomial.Simple.Reflection.html#6902" class="Bound">lhs</a> <a id="6906" href="Polynomial.Simple.Reflection.html#759" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="6910" href="Polynomial.Simple.Reflection.html#6910" class="Bound">rhs</a> <a id="6914" href="Polynomial.Simple.Reflection.html#759" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="6918" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="6920" class="Symbol">))</a> <a id="6923" class="Symbol">=</a> <a id="6925" href="Agda.Builtin.Reflection.html#7193" class="Postulate">returnTC</a> <a id="6934" href="Function.html#1927" class="Function Operator">$</a> <a id="6936" href="Polynomial.Simple.Reflection.html#5005" class="Function">mkSolver′</a> <a id="6946" class="Symbol">(</a><a id="6947" href="Data.List.Base.html#4466" class="Function">List.length</a> <a id="6959" href="Polynomial.Simple.Reflection.html#6880" class="Bound">i</a><a id="6960" class="Symbol">)</a> <a id="6962" href="Polynomial.Simple.Reflection.html#6880" class="Bound">i</a> <a id="6964" href="Polynomial.Simple.Reflection.html#6902" class="Bound">lhs</a> <a id="6968" href="Polynomial.Simple.Reflection.html#6910" class="Bound">rhs</a>
    <a id="6976" href="Polynomial.Simple.Reflection.html#6843" class="CatchallClause Function">go′</a><a id="6979" class="CatchallClause"> </a><a id="6980" href="Polynomial.Simple.Reflection.html#6980" class="CatchallClause Bound">i</a><a id="6981" class="CatchallClause"> </a><a id="6982" class="CatchallClause Symbol">(</a><a id="6983" href="Agda.Builtin.Reflection.html#4705" class="CatchallClause InductiveConstructor">def</a><a id="6986" class="CatchallClause"> </a><a id="6987" href="Polynomial.Simple.Reflection.html#6987" class="CatchallClause Bound">f</a><a id="6988" class="CatchallClause"> </a><a id="6989" class="CatchallClause Symbol">(_</a><a id="6991" class="CatchallClause"> </a><a id="6992" href="Agda.Builtin.List.html#132" class="CatchallClause InductiveConstructor Operator">∷</a><a id="6993" class="CatchallClause"> </a><a id="6994" class="CatchallClause Symbol">_</a><a id="6995" class="CatchallClause"> </a><a id="6996" href="Agda.Builtin.List.html#132" class="CatchallClause InductiveConstructor Operator">∷</a><a id="6997" class="CatchallClause">     </a><a id="7002" href="Polynomial.Simple.Reflection.html#7002" class="CatchallClause Bound">lhs</a><a id="7005" class="CatchallClause"> </a><a id="7006" href="Polynomial.Simple.Reflection.html#759" class="CatchallClause InductiveConstructor Operator">⟨∷⟩</a><a id="7009" class="CatchallClause"> </a><a id="7010" href="Polynomial.Simple.Reflection.html#7010" class="CatchallClause Bound">rhs</a><a id="7013" class="CatchallClause"> </a><a id="7014" href="Polynomial.Simple.Reflection.html#759" class="CatchallClause InductiveConstructor Operator">⟨∷⟩</a><a id="7017" class="CatchallClause"> </a><a id="7018" href="Agda.Builtin.List.html#117" class="CatchallClause InductiveConstructor">[]</a><a id="7020" class="CatchallClause Symbol">))</a> <a id="7023" class="Symbol">=</a> <a id="7025" href="Agda.Builtin.Reflection.html#7193" class="Postulate">returnTC</a> <a id="7034" href="Function.html#1927" class="Function Operator">$</a> <a id="7036" href="Polynomial.Simple.Reflection.html#5005" class="Function">mkSolver′</a> <a id="7046" class="Symbol">(</a><a id="7047" href="Data.List.Base.html#4466" class="Function">List.length</a> <a id="7059" href="Polynomial.Simple.Reflection.html#6980" class="Bound">i</a><a id="7060" class="Symbol">)</a> <a id="7062" href="Polynomial.Simple.Reflection.html#6980" class="Bound">i</a> <a id="7064" href="Polynomial.Simple.Reflection.html#7002" class="Bound">lhs</a> <a id="7068" href="Polynomial.Simple.Reflection.html#7010" class="Bound">rhs</a>
    <a id="7076" href="Polynomial.Simple.Reflection.html#6843" class="CatchallClause Function">go′</a><a id="7079" class="CatchallClause"> </a><a id="7080" href="Polynomial.Simple.Reflection.html#7080" class="CatchallClause Bound">i</a><a id="7081" class="CatchallClause"> </a><a id="7082" class="CatchallClause Symbol">(</a><a id="7083" href="Agda.Builtin.Reflection.html#4705" class="CatchallClause InductiveConstructor">def</a><a id="7086" class="CatchallClause"> </a><a id="7087" href="Polynomial.Simple.Reflection.html#7087" class="CatchallClause Bound">f</a><a id="7088" class="CatchallClause"> </a><a id="7089" class="CatchallClause Symbol">(_</a><a id="7091" class="CatchallClause"> </a><a id="7092" href="Agda.Builtin.List.html#132" class="CatchallClause InductiveConstructor Operator">∷</a><a id="7093" class="CatchallClause"> </a><a id="7094" class="CatchallClause Symbol">_</a><a id="7095" class="CatchallClause"> </a><a id="7096" href="Agda.Builtin.List.html#132" class="CatchallClause InductiveConstructor Operator">∷</a><a id="7097" class="CatchallClause"> </a><a id="7098" class="CatchallClause Symbol">_</a><a id="7099" class="CatchallClause"> </a><a id="7100" href="Agda.Builtin.List.html#132" class="CatchallClause InductiveConstructor Operator">∷</a><a id="7101" class="CatchallClause"> </a><a id="7102" href="Polynomial.Simple.Reflection.html#7102" class="CatchallClause Bound">lhs</a><a id="7105" class="CatchallClause"> </a><a id="7106" href="Polynomial.Simple.Reflection.html#759" class="CatchallClause InductiveConstructor Operator">⟨∷⟩</a><a id="7109" class="CatchallClause"> </a><a id="7110" href="Polynomial.Simple.Reflection.html#7110" class="CatchallClause Bound">rhs</a><a id="7113" class="CatchallClause"> </a><a id="7114" href="Polynomial.Simple.Reflection.html#759" class="CatchallClause InductiveConstructor Operator">⟨∷⟩</a><a id="7117" class="CatchallClause"> </a><a id="7118" href="Agda.Builtin.List.html#117" class="CatchallClause InductiveConstructor">[]</a><a id="7120" class="CatchallClause Symbol">))</a> <a id="7123" class="Symbol">=</a> <a id="7125" href="Agda.Builtin.Reflection.html#7193" class="Postulate">returnTC</a> <a id="7134" href="Function.html#1927" class="Function Operator">$</a> <a id="7136" href="Polynomial.Simple.Reflection.html#5005" class="Function">mkSolver′</a> <a id="7146" class="Symbol">(</a><a id="7147" href="Data.List.Base.html#4466" class="Function">List.length</a> <a id="7159" href="Polynomial.Simple.Reflection.html#7080" class="Bound">i</a><a id="7160" class="Symbol">)</a> <a id="7162" href="Polynomial.Simple.Reflection.html#7080" class="Bound">i</a> <a id="7164" href="Polynomial.Simple.Reflection.html#7102" class="Bound">lhs</a> <a id="7168" href="Polynomial.Simple.Reflection.html#7110" class="Bound">rhs</a>
    <a id="7176" href="Polynomial.Simple.Reflection.html#6843" class="CatchallClause Function">go′</a><a id="7179" class="CatchallClause"> </a><a id="7180" class="CatchallClause Symbol">_</a><a id="7181" class="CatchallClause"> </a><a id="7182" class="CatchallClause Symbol">_</a> <a id="7184" class="Symbol">=</a> <a id="7186" href="Agda.Builtin.Reflection.html#7354" class="Postulate">typeError</a> <a id="7196" class="Symbol">(</a><a id="7197" href="Agda.Builtin.Reflection.html#6852" class="InductiveConstructor">strErr</a> <a id="7204" class="String">&quot;Malformed call to solveOver.&quot;</a> <a id="7235" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a>
                         <a id="7262" href="Agda.Builtin.Reflection.html#6852" class="InductiveConstructor">strErr</a> <a id="7269" class="String">&quot;Target type should be an equality like x + y ≈ y + x.&quot;</a> <a id="7325" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a>
                         <a id="7352" href="Agda.Builtin.Reflection.html#6852" class="InductiveConstructor">strErr</a> <a id="7359" class="String">&quot;Instead: &quot;</a> <a id="7371" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a>
                         <a id="7398" href="Agda.Builtin.Reflection.html#6883" class="InductiveConstructor">termErr</a> <a id="7406" href="Polynomial.Simple.Reflection.html#6810" class="Bound">xs′</a> <a id="7410" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a>
                         <a id="7437" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="7439" class="Symbol">)</a>

    <a id="7446" href="Polynomial.Simple.Reflection.html#7446" class="Function">go</a> <a id="7449" class="Symbol">:</a> <a id="7451" href="Data.Nat.Table.html#425" class="Function">Table</a> <a id="7457" class="Symbol">→</a> <a id="7459" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="7464" class="Symbol">→</a> <a id="7466" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="7471" class="Symbol">→</a> <a id="7473" href="Agda.Builtin.Reflection.html#7153" class="Postulate">TC</a> <a id="7476" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
    <a id="7485" href="Polynomial.Simple.Reflection.html#7446" class="Function">go</a> <a id="7488" href="Polynomial.Simple.Reflection.html#7488" class="Bound">t</a> <a id="7490" class="Symbol">(</a><a id="7491" href="Agda.Builtin.Reflection.html#4648" class="InductiveConstructor">con</a> <a id="7495" class="Symbol">(</a><a id="7496" class="Keyword">quote</a> <a id="7502" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">List._∷_</a><a id="7510" class="Symbol">)</a> <a id="7512" class="Symbol">(_</a> <a id="7515" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="7517" class="Symbol">_</a> <a id="7519" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="7521" href="Agda.Builtin.Reflection.html#4592" class="InductiveConstructor">var</a> <a id="7525" href="Polynomial.Simple.Reflection.html#7525" class="Bound">i</a> <a id="7527" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a> <a id="7530" href="Polynomial.Simple.Reflection.html#759" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="7534" href="Polynomial.Simple.Reflection.html#7534" class="Bound">xs</a> <a id="7537" href="Polynomial.Simple.Reflection.html#759" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="7541" class="Symbol">_))</a> <a id="7545" href="Polynomial.Simple.Reflection.html#7545" class="Bound">ys</a> <a id="7548" class="Symbol">=</a> <a id="7550" href="Polynomial.Simple.Reflection.html#7446" class="Function">go</a> <a id="7553" class="Symbol">(</a><a id="7554" href="Data.Nat.Table.html#590" class="Function">insert</a> <a id="7561" href="Polynomial.Simple.Reflection.html#7525" class="Bound">i</a> <a id="7563" href="Polynomial.Simple.Reflection.html#7488" class="Bound">t</a><a id="7564" class="Symbol">)</a> <a id="7566" href="Polynomial.Simple.Reflection.html#7534" class="Bound">xs</a> <a id="7569" href="Polynomial.Simple.Reflection.html#7545" class="Bound">ys</a>
    <a id="7576" href="Polynomial.Simple.Reflection.html#7446" class="Function">go</a> <a id="7579" href="Polynomial.Simple.Reflection.html#7579" class="Bound">t</a> <a id="7581" class="Symbol">(</a><a id="7582" href="Agda.Builtin.Reflection.html#4648" class="InductiveConstructor">con</a> <a id="7586" class="Symbol">(</a><a id="7587" class="Keyword">quote</a> <a id="7593" href="Agda.Builtin.List.html#117" class="InductiveConstructor">List.List.[]</a><a id="7605" class="Symbol">)</a> <a id="7607" class="Symbol">_)</a> <a id="7610" href="Polynomial.Simple.Reflection.html#7610" class="Bound">xs</a> <a id="7613" class="Symbol">=</a> <a id="7615" href="Polynomial.Simple.Reflection.html#6843" class="Function">go′</a> <a id="7619" href="Polynomial.Simple.Reflection.html#7579" class="Bound">t</a> <a id="7621" href="Polynomial.Simple.Reflection.html#7610" class="Bound">xs</a>
    <a id="7628" href="Polynomial.Simple.Reflection.html#7446" class="CatchallClause Function">go</a><a id="7630" class="CatchallClause"> </a><a id="7631" href="Polynomial.Simple.Reflection.html#7631" class="CatchallClause Bound">i</a><a id="7632" class="CatchallClause"> </a><a id="7633" href="Polynomial.Simple.Reflection.html#7633" class="CatchallClause Bound">k</a><a id="7634" class="CatchallClause"> </a><a id="7635" href="Polynomial.Simple.Reflection.html#7635" class="CatchallClause Bound">t</a> <a id="7637" class="Symbol">=</a> <a id="7639" href="Agda.Builtin.Reflection.html#7354" class="Postulate">typeError</a> <a id="7649" class="Symbol">(</a><a id="7650" href="Agda.Builtin.Reflection.html#6852" class="InductiveConstructor">strErr</a> <a id="7657" class="String">&quot;Malformed call to solveOver.&quot;</a> <a id="7688" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a>
                          <a id="7716" href="Agda.Builtin.Reflection.html#6852" class="InductiveConstructor">strErr</a> <a id="7723" class="String">&quot;First argument should be a list of free variables.&quot;</a> <a id="7776" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a>
                          <a id="7804" href="Agda.Builtin.Reflection.html#6852" class="InductiveConstructor">strErr</a> <a id="7811" class="String">&quot;Instead: &quot;</a> <a id="7823" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a>
                          <a id="7851" href="Agda.Builtin.Reflection.html#6883" class="InductiveConstructor">termErr</a> <a id="7859" href="Polynomial.Simple.Reflection.html#6807" class="Bound">t′</a> <a id="7862" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a>
                          <a id="7890" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="7892" class="Symbol">)</a>
<a id="7894" class="Keyword">open</a> <a id="7899" href="Polynomial.Simple.Reflection.html#369" class="Module">Internal</a>

<a id="7909" class="Comment">-- This is the main macro you&#39;ll probably be using. Call it like this:</a>
<a id="7980" class="Comment">--</a>
<a id="7983" class="Comment">--   lemma : ∀ x y → x + y ≈ y + x</a>
<a id="8018" class="Comment">--   lemma = solve TypeRing</a>
<a id="8046" class="Comment">--</a>
<a id="8049" class="Comment">-- where TypRing is your implementation of AlmostCommutativeRing. (Find some</a>
<a id="8126" class="Comment">-- example implementations in Polynomial.Solver.Ring.AlmostCommutativeRing.Instances).</a>
<a id="8213" class="Keyword">macro</a>
  <a id="solve"></a><a id="8221" href="Polynomial.Simple.Reflection.html#8221" class="Function">solve</a> <a id="8227" class="Symbol">:</a> <a id="8229" href="Agda.Builtin.Reflection.html#363" class="Postulate">Name</a> <a id="8234" class="Symbol">→</a> <a id="8236" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="8241" class="Symbol">→</a> <a id="8243" href="Agda.Builtin.Reflection.html#7153" class="Postulate">TC</a> <a id="8246" href="Agda.Builtin.Unit.html#69" class="Record">⊤</a>
  <a id="8250" href="Polynomial.Simple.Reflection.html#8221" class="Function">solve</a> <a id="8256" href="Polynomial.Simple.Reflection.html#8256" class="Bound">rng′</a> <a id="8261" href="Polynomial.Simple.Reflection.html#8261" class="Bound">hole</a> <a id="8266" class="Symbol">=</a> <a id="8268" class="Keyword">do</a>
    <a id="8275" href="Polynomial.Simple.Reflection.html#8275" class="Bound">rng</a> <a id="8279" href="Polynomial.Simple.Reflection.html#299" class="Function Operator">←</a> <a id="8281" href="Polynomial.Simple.Reflection.html#6648" class="Function">checkRing</a> <a id="8291" class="Symbol">(</a><a id="8292" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="8296" href="Polynomial.Simple.Reflection.html#8256" class="Bound">rng′</a> <a id="8301" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="8303" class="Symbol">)</a>
    <a id="8309" class="Symbol">_</a> <a id="8311" href="Polynomial.Simple.Reflection.html#299" class="Function Operator">←</a> <a id="8313" href="Agda.Builtin.Reflection.html#8165" class="Postulate">commitTC</a>
    <a id="8326" href="Agda.Builtin.Reflection.html#7414" class="Postulate">inferType</a> <a id="8336" href="Polynomial.Simple.Reflection.html#8261" class="Bound">hole</a> <a id="8341" href="Function.html#2548" class="Function Operator">⟨</a> <a id="8343" href="Agda.Builtin.Reflection.html#7240" class="Postulate">bindTC</a> <a id="8350" href="Function.html#2548" class="Function Operator">⟩</a> <a id="8352" href="Agda.Builtin.Reflection.html#7520" class="Postulate">reduce</a> <a id="8359" href="Function.html#2548" class="Function Operator">⟨</a> <a id="8361" href="Agda.Builtin.Reflection.html#7240" class="Postulate">bindTC</a> <a id="8368" href="Function.html#2548" class="Function Operator">⟩</a> <a id="8370" href="Polynomial.Simple.Reflection.html#5687" class="Function">toSoln</a> <a id="8377" href="Polynomial.Simple.Reflection.html#8275" class="Bound">rng</a> <a id="8381" href="Function.html#2548" class="Function Operator">⟨</a> <a id="8383" href="Agda.Builtin.Reflection.html#7240" class="Postulate">bindTC</a> <a id="8390" href="Function.html#2548" class="Function Operator">⟩</a> <a id="8392" href="Agda.Builtin.Reflection.html#7317" class="Postulate">unify</a> <a id="8398" href="Polynomial.Simple.Reflection.html#8261" class="Bound">hole</a>

<a id="8404" class="Comment">-- Use this macro when you want to solve something *under* a lambda. For example:</a>
<a id="8486" class="Comment">-- say you have a long proof, and you just want the solver to deal with an</a>
<a id="8561" class="Comment">-- intermediate step. Call it like so:</a>
<a id="8600" class="Comment">--</a>
<a id="8603" class="Comment">--   lemma₃ : ∀ x y → x + y * 1 + 3 ≈ 2 + 1 + y + x</a>
<a id="8655" class="Comment">--   lemma₃ x y = begin</a>
<a id="8679" class="Comment">--     x + y * 1 + 3 ≈⟨ +-comm x (y * 1) ⟨ +-cong ⟩ refl ⟩</a>
<a id="8738" class="Comment">--     y * 1 + x + 3 ≈⟨ solveOver (x ∷ y ∷ []) Int.ring ⟩</a>
<a id="8796" class="Comment">--     3 + y + x     ≡⟨ refl ⟩</a>
<a id="8827" class="Comment">--     2 + 1 + y + x ∎</a>
<a id="8850" class="Comment">--</a>
<a id="8853" class="Comment">-- The first argument is the free variables, and the second is the</a>
<a id="8920" class="Comment">-- ring implementation (as before).</a>
<a id="8956" class="Comment">--</a>
<a id="8959" class="Comment">-- One thing to note here is that we need to be able to infer *both* sides of</a>
<a id="9037" class="Comment">-- the equality, which the normal equaltional reasoning combinators don&#39;t let you</a>
<a id="9119" class="Comment">-- do. You&#39;ll need the combinators defined in Relation.Binary.Reasoning.Inference.</a>
<a id="9202" class="Comment">-- These are just as powerful as the others, but have slightly better inference properties.</a>

<a id="9295" class="Keyword">macro</a>
  <a id="solveOver"></a><a id="9303" href="Polynomial.Simple.Reflection.html#9303" class="Function">solveOver</a> <a id="9313" class="Symbol">:</a> <a id="9315" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="9320" class="Symbol">→</a> <a id="9322" href="Agda.Builtin.Reflection.html#363" class="Postulate">Name</a> <a id="9327" class="Symbol">→</a> <a id="9329" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="9334" class="Symbol">→</a> <a id="9336" href="Agda.Builtin.Reflection.html#7153" class="Postulate">TC</a> <a id="9339" href="Agda.Builtin.Unit.html#69" class="Record">⊤</a>
  <a id="9343" href="Polynomial.Simple.Reflection.html#9303" class="Function">solveOver</a> <a id="9353" href="Polynomial.Simple.Reflection.html#9353" class="Bound">i′</a> <a id="9356" href="Polynomial.Simple.Reflection.html#9356" class="Bound">rng′</a> <a id="9361" href="Polynomial.Simple.Reflection.html#9361" class="Bound">hole</a> <a id="9366" class="Symbol">=</a> <a id="9368" class="Keyword">do</a>
    <a id="9375" href="Polynomial.Simple.Reflection.html#9375" class="Bound">rng</a> <a id="9379" href="Polynomial.Simple.Reflection.html#299" class="Function Operator">←</a> <a id="9381" href="Polynomial.Simple.Reflection.html#6648" class="Function">checkRing</a> <a id="9391" class="Symbol">(</a><a id="9392" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="9396" href="Polynomial.Simple.Reflection.html#9356" class="Bound">rng′</a> <a id="9401" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="9403" class="Symbol">)</a>
    <a id="9409" class="Symbol">_</a> <a id="9411" href="Polynomial.Simple.Reflection.html#299" class="Function Operator">←</a> <a id="9413" href="Agda.Builtin.Reflection.html#8165" class="Postulate">commitTC</a>
    <a id="9426" href="Polynomial.Simple.Reflection.html#9426" class="Bound">i</a> <a id="9428" href="Polynomial.Simple.Reflection.html#299" class="Function Operator">←</a> <a id="9430" href="Polynomial.Simple.Reflection.html#6470" class="Function">listType</a> <a id="9439" href="Polynomial.Simple.Reflection.html#9375" class="Bound">rng</a> <a id="9443" href="Polynomial.Simple.Reflection.html#9353" class="Bound">i′</a>
    <a id="9450" class="Symbol">_</a> <a id="9452" href="Polynomial.Simple.Reflection.html#299" class="Function Operator">←</a> <a id="9454" href="Agda.Builtin.Reflection.html#8165" class="Postulate">commitTC</a>
    <a id="9467" href="Agda.Builtin.Reflection.html#7414" class="Postulate">inferType</a> <a id="9477" href="Polynomial.Simple.Reflection.html#9361" class="Bound">hole</a> <a id="9482" href="Function.html#2548" class="Function Operator">⟨</a> <a id="9484" href="Agda.Builtin.Reflection.html#7240" class="Postulate">bindTC</a> <a id="9491" href="Function.html#2548" class="Function Operator">⟩</a> <a id="9493" href="Agda.Builtin.Reflection.html#7520" class="Postulate">reduce</a> <a id="9500" href="Function.html#2548" class="Function Operator">⟨</a> <a id="9502" href="Agda.Builtin.Reflection.html#7240" class="Postulate">bindTC</a> <a id="9509" href="Function.html#2548" class="Function Operator">⟩</a> <a id="9511" href="Polynomial.Simple.Reflection.html#6764" class="Function">toSoln′</a> <a id="9519" href="Polynomial.Simple.Reflection.html#9375" class="Bound">rng</a> <a id="9523" href="Polynomial.Simple.Reflection.html#9426" class="Bound">i</a> <a id="9525" href="Function.html#2548" class="Function Operator">⟨</a> <a id="9527" href="Agda.Builtin.Reflection.html#7240" class="Postulate">bindTC</a> <a id="9534" href="Function.html#2548" class="Function Operator">⟩</a> <a id="9536" href="Agda.Builtin.Reflection.html#7317" class="Postulate">unify</a> <a id="9542" href="Polynomial.Simple.Reflection.html#9361" class="Bound">hole</a>
</pre></body></html>