<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Polynomial.NormalForm.Construction</title><link rel="stylesheet" href="Agda.css"></head><body><pre><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Option">--without-K</a> <a id="25" class="Option">--safe</a> <a id="32" class="Symbol">#-}</a>

<a id="37" class="Keyword">open</a> <a id="42" class="Keyword">import</a> <a id="49" href="Polynomial.Parameters.html" class="Module">Polynomial.Parameters</a>

<a id="72" class="Keyword">module</a> <a id="79" href="Polynomial.NormalForm.Construction.html" class="Module">Polynomial.NormalForm.Construction</a>
  <a id="116" class="Symbol">{</a><a id="117" href="Polynomial.NormalForm.Construction.html#117" class="Bound">a</a><a id="118" class="Symbol">}</a>
  <a id="122" class="Symbol">(</a><a id="123" href="Polynomial.NormalForm.Construction.html#123" class="Bound">coeffs</a> <a id="130" class="Symbol">:</a> <a id="132" href="Polynomial.Parameters.html#562" class="Record">RawCoeff</a> <a id="141" href="Polynomial.NormalForm.Construction.html#117" class="Bound">a</a><a id="142" class="Symbol">)</a>
  <a id="146" class="Keyword">where</a>

<a id="153" class="Keyword">open</a> <a id="158" class="Keyword">import</a> <a id="165" href="Relation.Nullary.html" class="Module">Relation.Nullary</a>         <a id="190" class="Keyword">using</a> <a id="196" class="Symbol">(</a><a id="197" href="Relation.Nullary.html#570" class="Datatype">Dec</a><a id="200" class="Symbol">;</a> <a id="202" href="Relation.Nullary.html#606" class="InductiveConstructor">yes</a><a id="205" class="Symbol">;</a> <a id="207" href="Relation.Nullary.html#633" class="InductiveConstructor">no</a><a id="209" class="Symbol">)</a>
<a id="211" class="Keyword">open</a> <a id="216" class="Keyword">import</a> <a id="223" href="Level.html" class="Module">Level</a>                    <a id="248" class="Keyword">using</a> <a id="254" class="Symbol">(</a><a id="255" href="Level.html#451" class="InductiveConstructor">lift</a><a id="259" class="Symbol">;</a> <a id="261" href="Level.html#464" class="Field">lower</a><a id="266" class="Symbol">;</a> <a id="268" href="Agda.Primitive.html#657" class="Primitive Operator">_⊔_</a><a id="271" class="Symbol">)</a>
<a id="273" class="Keyword">open</a> <a id="278" class="Keyword">import</a> <a id="285" href="Data.Unit.html" class="Module">Data.Unit</a>                <a id="310" class="Keyword">using</a> <a id="316" class="Symbol">(</a><a id="317" href="Agda.Builtin.Unit.html#106" class="InductiveConstructor">tt</a><a id="319" class="Symbol">)</a>
<a id="321" class="Keyword">open</a> <a id="326" class="Keyword">import</a> <a id="333" href="Data.List.html" class="Module">Data.List</a>                <a id="358" class="Keyword">using</a> <a id="364" class="Symbol">(</a><a id="365" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">_∷_</a><a id="368" class="Symbol">;</a> <a id="370" href="Data.List.Base.html#9851" class="InductiveConstructor">[]</a><a id="372" class="Symbol">;</a> <a id="374" href="Agda.Builtin.List.html#80" class="Datatype">List</a><a id="378" class="Symbol">;</a> <a id="380" href="Data.List.Base.html#3588" class="Function">foldr</a><a id="385" class="Symbol">)</a>
<a id="387" class="Keyword">open</a> <a id="392" class="Keyword">import</a> <a id="399" href="Data.Nat.html" class="Module">Data.Nat</a>            <a id="419" class="Symbol">as</a> <a id="422" class="Module">ℕ</a> <a id="424" class="Keyword">using</a> <a id="430" class="Symbol">(</a><a id="431" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a><a id="432" class="Symbol">;</a> <a id="434" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a><a id="437" class="Symbol">;</a> <a id="439" href="Agda.Builtin.Nat.html#115" class="InductiveConstructor">zero</a><a id="443" class="Symbol">)</a>
<a id="445" class="Keyword">open</a> <a id="450" class="Keyword">import</a> <a id="457" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a>      <a id="482" class="Keyword">using</a> <a id="488" class="Symbol">(</a><a id="489" href="Data.Nat.Properties.html#7514" class="Function">z≤′n</a><a id="493" class="Symbol">)</a>
<a id="495" class="Keyword">open</a> <a id="500" class="Keyword">import</a> <a id="507" href="Data.Product.html" class="Module">Data.Product</a>             <a id="532" class="Keyword">using</a> <a id="538" class="Symbol">(</a><a id="539" href="Data.Product.html#1389" class="Function Operator">_×_</a><a id="542" class="Symbol">;</a> <a id="544" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">_,_</a><a id="547" class="Symbol">;</a> <a id="549" href="Data.Product.html#2369" class="Function">map₁</a><a id="553" class="Symbol">;</a> <a id="555" href="Data.Product.html#3227" class="Function">curry</a><a id="560" class="Symbol">;</a> <a id="562" href="Data.Product.html#3500" class="Function">uncurry</a><a id="569" class="Symbol">)</a>
<a id="571" class="Keyword">open</a> <a id="576" class="Keyword">import</a> <a id="583" href="Data.Maybe.html" class="Module">Data.Maybe</a>               <a id="608" class="Keyword">using</a> <a id="614" class="Symbol">(</a><a id="615" href="Data.Maybe.Base.html#748" class="InductiveConstructor">just</a><a id="619" class="Symbol">;</a> <a id="621" href="Data.Maybe.Base.html#778" class="InductiveConstructor">nothing</a><a id="628" class="Symbol">)</a>
<a id="630" class="Keyword">open</a> <a id="635" class="Keyword">import</a> <a id="642" href="Data.Bool.html" class="Module">Data.Bool</a>                <a id="667" class="Keyword">using</a> <a id="673" class="Symbol">(</a><a id="674" href="Data.Bool.Base.html#835" class="Function Operator">if_then_else_</a><a id="687" class="Symbol">;</a> <a id="689" href="Agda.Builtin.Bool.html#92" class="InductiveConstructor">true</a><a id="693" class="Symbol">;</a> <a id="695" href="Agda.Builtin.Bool.html#86" class="InductiveConstructor">false</a><a id="700" class="Symbol">)</a>

<a id="703" class="Keyword">open</a> <a id="708" class="Keyword">import</a> <a id="715" href="Function.html" class="Module">Function</a>

<a id="725" class="Keyword">open</a> <a id="730" class="Keyword">import</a> <a id="737" href="Polynomial.NormalForm.InjectionIndex.html" class="Module">Polynomial.NormalForm.InjectionIndex</a>
<a id="774" class="Keyword">open</a> <a id="779" class="Keyword">import</a> <a id="786" href="Polynomial.NormalForm.Definition.html" class="Module">Polynomial.NormalForm.Definition</a> <a id="819" href="Polynomial.NormalForm.Construction.html#123" class="Bound">coeffs</a>

<a id="827" class="Keyword">open</a> <a id="832" href="Polynomial.Parameters.html#562" class="Module">RawCoeff</a> <a id="841" href="Polynomial.NormalForm.Construction.html#123" class="Bound">coeffs</a>

<a id="849" class="Comment">----------------------------------------------------------------------</a>
<a id="920" class="Comment">-- Construction</a>
<a id="936" class="Comment">--</a>
<a id="939" class="Comment">-- Because the polynomial is stored in a canonical form, we use a</a>
<a id="1005" class="Comment">-- normalising cons operator to construct the coefficient lists.</a>
<a id="1070" class="Comment">----------------------------------------------------------------------</a>

<a id="1142" class="Comment">-- Decision procedure for Zero</a>
<a id="zero?"></a><a id="1173" href="Polynomial.NormalForm.Construction.html#1173" class="Function">zero?</a> <a id="1179" class="Symbol">:</a> <a id="1181" class="Symbol">∀</a> <a id="1183" class="Symbol">{</a><a id="1184" href="Polynomial.NormalForm.Construction.html#1184" class="Bound">n</a><a id="1185" class="Symbol">}</a> <a id="1187" class="Symbol">→</a> <a id="1189" class="Symbol">(</a><a id="1190" href="Polynomial.NormalForm.Construction.html#1190" class="Bound">p</a> <a id="1192" class="Symbol">:</a> <a id="1194" href="Polynomial.NormalForm.Definition.html#1078" class="Record">Poly</a> <a id="1199" href="Polynomial.NormalForm.Construction.html#1184" class="Bound">n</a><a id="1200" class="Symbol">)</a> <a id="1202" class="Symbol">→</a> <a id="1204" href="Relation.Nullary.html#570" class="Datatype">Dec</a> <a id="1208" class="Symbol">(</a><a id="1209" href="Polynomial.NormalForm.Definition.html#2248" class="Function">Zero</a> <a id="1214" href="Polynomial.NormalForm.Construction.html#1190" class="Bound">p</a><a id="1215" class="Symbol">)</a>
<a id="1217" href="Polynomial.NormalForm.Construction.html#1173" class="Function">zero?</a> <a id="1223" class="Symbol">(</a><a id="1224" href="Polynomial.NormalForm.Definition.html#1279" class="InductiveConstructor">Σ</a> <a id="1226" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>      <a id="1234" href="Polynomial.NormalForm.Definition.html#1135" class="InductiveConstructor Operator">Π</a> <a id="1236" class="Symbol">_)</a> <a id="1239" class="Symbol">=</a> <a id="1241" href="Relation.Nullary.html#606" class="InductiveConstructor">yes</a> <a id="1245" href="Agda.Builtin.Unit.html#106" class="InductiveConstructor">tt</a>
<a id="1248" href="Polynomial.NormalForm.Construction.html#1173" class="Function">zero?</a> <a id="1254" class="Symbol">(</a><a id="1255" href="Polynomial.NormalForm.Definition.html#1279" class="InductiveConstructor">Σ</a> <a id="1257" class="Symbol">(_</a> <a id="1260" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="1262" class="Symbol">_)</a> <a id="1265" href="Polynomial.NormalForm.Definition.html#1135" class="InductiveConstructor Operator">Π</a> <a id="1267" class="Symbol">_)</a> <a id="1270" class="Symbol">=</a> <a id="1272" href="Relation.Nullary.html#633" class="InductiveConstructor">no</a> <a id="1275" class="Symbol">(λ</a> <a id="1278" href="Polynomial.NormalForm.Construction.html#1278" class="Bound">z</a> <a id="1280" class="Symbol">→</a> <a id="1282" href="Polynomial.NormalForm.Construction.html#1278" class="Bound">z</a><a id="1283" class="Symbol">)</a>
<a id="1285" href="Polynomial.NormalForm.Construction.html#1173" class="Function">zero?</a> <a id="1291" class="Symbol">(</a><a id="1292" href="Polynomial.NormalForm.Definition.html#1247" class="InductiveConstructor">Κ</a> <a id="1294" href="Polynomial.NormalForm.Construction.html#1294" class="Bound">x</a>       <a id="1302" href="Polynomial.NormalForm.Definition.html#1135" class="InductiveConstructor Operator">Π</a> <a id="1304" class="Symbol">_)</a> <a id="1307" class="Keyword">with</a> <a id="1312" href="Polynomial.Parameters.html#629" class="Field">Zero-C</a> <a id="1319" href="Polynomial.NormalForm.Construction.html#1294" class="Bound">x</a>
<a id="1321" class="Symbol">...</a> <a id="1325" class="Symbol">|</a> <a id="1327" href="Agda.Builtin.Bool.html#92" class="InductiveConstructor">true</a> <a id="1332" class="Symbol">=</a> <a id="1334" href="Relation.Nullary.html#606" class="InductiveConstructor">yes</a> <a id="1338" href="Agda.Builtin.Unit.html#106" class="InductiveConstructor">tt</a>
<a id="1341" class="Symbol">...</a> <a id="1345" class="Symbol">|</a> <a id="1347" href="Agda.Builtin.Bool.html#86" class="InductiveConstructor">false</a> <a id="1353" class="Symbol">=</a> <a id="1355" href="Relation.Nullary.html#633" class="InductiveConstructor">no</a> <a id="1358" class="Symbol">(λ</a> <a id="1361" href="Polynomial.NormalForm.Construction.html#1361" class="Bound">z</a> <a id="1363" class="Symbol">→</a> <a id="1365" href="Polynomial.NormalForm.Construction.html#1361" class="Bound">z</a><a id="1366" class="Symbol">)</a>
<a id="1368" class="Symbol">{-#</a> <a id="1372" class="Keyword">INLINE</a> <a id="1379" href="Polynomial.NormalForm.Construction.html#1173" class="Function">zero?</a> <a id="1385" class="Symbol">#-}</a>

<a id="1390" class="Comment">-- Exponentiate the first variable of a polynomial</a>
<a id="1441" class="Keyword">infixr</a> <a id="1448" class="Number">8</a> <a id="1450" href="Polynomial.NormalForm.Construction.html#1454" class="Function Operator">_⍓_</a>
<a id="_⍓_"></a><a id="1454" href="Polynomial.NormalForm.Construction.html#1454" class="Function Operator">_⍓_</a> <a id="1458" class="Symbol">:</a> <a id="1460" class="Symbol">∀</a> <a id="1462" class="Symbol">{</a><a id="1463" href="Polynomial.NormalForm.Construction.html#1463" class="Bound">n</a><a id="1464" class="Symbol">}</a> <a id="1466" class="Symbol">→</a> <a id="1468" href="Polynomial.NormalForm.Definition.html#1777" class="Function">Coeffs</a> <a id="1475" href="Polynomial.NormalForm.Construction.html#1463" class="Bound">n</a> <a id="1477" class="Symbol">→</a> <a id="1479" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="1481" class="Symbol">→</a> <a id="1483" href="Polynomial.NormalForm.Definition.html#1777" class="Function">Coeffs</a> <a id="1490" href="Polynomial.NormalForm.Construction.html#1463" class="Bound">n</a>
<a id="1492" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a> <a id="1495" href="Polynomial.NormalForm.Construction.html#1454" class="Function Operator">⍓</a> <a id="1497" href="Polynomial.NormalForm.Construction.html#1497" class="Bound">i</a> <a id="1499" class="Symbol">=</a> <a id="1501" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>
<a id="1504" class="Symbol">(</a><a id="1505" href="Polynomial.NormalForm.Construction.html#1505" class="Bound">x</a> <a id="1507" href="Polynomial.NormalForm.Definition.html#896" class="InductiveConstructor Operator">Δ</a> <a id="1509" href="Polynomial.NormalForm.Construction.html#1509" class="Bound">j</a> <a id="1511" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="1513" href="Polynomial.NormalForm.Construction.html#1513" class="Bound">xs</a><a id="1515" class="Symbol">)</a> <a id="1517" href="Polynomial.NormalForm.Construction.html#1454" class="Function Operator">⍓</a> <a id="1519" href="Polynomial.NormalForm.Construction.html#1519" class="Bound">i</a> <a id="1521" class="Symbol">=</a> <a id="1523" href="Polynomial.NormalForm.Construction.html#1505" class="Bound">x</a> <a id="1525" href="Polynomial.NormalForm.Definition.html#896" class="InductiveConstructor Operator">Δ</a> <a id="1527" class="Symbol">(</a><a id="1528" href="Polynomial.NormalForm.Construction.html#1509" class="Bound">j</a> <a id="1530" href="Agda.Builtin.Nat.html#230" class="Primitive Operator">ℕ.+</a> <a id="1534" href="Polynomial.NormalForm.Construction.html#1519" class="Bound">i</a><a id="1535" class="Symbol">)</a> <a id="1537" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="1539" href="Polynomial.NormalForm.Construction.html#1513" class="Bound">xs</a>

<a id="1543" class="Keyword">infixr</a> <a id="1550" class="Number">5</a> <a id="1552" href="Polynomial.NormalForm.Construction.html#1557" class="Function Operator">_∷↓_</a>
<a id="_∷↓_"></a><a id="1557" href="Polynomial.NormalForm.Construction.html#1557" class="Function Operator">_∷↓_</a> <a id="1562" class="Symbol">:</a> <a id="1564" class="Symbol">∀</a> <a id="1566" class="Symbol">{</a><a id="1567" href="Polynomial.NormalForm.Construction.html#1567" class="Bound">n</a><a id="1568" class="Symbol">}</a> <a id="1570" class="Symbol">→</a> <a id="1572" href="Polynomial.NormalForm.Definition.html#833" class="Record">PowInd</a> <a id="1579" class="Symbol">(</a><a id="1580" href="Polynomial.NormalForm.Definition.html#1078" class="Record">Poly</a> <a id="1585" href="Polynomial.NormalForm.Construction.html#1567" class="Bound">n</a><a id="1586" class="Symbol">)</a> <a id="1588" class="Symbol">→</a> <a id="1590" href="Polynomial.NormalForm.Definition.html#1777" class="Function">Coeffs</a> <a id="1597" href="Polynomial.NormalForm.Construction.html#1567" class="Bound">n</a> <a id="1599" class="Symbol">→</a> <a id="1601" href="Polynomial.NormalForm.Definition.html#1777" class="Function">Coeffs</a> <a id="1608" href="Polynomial.NormalForm.Construction.html#1567" class="Bound">n</a>
<a id="1610" href="Polynomial.NormalForm.Construction.html#1610" class="Bound">x</a> <a id="1612" href="Polynomial.NormalForm.Definition.html#896" class="InductiveConstructor Operator">Δ</a> <a id="1614" href="Polynomial.NormalForm.Construction.html#1614" class="Bound">i</a> <a id="1616" href="Polynomial.NormalForm.Construction.html#1557" class="Function Operator">∷↓</a> <a id="1619" href="Polynomial.NormalForm.Construction.html#1619" class="Bound">xs</a> <a id="1622" class="Symbol">=</a> <a id="1624" href="Function.html#3533" class="Function Operator">case</a> <a id="1629" href="Polynomial.NormalForm.Construction.html#1173" class="Function">zero?</a> <a id="1635" href="Polynomial.NormalForm.Construction.html#1610" class="Bound">x</a> <a id="1637" href="Function.html#3533" class="Function Operator">of</a>
  <a id="1642" class="Symbol">λ</a> <a id="1644" class="Symbol">{</a> <a id="1646" class="Symbol">(</a><a id="1647" href="Relation.Nullary.html#606" class="InductiveConstructor">yes</a> <a id="1651" href="Polynomial.NormalForm.Construction.html#1651" class="Bound">p</a><a id="1652" class="Symbol">)</a> <a id="1654" class="Symbol">→</a> <a id="1656" href="Polynomial.NormalForm.Construction.html#1619" class="Bound">xs</a> <a id="1659" href="Polynomial.NormalForm.Construction.html#1454" class="Function Operator">⍓</a> <a id="1661" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="1665" href="Polynomial.NormalForm.Construction.html#1614" class="Bound">i</a>
    <a id="1671" class="Symbol">;</a> <a id="1673" class="Symbol">(</a><a id="1674" href="Relation.Nullary.html#633" class="InductiveConstructor">no</a> <a id="1677" href="Polynomial.NormalForm.Construction.html#1677" class="Bound">¬p</a><a id="1679" class="Symbol">)</a> <a id="1681" class="Symbol">→</a> <a id="1683" href="Polynomial.NormalForm.Definition.html#2059" class="InductiveConstructor Operator">_≠0</a> <a id="1687" href="Polynomial.NormalForm.Construction.html#1610" class="Bound">x</a> <a id="1689" class="Symbol">{</a><a id="1690" href="Polynomial.NormalForm.Construction.html#1677" class="Bound">¬p</a><a id="1692" class="Symbol">}</a> <a id="1694" href="Polynomial.NormalForm.Definition.html#896" class="InductiveConstructor Operator">Δ</a> <a id="1696" href="Polynomial.NormalForm.Construction.html#1614" class="Bound">i</a> <a id="1698" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="1700" href="Polynomial.NormalForm.Construction.html#1619" class="Bound">xs</a>
    <a id="1707" class="Symbol">}</a>
<a id="1709" class="Symbol">{-#</a> <a id="1713" class="Keyword">INLINE</a> <a id="1720" href="Polynomial.NormalForm.Construction.html#1557" class="Function Operator">_∷↓_</a> <a id="1725" class="Symbol">#-}</a>

<a id="1730" class="Comment">-- Inject a polynomial into a larger polynomoial with more variables</a>
<a id="_Π↑_"></a><a id="1799" href="Polynomial.NormalForm.Construction.html#1799" class="Function Operator">_Π↑_</a> <a id="1804" class="Symbol">:</a> <a id="1806" class="Symbol">∀</a> <a id="1808" class="Symbol">{</a><a id="1809" href="Polynomial.NormalForm.Construction.html#1809" class="Bound">n</a> <a id="1811" href="Polynomial.NormalForm.Construction.html#1811" class="Bound">m</a><a id="1812" class="Symbol">}</a> <a id="1814" class="Symbol">→</a> <a id="1816" href="Polynomial.NormalForm.Definition.html#1078" class="Record">Poly</a> <a id="1821" href="Polynomial.NormalForm.Construction.html#1809" class="Bound">n</a> <a id="1823" class="Symbol">→</a> <a id="1825" class="Symbol">(</a><a id="1826" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="1830" href="Polynomial.NormalForm.Construction.html#1809" class="Bound">n</a> <a id="1832" href="Data.Nat.Base.html#2376" class="Datatype Operator">≤′</a> <a id="1835" href="Polynomial.NormalForm.Construction.html#1811" class="Bound">m</a><a id="1836" class="Symbol">)</a> <a id="1838" class="Symbol">→</a> <a id="1840" href="Polynomial.NormalForm.Definition.html#1078" class="Record">Poly</a> <a id="1845" href="Polynomial.NormalForm.Construction.html#1811" class="Bound">m</a>
<a id="1847" class="Symbol">(</a><a id="1848" href="Polynomial.NormalForm.Construction.html#1848" class="Bound">xs</a> <a id="1851" href="Polynomial.NormalForm.Definition.html#1135" class="InductiveConstructor Operator">Π</a> <a id="1853" href="Polynomial.NormalForm.Construction.html#1853" class="Bound">i≤n</a><a id="1856" class="Symbol">)</a> <a id="1858" href="Polynomial.NormalForm.Construction.html#1799" class="Function Operator">Π↑</a> <a id="1861" href="Polynomial.NormalForm.Construction.html#1861" class="Bound">n≤m</a> <a id="1865" class="Symbol">=</a> <a id="1867" href="Polynomial.NormalForm.Construction.html#1848" class="Bound">xs</a> <a id="1870" href="Polynomial.NormalForm.Definition.html#1135" class="InductiveConstructor Operator">Π</a> <a id="1872" class="Symbol">(</a><a id="1873" href="Data.Nat.Base.html#2450" class="InductiveConstructor">≤′-step</a> <a id="1881" href="Polynomial.NormalForm.Construction.html#1853" class="Bound">i≤n</a> <a id="1885" href="Function.html#2548" class="Function Operator">⟨</a> <a id="1887" href="Data.Nat.Properties.html#7403" class="Function">≤′-trans</a> <a id="1896" href="Function.html#2548" class="Function Operator">⟩</a> <a id="1898" href="Polynomial.NormalForm.Construction.html#1861" class="Bound">n≤m</a><a id="1901" class="Symbol">)</a>
<a id="1903" class="Symbol">{-#</a> <a id="1907" class="Keyword">INLINE</a> <a id="1914" href="Polynomial.NormalForm.Construction.html#1799" class="Function Operator">_Π↑_</a> <a id="1919" class="Symbol">#-}</a>

<a id="1924" class="Comment">-- NormalForm.sing Π</a>
<a id="1945" class="Keyword">infixr</a> <a id="1952" class="Number">4</a> <a id="1954" href="Polynomial.NormalForm.Construction.html#1959" class="Function Operator">_Π↓_</a>
<a id="_Π↓_"></a><a id="1959" href="Polynomial.NormalForm.Construction.html#1959" class="Function Operator">_Π↓_</a> <a id="1964" class="Symbol">:</a> <a id="1966" class="Symbol">∀</a> <a id="1968" class="Symbol">{</a><a id="1969" href="Polynomial.NormalForm.Construction.html#1969" class="Bound">i</a> <a id="1971" href="Polynomial.NormalForm.Construction.html#1971" class="Bound">n</a><a id="1972" class="Symbol">}</a> <a id="1974" class="Symbol">→</a> <a id="1976" href="Polynomial.NormalForm.Definition.html#1777" class="Function">Coeffs</a> <a id="1983" href="Polynomial.NormalForm.Construction.html#1969" class="Bound">i</a> <a id="1985" class="Symbol">→</a> <a id="1987" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="1991" href="Polynomial.NormalForm.Construction.html#1969" class="Bound">i</a> <a id="1993" href="Data.Nat.Base.html#2376" class="Datatype Operator">≤′</a> <a id="1996" href="Polynomial.NormalForm.Construction.html#1971" class="Bound">n</a> <a id="1998" class="Symbol">→</a> <a id="2000" href="Polynomial.NormalForm.Definition.html#1078" class="Record">Poly</a> <a id="2005" href="Polynomial.NormalForm.Construction.html#1971" class="Bound">n</a>
<a id="2007" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>                       <a id="2032" href="Polynomial.NormalForm.Construction.html#1959" class="Function Operator">Π↓</a> <a id="2035" href="Polynomial.NormalForm.Construction.html#2035" class="Bound">i≤n</a> <a id="2039" class="Symbol">=</a> <a id="2041" href="Polynomial.NormalForm.Definition.html#1247" class="InductiveConstructor">Κ</a> <a id="2043" href="Algebra.html#12353" class="Function">0#</a> <a id="2046" href="Polynomial.NormalForm.Definition.html#1135" class="InductiveConstructor Operator">Π</a> <a id="2048" href="Data.Nat.Properties.html#7514" class="Function">z≤′n</a>
<a id="2053" class="Symbol">(</a><a id="2054" href="Polynomial.NormalForm.Construction.html#2054" class="Bound">x</a> <a id="2056" href="Polynomial.NormalForm.Definition.html#2059" class="InductiveConstructor Operator">≠0</a> <a id="2059" href="Polynomial.NormalForm.Definition.html#896" class="InductiveConstructor Operator">Δ</a> <a id="2061" href="Agda.Builtin.Nat.html#115" class="InductiveConstructor">zero</a>  <a id="2067" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="2069" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="2071" class="Symbol">)</a>      <a id="2078" href="Polynomial.NormalForm.Construction.html#1959" class="Function Operator">Π↓</a> <a id="2081" href="Polynomial.NormalForm.Construction.html#2081" class="Bound">i≤n</a> <a id="2085" class="Symbol">=</a> <a id="2087" href="Polynomial.NormalForm.Construction.html#2054" class="Bound">x</a> <a id="2089" href="Polynomial.NormalForm.Construction.html#1799" class="Function Operator">Π↑</a> <a id="2092" href="Polynomial.NormalForm.Construction.html#2081" class="Bound">i≤n</a>
<a id="2096" class="Symbol">(</a><a id="2097" href="Polynomial.NormalForm.Construction.html#2097" class="Bound">x₁</a>   <a id="2102" href="Polynomial.NormalForm.Definition.html#896" class="InductiveConstructor Operator">Δ</a> <a id="2104" href="Agda.Builtin.Nat.html#115" class="InductiveConstructor">zero</a>  <a id="2110" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="2112" href="Polynomial.NormalForm.Construction.html#2112" class="Bound">x₂</a> <a id="2115" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="2117" href="Polynomial.NormalForm.Construction.html#2117" class="Bound">xs</a><a id="2119" class="Symbol">)</a> <a id="2121" href="Polynomial.NormalForm.Construction.html#1959" class="Function Operator">Π↓</a> <a id="2124" href="Polynomial.NormalForm.Construction.html#2124" class="Bound">i≤n</a> <a id="2128" class="Symbol">=</a> <a id="2130" href="Polynomial.NormalForm.Definition.html#1279" class="InductiveConstructor">Σ</a> <a id="2132" class="Symbol">(</a><a id="2133" href="Polynomial.NormalForm.Construction.html#2097" class="Bound">x₁</a> <a id="2136" href="Polynomial.NormalForm.Definition.html#896" class="InductiveConstructor Operator">Δ</a> <a id="2138" href="Agda.Builtin.Nat.html#115" class="InductiveConstructor">zero</a>  <a id="2144" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="2146" href="Polynomial.NormalForm.Construction.html#2112" class="Bound">x₂</a> <a id="2149" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="2151" href="Polynomial.NormalForm.Construction.html#2117" class="Bound">xs</a><a id="2153" class="Symbol">)</a> <a id="2155" href="Polynomial.NormalForm.Definition.html#1135" class="InductiveConstructor Operator">Π</a> <a id="2157" href="Polynomial.NormalForm.Construction.html#2124" class="Bound">i≤n</a>
<a id="2161" class="Symbol">(</a><a id="2162" href="Polynomial.NormalForm.Construction.html#2162" class="Bound">x</a>    <a id="2167" href="Polynomial.NormalForm.Definition.html#896" class="InductiveConstructor Operator">Δ</a> <a id="2169" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="2173" href="Polynomial.NormalForm.Construction.html#2173" class="Bound">j</a> <a id="2175" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="2177" href="Polynomial.NormalForm.Construction.html#2177" class="Bound">xs</a><a id="2179" class="Symbol">)</a>      <a id="2186" href="Polynomial.NormalForm.Construction.html#1959" class="Function Operator">Π↓</a> <a id="2189" href="Polynomial.NormalForm.Construction.html#2189" class="Bound">i≤n</a> <a id="2193" class="Symbol">=</a> <a id="2195" href="Polynomial.NormalForm.Definition.html#1279" class="InductiveConstructor">Σ</a> <a id="2197" class="Symbol">(</a><a id="2198" href="Polynomial.NormalForm.Construction.html#2162" class="Bound">x</a>  <a id="2201" href="Polynomial.NormalForm.Definition.html#896" class="InductiveConstructor Operator">Δ</a> <a id="2203" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="2207" href="Polynomial.NormalForm.Construction.html#2173" class="Bound">j</a> <a id="2209" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="2211" href="Polynomial.NormalForm.Construction.html#2177" class="Bound">xs</a><a id="2213" class="Symbol">)</a> <a id="2215" href="Polynomial.NormalForm.Definition.html#1135" class="InductiveConstructor Operator">Π</a> <a id="2217" href="Polynomial.NormalForm.Construction.html#2189" class="Bound">i≤n</a>
<a id="2221" class="Symbol">{-#</a> <a id="2225" class="Keyword">INLINE</a> <a id="2232" href="Polynomial.NormalForm.Construction.html#1959" class="Function Operator">_Π↓_</a> <a id="2237" class="Symbol">#-}</a>

<a id="2242" class="Comment">--------------------------------------------------------------------------------</a>
<a id="2323" class="Comment">-- These folds allow us to abstract over the proofs later: we try to avoid</a>
<a id="2398" class="Comment">-- using ∷↓ and Π↓ directly anywhere except here, so if we prove that this fold</a>
<a id="2478" class="Comment">-- acts the same on a normalised or non-normalised polynomial, we can prove th</a>
<a id="2557" class="Comment">-- same about any operation which uses it.</a>
<a id="PolyF"></a><a id="2600" href="Polynomial.NormalForm.Construction.html#2600" class="Function">PolyF</a> <a id="2606" class="Symbol">:</a> <a id="2608" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="2610" class="Symbol">→</a> <a id="2612" class="PrimitiveType">Set</a> <a id="2616" href="Polynomial.NormalForm.Construction.html#117" class="Bound">a</a>
<a id="2618" href="Polynomial.NormalForm.Construction.html#2600" class="Function">PolyF</a> <a id="2624" href="Polynomial.NormalForm.Construction.html#2624" class="Bound">i</a> <a id="2626" class="Symbol">=</a> <a id="2628" href="Polynomial.NormalForm.Definition.html#1078" class="Record">Poly</a> <a id="2633" href="Polynomial.NormalForm.Construction.html#2624" class="Bound">i</a> <a id="2635" href="Data.Product.html#1389" class="Function Operator">×</a> <a id="2637" href="Polynomial.NormalForm.Definition.html#1777" class="Function">Coeffs</a> <a id="2644" href="Polynomial.NormalForm.Construction.html#2624" class="Bound">i</a>

<a id="Fold"></a><a id="2647" href="Polynomial.NormalForm.Construction.html#2647" class="Function">Fold</a> <a id="2652" class="Symbol">:</a> <a id="2654" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="2656" class="Symbol">→</a> <a id="2658" class="PrimitiveType">Set</a> <a id="2662" href="Polynomial.NormalForm.Construction.html#117" class="Bound">a</a>
<a id="2664" href="Polynomial.NormalForm.Construction.html#2647" class="Function">Fold</a> <a id="2669" href="Polynomial.NormalForm.Construction.html#2669" class="Bound">i</a> <a id="2671" class="Symbol">=</a> <a id="2673" href="Polynomial.NormalForm.Construction.html#2600" class="Function">PolyF</a> <a id="2679" href="Polynomial.NormalForm.Construction.html#2669" class="Bound">i</a> <a id="2681" class="Symbol">→</a> <a id="2683" href="Polynomial.NormalForm.Construction.html#2600" class="Function">PolyF</a> <a id="2689" href="Polynomial.NormalForm.Construction.html#2669" class="Bound">i</a>

<a id="para"></a><a id="2692" href="Polynomial.NormalForm.Construction.html#2692" class="Function">para</a> <a id="2697" class="Symbol">:</a> <a id="2699" class="Symbol">∀</a> <a id="2701" class="Symbol">{</a><a id="2702" href="Polynomial.NormalForm.Construction.html#2702" class="Bound">i</a><a id="2703" class="Symbol">}</a> <a id="2705" class="Symbol">→</a> <a id="2707" href="Polynomial.NormalForm.Construction.html#2647" class="Function">Fold</a> <a id="2712" href="Polynomial.NormalForm.Construction.html#2702" class="Bound">i</a> <a id="2714" class="Symbol">→</a> <a id="2716" href="Polynomial.NormalForm.Definition.html#1777" class="Function">Coeffs</a> <a id="2723" href="Polynomial.NormalForm.Construction.html#2702" class="Bound">i</a> <a id="2725" class="Symbol">→</a> <a id="2727" href="Polynomial.NormalForm.Definition.html#1777" class="Function">Coeffs</a> <a id="2734" href="Polynomial.NormalForm.Construction.html#2702" class="Bound">i</a>
<a id="2736" href="Polynomial.NormalForm.Construction.html#2692" class="Function">para</a> <a id="2741" href="Polynomial.NormalForm.Construction.html#2741" class="Bound">f</a> <a id="2743" class="Symbol">=</a> <a id="2745" href="Data.List.Base.html#3588" class="Function">foldr</a> <a id="2751" class="Symbol">(λ</a> <a id="2754" class="Symbol">{</a> <a id="2756" class="Symbol">(</a><a id="2757" href="Polynomial.NormalForm.Construction.html#2757" class="Bound">x</a> <a id="2759" href="Polynomial.NormalForm.Definition.html#2059" class="InductiveConstructor Operator">≠0</a> <a id="2762" href="Polynomial.NormalForm.Definition.html#896" class="InductiveConstructor Operator">Δ</a> <a id="2764" href="Polynomial.NormalForm.Construction.html#2764" class="Bound">i</a><a id="2765" class="Symbol">)</a> <a id="2767" href="Polynomial.NormalForm.Construction.html#2767" class="Bound">xs</a> <a id="2770" class="Symbol">→</a> <a id="2772" href="Function.html#3533" class="Function Operator">case</a> <a id="2777" class="Symbol">(</a><a id="2778" href="Polynomial.NormalForm.Construction.html#2741" class="Bound">f</a> <a id="2780" class="Symbol">(</a><a id="2781" href="Polynomial.NormalForm.Construction.html#2757" class="Bound">x</a> <a id="2783" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="2785" href="Polynomial.NormalForm.Construction.html#2767" class="Bound">xs</a><a id="2787" class="Symbol">))</a> <a id="2790" href="Function.html#3533" class="Function Operator">of</a> <a id="2793" class="Symbol">λ</a> <a id="2795" class="Symbol">{</a> <a id="2797" class="Symbol">(</a><a id="2798" href="Polynomial.NormalForm.Construction.html#2798" class="Bound">y</a> <a id="2800" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="2802" href="Polynomial.NormalForm.Construction.html#2802" class="Bound">ys</a><a id="2804" class="Symbol">)</a> <a id="2806" class="Symbol">→</a> <a id="2808" class="Symbol">(</a><a id="2809" href="Polynomial.NormalForm.Construction.html#2798" class="Bound">y</a> <a id="2811" href="Polynomial.NormalForm.Definition.html#896" class="InductiveConstructor Operator">Δ</a> <a id="2813" href="Polynomial.NormalForm.Construction.html#2764" class="Bound">i</a><a id="2814" class="Symbol">)</a> <a id="2816" href="Polynomial.NormalForm.Construction.html#1557" class="Function Operator">∷↓</a> <a id="2819" href="Polynomial.NormalForm.Construction.html#2802" class="Bound">ys</a> <a id="2822" class="Symbol">}})</a> <a id="2826" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>
<a id="2829" class="Symbol">{-#</a> <a id="2833" class="Keyword">INLINE</a> <a id="2840" href="Polynomial.NormalForm.Construction.html#2692" class="Function">para</a> <a id="2845" class="Symbol">#-}</a>

<a id="poly-map"></a><a id="2850" href="Polynomial.NormalForm.Construction.html#2850" class="Function">poly-map</a> <a id="2859" class="Symbol">:</a> <a id="2861" class="Symbol">∀</a> <a id="2863" class="Symbol">{</a><a id="2864" href="Polynomial.NormalForm.Construction.html#2864" class="Bound">i</a><a id="2865" class="Symbol">}</a> <a id="2867" class="Symbol">→</a> <a id="2869" class="Symbol">(</a><a id="2870" href="Polynomial.NormalForm.Definition.html#1078" class="Record">Poly</a> <a id="2875" href="Polynomial.NormalForm.Construction.html#2864" class="Bound">i</a> <a id="2877" class="Symbol">→</a> <a id="2879" href="Polynomial.NormalForm.Definition.html#1078" class="Record">Poly</a> <a id="2884" href="Polynomial.NormalForm.Construction.html#2864" class="Bound">i</a><a id="2885" class="Symbol">)</a> <a id="2887" class="Symbol">→</a> <a id="2889" href="Polynomial.NormalForm.Definition.html#1777" class="Function">Coeffs</a> <a id="2896" href="Polynomial.NormalForm.Construction.html#2864" class="Bound">i</a> <a id="2898" class="Symbol">→</a> <a id="2900" href="Polynomial.NormalForm.Definition.html#1777" class="Function">Coeffs</a> <a id="2907" href="Polynomial.NormalForm.Construction.html#2864" class="Bound">i</a>
<a id="2909" href="Polynomial.NormalForm.Construction.html#2850" class="Function">poly-map</a> <a id="2918" href="Polynomial.NormalForm.Construction.html#2918" class="Bound">f</a> <a id="2920" class="Symbol">=</a> <a id="2922" href="Polynomial.NormalForm.Construction.html#2692" class="Function">para</a> <a id="2927" class="Symbol">(λ</a> <a id="2930" class="Symbol">{</a> <a id="2932" class="Symbol">(</a><a id="2933" href="Polynomial.NormalForm.Construction.html#2933" class="Bound">x</a> <a id="2935" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="2937" href="Polynomial.NormalForm.Construction.html#2937" class="Bound">y</a><a id="2938" class="Symbol">)</a> <a id="2940" class="Symbol">→</a> <a id="2942" class="Symbol">(</a><a id="2943" href="Polynomial.NormalForm.Construction.html#2918" class="Bound">f</a> <a id="2945" href="Polynomial.NormalForm.Construction.html#2933" class="Bound">x</a> <a id="2947" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="2949" href="Polynomial.NormalForm.Construction.html#2937" class="Bound">y</a><a id="2950" class="Symbol">)})</a>
<a id="2954" class="Symbol">{-#</a> <a id="2958" class="Keyword">INLINE</a> <a id="2965" href="Polynomial.NormalForm.Construction.html#2850" class="Function">poly-map</a> <a id="2974" class="Symbol">#-}</a>
</pre></body></html>