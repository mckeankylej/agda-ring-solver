<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Data.List.Kleene</title><link rel="stylesheet" href="Agda.css"></head><body><pre><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Option">--without-K</a> <a id="25" class="Option">--safe</a> <a id="32" class="Symbol">#-}</a>

<a id="37" class="Keyword">module</a> <a id="44" href="Data.List.Kleene.html" class="Module">Data.List.Kleene</a> <a id="61" class="Keyword">where</a>

<a id="68" class="Comment">-- This module provides a different definition of lists based on the kleene</a>
<a id="144" class="Comment">-- star and plus.</a>

<a id="163" class="Keyword">mutual</a>
  <a id="172" class="Keyword">data</a> <a id="_⋆"></a><a id="177" href="Data.List.Kleene.html#177" class="Datatype Operator">_⋆</a> <a id="180" class="Symbol">{</a><a id="181" href="Data.List.Kleene.html#181" class="Bound">a</a><a id="182" class="Symbol">}</a> <a id="184" class="Symbol">(</a><a id="185" href="Data.List.Kleene.html#185" class="Bound">A</a> <a id="187" class="Symbol">:</a> <a id="189" class="PrimitiveType">Set</a> <a id="193" href="Data.List.Kleene.html#181" class="Bound">a</a><a id="194" class="Symbol">)</a> <a id="196" class="Symbol">:</a> <a id="198" class="PrimitiveType">Set</a> <a id="202" href="Data.List.Kleene.html#181" class="Bound">a</a> <a id="204" class="Keyword">where</a>
    <a id="_⋆.[]"></a><a id="214" href="Data.List.Kleene.html#214" class="InductiveConstructor">[]</a>  <a id="218" class="Symbol">:</a> <a id="220" href="Data.List.Kleene.html#185" class="Bound">A</a> <a id="222" href="Data.List.Kleene.html#177" class="Datatype Operator">⋆</a>
    <a id="_⋆.[_]"></a><a id="228" href="Data.List.Kleene.html#228" class="InductiveConstructor Operator">[_]</a> <a id="232" class="Symbol">:</a> <a id="234" href="Data.List.Kleene.html#185" class="Bound">A</a> <a id="236" href="Data.List.Kleene.html#269" class="Record Operator">⁺</a> <a id="238" class="Symbol">→</a> <a id="240" href="Data.List.Kleene.html#185" class="Bound">A</a> <a id="242" href="Data.List.Kleene.html#177" class="Datatype Operator">⋆</a>

  <a id="247" class="Keyword">infixr</a> <a id="254" class="Number">5</a> <a id="256" href="Data.List.Kleene.html#332" class="InductiveConstructor Operator">_&amp;_</a>
  <a id="262" class="Keyword">record</a> <a id="_⁺"></a><a id="269" href="Data.List.Kleene.html#269" class="Record Operator">_⁺</a> <a id="272" class="Symbol">{</a><a id="273" href="Data.List.Kleene.html#273" class="Bound">a</a><a id="274" class="Symbol">}</a> <a id="276" class="Symbol">(</a><a id="277" href="Data.List.Kleene.html#277" class="Bound">A</a> <a id="279" class="Symbol">:</a> <a id="281" class="PrimitiveType">Set</a> <a id="285" href="Data.List.Kleene.html#273" class="Bound">a</a><a id="286" class="Symbol">)</a> <a id="288" class="Symbol">:</a> <a id="290" class="PrimitiveType">Set</a> <a id="294" href="Data.List.Kleene.html#273" class="Bound">a</a> <a id="296" class="Keyword">where</a>
    <a id="306" class="Keyword">inductive</a>
    <a id="320" class="Keyword">constructor</a> <a id="_⁺._&amp;_"></a><a id="332" href="Data.List.Kleene.html#332" class="InductiveConstructor Operator">_&amp;_</a>
    <a id="340" class="Keyword">field</a>
      <a id="_⁺.head"></a><a id="352" href="Data.List.Kleene.html#352" class="Field">head</a> <a id="357" class="Symbol">:</a> <a id="359" href="Data.List.Kleene.html#277" class="Bound">A</a>
      <a id="_⁺.tail"></a><a id="367" href="Data.List.Kleene.html#367" class="Field">tail</a> <a id="372" class="Symbol">:</a> <a id="374" href="Data.List.Kleene.html#277" class="Bound">A</a> <a id="376" href="Data.List.Kleene.html#177" class="Datatype Operator">⋆</a>
<a id="378" class="Keyword">open</a> <a id="383" href="Data.List.Kleene.html#269" class="Module Operator">_⁺</a> <a id="386" class="Keyword">public</a>

<a id="394" class="Keyword">infixr</a> <a id="401" class="Number">5</a> <a id="403" href="Data.List.Kleene.html#415" class="InductiveConstructor Operator">_∹_</a>
<a id="407" class="Keyword">pattern</a> <a id="_∹_"></a><a id="415" href="Data.List.Kleene.html#415" class="InductiveConstructor Operator">_∹_</a> <a id="419" href="Data.List.Kleene.html#428" class="Bound">x</a> <a id="421" href="Data.List.Kleene.html#432" class="Bound">xs</a> <a id="424" class="Symbol">=</a> <a id="426" href="Data.List.Kleene.html#228" class="InductiveConstructor Operator">[</a> <a id="428" href="Data.List.Kleene.html#428" class="Bound">x</a> <a id="430" href="Data.List.Kleene.html#332" class="InductiveConstructor Operator">&amp;</a> <a id="432" href="Data.List.Kleene.html#432" class="Bound">xs</a> <a id="435" href="Data.List.Kleene.html#228" class="InductiveConstructor Operator">]</a>

<a id="438" class="Keyword">module</a> <a id="445" href="Data.List.Kleene.html#445" class="Module">_</a> <a id="447" class="Symbol">{</a><a id="448" href="Data.List.Kleene.html#448" class="Bound">a</a> <a id="450" href="Data.List.Kleene.html#450" class="Bound">b</a><a id="451" class="Symbol">}</a> <a id="453" class="Symbol">{</a><a id="454" href="Data.List.Kleene.html#454" class="Bound">A</a> <a id="456" class="Symbol">:</a> <a id="458" class="PrimitiveType">Set</a> <a id="462" href="Data.List.Kleene.html#448" class="Bound">a</a><a id="463" class="Symbol">}</a> <a id="465" class="Symbol">{</a><a id="466" href="Data.List.Kleene.html#466" class="Bound">B</a> <a id="468" class="Symbol">:</a> <a id="470" class="PrimitiveType">Set</a> <a id="474" href="Data.List.Kleene.html#450" class="Bound">b</a><a id="475" class="Symbol">}</a> <a id="477" class="Symbol">(</a><a id="478" href="Data.List.Kleene.html#478" class="Bound">f</a> <a id="480" class="Symbol">:</a> <a id="482" href="Data.List.Kleene.html#454" class="Bound">A</a> <a id="484" class="Symbol">→</a> <a id="486" href="Data.List.Kleene.html#466" class="Bound">B</a> <a id="488" class="Symbol">→</a> <a id="490" href="Data.List.Kleene.html#466" class="Bound">B</a><a id="491" class="Symbol">)</a> <a id="493" class="Symbol">(</a><a id="494" href="Data.List.Kleene.html#494" class="Bound">b</a> <a id="496" class="Symbol">:</a> <a id="498" href="Data.List.Kleene.html#466" class="Bound">B</a><a id="499" class="Symbol">)</a> <a id="501" class="Keyword">where</a>
  <a id="509" class="Keyword">mutual</a>
    <a id="520" href="Data.List.Kleene.html#520" class="Function">foldr⁺</a> <a id="527" class="Symbol">:</a> <a id="529" href="Data.List.Kleene.html#454" class="Bound">A</a> <a id="531" href="Data.List.Kleene.html#269" class="Record Operator">⁺</a> <a id="533" class="Symbol">→</a> <a id="535" href="Data.List.Kleene.html#466" class="Bound">B</a>
    <a id="541" href="Data.List.Kleene.html#520" class="Function">foldr⁺</a> <a id="548" class="Symbol">(</a><a id="549" href="Data.List.Kleene.html#549" class="Bound">x</a> <a id="551" href="Data.List.Kleene.html#332" class="InductiveConstructor Operator">&amp;</a> <a id="553" href="Data.List.Kleene.html#553" class="Bound">xs</a><a id="555" class="Symbol">)</a> <a id="557" class="Symbol">=</a> <a id="559" href="Data.List.Kleene.html#478" class="Bound">f</a> <a id="561" href="Data.List.Kleene.html#549" class="Bound">x</a> <a id="563" class="Symbol">(</a><a id="564" href="Data.List.Kleene.html#580" class="Function">foldr⋆</a> <a id="571" href="Data.List.Kleene.html#553" class="Bound">xs</a><a id="573" class="Symbol">)</a>

    <a id="580" href="Data.List.Kleene.html#580" class="Function">foldr⋆</a> <a id="587" class="Symbol">:</a> <a id="589" href="Data.List.Kleene.html#454" class="Bound">A</a> <a id="591" href="Data.List.Kleene.html#177" class="Datatype Operator">⋆</a> <a id="593" class="Symbol">→</a> <a id="595" href="Data.List.Kleene.html#466" class="Bound">B</a>
    <a id="601" href="Data.List.Kleene.html#580" class="Function">foldr⋆</a> <a id="608" href="Data.List.Kleene.html#214" class="InductiveConstructor">[]</a> <a id="611" class="Symbol">=</a> <a id="613" href="Data.List.Kleene.html#494" class="Bound">b</a>
    <a id="619" href="Data.List.Kleene.html#580" class="Function">foldr⋆</a> <a id="626" href="Data.List.Kleene.html#228" class="InductiveConstructor Operator">[</a> <a id="628" href="Data.List.Kleene.html#628" class="Bound">xs</a> <a id="631" href="Data.List.Kleene.html#228" class="InductiveConstructor Operator">]</a> <a id="633" class="Symbol">=</a> <a id="635" href="Data.List.Kleene.html#520" class="Function">foldr⁺</a> <a id="642" href="Data.List.Kleene.html#628" class="Bound">xs</a>

<a id="646" class="Comment">-- Why is this useful? What does it give us over the normal list definition?</a>
<a id="723" class="Comment">--</a>
<a id="726" class="Comment">-- As is explained in the report, one of the most import factors which gives</a>
<a id="803" class="Comment">-- us a speedup in the solver is *avoiding identities*. For instance, in</a>
<a id="876" class="Comment">-- Haskell, we might write foldMap like this (on lists):</a>
<a id="933" class="Comment">--</a>
<a id="936" class="Comment">--   foldMap _ [] = mempty</a>
<a id="963" class="Comment">--   foldMap f (x:xs) = f x &lt;&gt; foldMap f xs</a>
<a id="1007" class="Comment">--</a>
<a id="1010" class="Comment">-- To avoid mempty, we could instead write this:</a>
<a id="1059" class="Comment">--</a>
<a id="1062" class="Comment">--   foldMap _ [] = mempty</a>
<a id="1089" class="Comment">--   foldMap f [x] = f x</a>
<a id="1114" class="Comment">--   foldMap f (x:xs) = f x &lt;&gt; foldMap f xs</a>
<a id="1158" class="Comment">--</a>
<a id="1161" class="Comment">-- This avoids a mempty on nonempty lists, but does an extra pattern match.</a>
<a id="1237" class="Comment">-- For these lists, we can write:</a>
<a id="1271" class="Keyword">open</a> <a id="1276" class="Keyword">import</a> <a id="1283" href="Algebra.html" class="Module">Algebra</a>

<a id="1292" class="Keyword">module</a> <a id="1299" href="Data.List.Kleene.html#1299" class="Module">_</a> <a id="1301" class="Symbol">{</a><a id="1302" href="Data.List.Kleene.html#1302" class="Bound">m</a> <a id="1304" href="Data.List.Kleene.html#1304" class="Bound">r</a><a id="1305" class="Symbol">}</a> <a id="1307" class="Symbol">(</a><a id="1308" href="Data.List.Kleene.html#1308" class="Bound">mon</a> <a id="1312" class="Symbol">:</a> <a id="1314" href="Algebra.html#2342" class="Record">RawMonoid</a> <a id="1324" href="Data.List.Kleene.html#1302" class="Bound">m</a> <a id="1326" href="Data.List.Kleene.html#1304" class="Bound">r</a><a id="1327" class="Symbol">)</a> <a id="1329" class="Keyword">where</a>
  <a id="1337" class="Keyword">open</a> <a id="1342" href="Algebra.html#2342" class="Module">RawMonoid</a> <a id="1352" href="Data.List.Kleene.html#1308" class="Bound">mon</a>

  <a id="1359" href="Data.List.Kleene.html#1359" class="Function">foldMap</a> <a id="1367" class="Symbol">:</a> <a id="1369" class="Symbol">∀</a> <a id="1371" class="Symbol">{</a><a id="1372" href="Data.List.Kleene.html#1372" class="Bound">a</a><a id="1373" class="Symbol">}</a> <a id="1375" class="Symbol">{</a><a id="1376" href="Data.List.Kleene.html#1376" class="Bound">A</a> <a id="1378" class="Symbol">:</a> <a id="1380" class="PrimitiveType">Set</a> <a id="1384" href="Data.List.Kleene.html#1372" class="Bound">a</a><a id="1385" class="Symbol">}</a> <a id="1387" class="Symbol">→</a> <a id="1389" class="Symbol">(</a><a id="1390" href="Data.List.Kleene.html#1376" class="Bound">A</a> <a id="1392" class="Symbol">→</a> <a id="1394" href="Algebra.html#2424" class="Field">Carrier</a><a id="1401" class="Symbol">)</a> <a id="1403" class="Symbol">→</a> <a id="1405" href="Data.List.Kleene.html#1376" class="Bound">A</a> <a id="1407" href="Data.List.Kleene.html#177" class="Datatype Operator">⋆</a> <a id="1409" class="Symbol">→</a> <a id="1411" href="Algebra.html#2424" class="Field">Carrier</a>
  <a id="1421" href="Data.List.Kleene.html#1359" class="Function">foldMap</a> <a id="1429" href="Data.List.Kleene.html#1429" class="Bound">f</a> <a id="1431" href="Data.List.Kleene.html#214" class="InductiveConstructor">[]</a> <a id="1434" class="Symbol">=</a> <a id="1436" href="Algebra.html#2498" class="Field">ε</a>
  <a id="1440" href="Data.List.Kleene.html#1359" class="Function">foldMap</a> <a id="1448" class="Symbol">{</a><a id="1449" class="Argument">A</a> <a id="1451" class="Symbol">=</a> <a id="1453" href="Data.List.Kleene.html#1453" class="Bound">A</a><a id="1454" class="Symbol">}</a> <a id="1456" href="Data.List.Kleene.html#1456" class="Bound">f</a> <a id="1458" href="Data.List.Kleene.html#228" class="InductiveConstructor Operator">[</a> <a id="1460" href="Data.List.Kleene.html#1460" class="Bound">xs</a> <a id="1463" href="Data.List.Kleene.html#228" class="InductiveConstructor Operator">]</a> <a id="1465" class="Symbol">=</a> <a id="1467" href="Data.List.Kleene.html#1487" class="Function">go</a> <a id="1470" href="Data.List.Kleene.html#1460" class="Bound">xs</a>
    <a id="1477" class="Keyword">where</a>
    <a id="1487" href="Data.List.Kleene.html#1487" class="Function">go</a> <a id="1490" class="Symbol">:</a> <a id="1492" href="Data.List.Kleene.html#1453" class="Bound">A</a> <a id="1494" href="Data.List.Kleene.html#269" class="Record Operator">⁺</a> <a id="1496" class="Symbol">→</a> <a id="1498" href="Algebra.html#2424" class="Field">Carrier</a>
    <a id="1510" href="Data.List.Kleene.html#1487" class="Function">go</a> <a id="1513" class="Symbol">(</a><a id="1514" href="Data.List.Kleene.html#1514" class="Bound">x</a> <a id="1516" href="Data.List.Kleene.html#332" class="InductiveConstructor Operator">&amp;</a> <a id="1518" href="Data.List.Kleene.html#214" class="InductiveConstructor">[]</a><a id="1520" class="Symbol">)</a> <a id="1522" class="Symbol">=</a> <a id="1524" href="Data.List.Kleene.html#1456" class="Bound">f</a> <a id="1526" href="Data.List.Kleene.html#1514" class="Bound">x</a>
    <a id="1532" href="Data.List.Kleene.html#1487" class="Function">go</a> <a id="1535" class="Symbol">(</a><a id="1536" href="Data.List.Kleene.html#1536" class="Bound">x</a> <a id="1538" href="Data.List.Kleene.html#332" class="InductiveConstructor Operator">&amp;</a> <a id="1540" href="Data.List.Kleene.html#228" class="InductiveConstructor Operator">[</a> <a id="1542" href="Data.List.Kleene.html#1542" class="Bound">xs</a> <a id="1545" href="Data.List.Kleene.html#228" class="InductiveConstructor Operator">]</a><a id="1546" class="Symbol">)</a> <a id="1548" class="Symbol">=</a> <a id="1550" href="Data.List.Kleene.html#1456" class="Bound">f</a> <a id="1552" href="Data.List.Kleene.html#1536" class="Bound">x</a> <a id="1554" href="Algebra.html#2472" class="Field Operator">∙</a> <a id="1556" href="Data.List.Kleene.html#1487" class="Function">go</a> <a id="1559" href="Data.List.Kleene.html#1542" class="Bound">xs</a>
<a id="1562" class="Comment">-- Which is a little cleaner.</a>
</pre></body></html>