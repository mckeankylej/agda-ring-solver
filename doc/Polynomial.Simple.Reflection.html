<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Polynomial.Simple.Reflection</title><link rel="stylesheet" href="Agda.css"></head><body><pre><a id="1" class="Keyword">module</a> <a id="8" href="Polynomial.Simple.Reflection.html" class="Module">Polynomial.Simple.Reflection</a> <a id="37" class="Keyword">where</a>

<a id="44" class="Keyword">open</a> <a id="49" class="Keyword">import</a> <a id="56" href="Reflection.html" class="Module">Reflection</a>
<a id="67" class="Keyword">open</a> <a id="72" class="Keyword">import</a> <a id="79" href="Function.html" class="Module">Function</a>
<a id="88" class="Keyword">open</a> <a id="93" class="Keyword">import</a> <a id="100" href="Data.Unit.html" class="Module">Data.Unit</a> <a id="110" class="Keyword">using</a> <a id="116" class="Symbol">(</a><a id="117" href="Agda.Builtin.Unit.html#69" class="Record">⊤</a><a id="118" class="Symbol">)</a>

<a id="121" class="Keyword">module</a> <a id="Internal"></a><a id="128" href="Polynomial.Simple.Reflection.html#128" class="Module">Internal</a> <a id="137" class="Keyword">where</a>
  <a id="145" class="Keyword">open</a> <a id="150" class="Keyword">import</a> <a id="157" href="Polynomial.Simple.Solver.html" class="Module">Polynomial.Simple.Solver</a> <a id="182" class="Keyword">renaming</a> <a id="191" class="Symbol">(</a><a id="192" href="Polynomial.Simple.Solver.html#2804" class="Function">solve</a> <a id="198" class="Symbol">to</a> <a id="201" href="Polynomial.Simple.Solver.html#2804" class="Function">solve′</a><a id="207" class="Symbol">)</a>
  <a id="211" class="Keyword">open</a> <a id="216" class="Keyword">import</a> <a id="223" href="Data.String.html" class="Module">Data.String</a>
  <a id="237" class="Keyword">open</a> <a id="242" class="Keyword">import</a> <a id="249" href="Relation.Nullary.html" class="Module">Relation.Nullary</a> <a id="266" class="Keyword">using</a> <a id="272" class="Symbol">(</a><a id="273" href="Relation.Nullary.html#570" class="Datatype">Dec</a><a id="276" class="Symbol">;</a> <a id="278" href="Relation.Nullary.html#606" class="InductiveConstructor">yes</a><a id="281" class="Symbol">;</a> <a id="283" href="Relation.Nullary.html#633" class="InductiveConstructor">no</a><a id="285" class="Symbol">)</a>
  <a id="289" class="Keyword">open</a> <a id="294" class="Keyword">import</a> <a id="301" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="310" class="Symbol">as</a> <a id="313" class="Module">ℕ</a> <a id="315" class="Keyword">using</a> <a id="321" class="Symbol">(</a><a id="322" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a><a id="323" class="Symbol">;</a> <a id="325" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a><a id="328" class="Symbol">;</a> <a id="330" href="Agda.Builtin.Nat.html#115" class="InductiveConstructor">zero</a><a id="334" class="Symbol">)</a>
  <a id="338" class="Keyword">open</a> <a id="343" class="Keyword">import</a> <a id="350" href="Data.List.html" class="Module">Data.List</a> <a id="360" class="Keyword">using</a> <a id="366" class="Symbol">(</a><a id="367" href="Agda.Builtin.List.html#80" class="Datatype">List</a><a id="371" class="Symbol">;</a> <a id="373" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">_∷_</a><a id="376" class="Symbol">;</a> <a id="378" href="Data.List.Base.html#9851" class="InductiveConstructor">[]</a><a id="380" class="Symbol">;</a> <a id="382" href="Data.List.Base.html#3588" class="Function">foldr</a><a id="387" class="Symbol">)</a>

  <a id="392" class="Comment">-- Some patterns to decrease verbosity</a>
  <a id="433" class="Keyword">infixr</a> <a id="440" class="Number">5</a> <a id="442" href="Polynomial.Simple.Reflection.html#464" class="InductiveConstructor Operator">⟨_⟩∷_</a> <a id="448" href="Polynomial.Simple.Reflection.html#526" class="InductiveConstructor Operator">⟅_⟆∷_</a>
  <a id="456" class="Keyword">pattern</a> <a id="Internal.⟨_⟩∷_"></a><a id="464" href="Polynomial.Simple.Reflection.html#464" class="InductiveConstructor Operator">⟨_⟩∷_</a> <a id="470" href="Polynomial.Simple.Reflection.html#509" class="Bound">x</a> <a id="472" href="Polynomial.Simple.Reflection.html#513" class="Bound">xs</a> <a id="475" class="Symbol">=</a> <a id="477" href="Agda.Builtin.Reflection.html#3069" class="InductiveConstructor">arg</a> <a id="481" class="Symbol">(</a><a id="482" href="Agda.Builtin.Reflection.html#2981" class="InductiveConstructor">arg-info</a> <a id="491" href="Agda.Builtin.Reflection.html#2549" class="InductiveConstructor">visible</a> <a id="499" href="Agda.Builtin.Reflection.html#2806" class="InductiveConstructor">relevant</a><a id="507" class="Symbol">)</a> <a id="509" href="Polynomial.Simple.Reflection.html#509" class="Bound">x</a> <a id="511" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="513" href="Polynomial.Simple.Reflection.html#513" class="Bound">xs</a>
  <a id="518" class="Keyword">pattern</a> <a id="Internal.⟅_⟆∷_"></a><a id="526" href="Polynomial.Simple.Reflection.html#526" class="InductiveConstructor Operator">⟅_⟆∷_</a> <a id="532" href="Polynomial.Simple.Reflection.html#570" class="Bound">x</a> <a id="534" href="Polynomial.Simple.Reflection.html#574" class="Bound">xs</a> <a id="537" class="Symbol">=</a> <a id="539" href="Agda.Builtin.Reflection.html#3069" class="InductiveConstructor">arg</a> <a id="543" class="Symbol">(</a><a id="544" href="Agda.Builtin.Reflection.html#2981" class="InductiveConstructor">arg-info</a> <a id="553" href="Agda.Builtin.Reflection.html#2557" class="InductiveConstructor">hidden</a> <a id="560" href="Agda.Builtin.Reflection.html#2806" class="InductiveConstructor">relevant</a><a id="568" class="Symbol">)</a> <a id="570" href="Polynomial.Simple.Reflection.html#570" class="Bound">x</a> <a id="572" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="574" href="Polynomial.Simple.Reflection.html#574" class="Bound">xs</a>

  <a id="Internal.natTerm"></a><a id="580" href="Polynomial.Simple.Reflection.html#580" class="Function">natTerm</a> <a id="588" class="Symbol">:</a> <a id="590" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="592" class="Symbol">→</a> <a id="594" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
  <a id="601" href="Polynomial.Simple.Reflection.html#580" class="Function">natTerm</a> <a id="609" href="Agda.Builtin.Nat.html#115" class="InductiveConstructor">zero</a> <a id="614" class="Symbol">=</a> <a id="616" class="Keyword">quote</a> <a id="622" href="Agda.Builtin.Nat.html#115" class="InductiveConstructor">zero</a> <a id="627" href="Function.html#2548" class="Function Operator">⟨</a> <a id="629" href="Agda.Builtin.Reflection.html#4648" class="InductiveConstructor">con</a> <a id="633" href="Function.html#2548" class="Function Operator">⟩</a> <a id="635" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>
  <a id="640" href="Polynomial.Simple.Reflection.html#580" class="Function">natTerm</a> <a id="648" class="Symbol">(</a><a id="649" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="653" href="Polynomial.Simple.Reflection.html#653" class="Bound">i</a><a id="654" class="Symbol">)</a> <a id="656" class="Symbol">=</a> <a id="658" class="Keyword">quote</a> <a id="664" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="668" href="Function.html#2548" class="Function Operator">⟨</a> <a id="670" href="Agda.Builtin.Reflection.html#4648" class="InductiveConstructor">con</a> <a id="674" href="Function.html#2548" class="Function Operator">⟩</a> <a id="676" href="Polynomial.Simple.Reflection.html#464" class="InductiveConstructor Operator">⟨</a> <a id="678" href="Polynomial.Simple.Reflection.html#580" class="Function">natTerm</a> <a id="686" href="Polynomial.Simple.Reflection.html#653" class="Bound">i</a> <a id="688" href="Polynomial.Simple.Reflection.html#464" class="InductiveConstructor Operator">⟩∷</a> <a id="691" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>

  <a id="697" class="Comment">-- This function applies the hidden arguments that the constructors</a>
  <a id="767" class="Comment">-- for Expr need. The first is the universe level, the second is the</a>
  <a id="838" class="Comment">-- type it contains, and the third is the number of variables it&#39;s</a>
  <a id="907" class="Comment">-- indexed by. All three of these could likely be inferred, but to</a>
  <a id="976" class="Comment">-- make things easier we supply the third because we know it.</a>
  <a id="1040" class="Keyword">infixr</a> <a id="1047" class="Number">5</a> <a id="1049" href="Polynomial.Simple.Reflection.html#1058" class="Function Operator">⟅_⋯⟆∷_</a>
  <a id="Internal.⟅_⋯⟆∷_"></a><a id="1058" href="Polynomial.Simple.Reflection.html#1058" class="Function Operator">⟅_⋯⟆∷_</a> <a id="1065" class="Symbol">:</a> <a id="1067" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="1069" class="Symbol">→</a> <a id="1071" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="1076" class="Symbol">(</a><a id="1077" href="Agda.Builtin.Reflection.html#3041" class="Datatype">Arg</a> <a id="1081" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a><a id="1085" class="Symbol">)</a> <a id="1087" class="Symbol">→</a> <a id="1089" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="1094" class="Symbol">(</a><a id="1095" href="Agda.Builtin.Reflection.html#3041" class="Datatype">Arg</a> <a id="1099" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a><a id="1103" class="Symbol">)</a>
  <a id="1107" href="Polynomial.Simple.Reflection.html#1058" class="Function Operator">⟅</a> <a id="1109" href="Polynomial.Simple.Reflection.html#1109" class="Bound">i</a> <a id="1111" href="Polynomial.Simple.Reflection.html#1058" class="Function Operator">⋯⟆∷</a> <a id="1115" href="Polynomial.Simple.Reflection.html#1115" class="Bound">xs</a> <a id="1118" class="Symbol">=</a> <a id="1120" href="Polynomial.Simple.Reflection.html#526" class="InductiveConstructor Operator">⟅</a> <a id="1122" href="Agda.Builtin.Reflection.html#5048" class="InductiveConstructor">unknown</a> <a id="1130" href="Polynomial.Simple.Reflection.html#526" class="InductiveConstructor Operator">⟆∷</a> <a id="1133" href="Polynomial.Simple.Reflection.html#526" class="InductiveConstructor Operator">⟅</a> <a id="1135" href="Agda.Builtin.Reflection.html#5048" class="InductiveConstructor">unknown</a> <a id="1143" href="Polynomial.Simple.Reflection.html#526" class="InductiveConstructor Operator">⟆∷</a> <a id="1146" href="Polynomial.Simple.Reflection.html#526" class="InductiveConstructor Operator">⟅</a> <a id="1148" href="Polynomial.Simple.Reflection.html#580" class="Function">natTerm</a> <a id="1156" href="Polynomial.Simple.Reflection.html#1109" class="Bound">i</a> <a id="1158" href="Polynomial.Simple.Reflection.html#526" class="InductiveConstructor Operator">⟆∷</a> <a id="1161" href="Polynomial.Simple.Reflection.html#1115" class="Bound">xs</a>

  <a id="1167" class="Comment">-- A constant expression.</a>
  <a id="Internal.constExpr"></a><a id="1195" href="Polynomial.Simple.Reflection.html#1195" class="Function">constExpr</a> <a id="1205" class="Symbol">:</a> <a id="1207" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="1209" class="Symbol">→</a> <a id="1211" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="1216" class="Symbol">→</a> <a id="1218" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
  <a id="1225" href="Polynomial.Simple.Reflection.html#1195" class="Function">constExpr</a> <a id="1235" href="Polynomial.Simple.Reflection.html#1235" class="Bound">i</a> <a id="1237" href="Polynomial.Simple.Reflection.html#1237" class="Bound">x</a> <a id="1239" class="Symbol">=</a> <a id="1241" class="Keyword">quote</a> <a id="1247" href="Polynomial.Expr.html#290" class="InductiveConstructor">Κ</a> <a id="1249" href="Function.html#2548" class="Function Operator">⟨</a> <a id="1251" href="Agda.Builtin.Reflection.html#4648" class="InductiveConstructor">con</a> <a id="1255" href="Function.html#2548" class="Function Operator">⟩</a> <a id="1257" href="Polynomial.Simple.Reflection.html#1058" class="Function Operator">⟅</a> <a id="1259" href="Polynomial.Simple.Reflection.html#1235" class="Bound">i</a> <a id="1261" href="Polynomial.Simple.Reflection.html#1058" class="Function Operator">⋯⟆∷</a> <a id="1265" href="Polynomial.Simple.Reflection.html#464" class="InductiveConstructor Operator">⟨</a> <a id="1267" href="Polynomial.Simple.Reflection.html#1237" class="Bound">x</a> <a id="1269" href="Polynomial.Simple.Reflection.html#464" class="InductiveConstructor Operator">⟩∷</a> <a id="1272" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>

  <a id="1278" class="Keyword">mutual</a>
    <a id="1289" class="Comment">-- Application of a ring operator often doesn&#39;t have a type as</a>
    <a id="1356" class="Comment">-- simple as &quot;Carrier → Carrier → Carrier&quot;: there may be hidden</a>
    <a id="1424" class="Comment">-- arguments, etc. Here, we do our best to handle those cases,</a>
    <a id="1491" class="Comment">-- by just taking the last two explicit arguments.</a>
    <a id="Internal.getBinOp"></a><a id="1546" href="Polynomial.Simple.Reflection.html#1546" class="Function">getBinOp</a> <a id="1555" class="Symbol">:</a> <a id="1557" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="1559" class="Symbol">→</a> <a id="1561" href="Agda.Builtin.Reflection.html#363" class="Postulate">Name</a> <a id="1566" class="Symbol">→</a> <a id="1568" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="1573" class="Symbol">(</a><a id="1574" href="Agda.Builtin.Reflection.html#3041" class="Datatype">Arg</a> <a id="1578" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a><a id="1582" class="Symbol">)</a> <a id="1584" class="Symbol">→</a> <a id="1586" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
    <a id="1595" href="Polynomial.Simple.Reflection.html#1546" class="Function">getBinOp</a> <a id="1604" href="Polynomial.Simple.Reflection.html#1604" class="Bound">i</a> <a id="1606" href="Polynomial.Simple.Reflection.html#1606" class="Bound">nm</a> <a id="1609" class="Symbol">(</a><a id="1610" href="Polynomial.Simple.Reflection.html#464" class="InductiveConstructor Operator">⟨</a> <a id="1612" href="Polynomial.Simple.Reflection.html#1612" class="Bound">x</a> <a id="1614" href="Polynomial.Simple.Reflection.html#464" class="InductiveConstructor Operator">⟩∷</a> <a id="1617" href="Polynomial.Simple.Reflection.html#464" class="InductiveConstructor Operator">⟨</a> <a id="1619" href="Polynomial.Simple.Reflection.html#1619" class="Bound">y</a> <a id="1621" href="Polynomial.Simple.Reflection.html#464" class="InductiveConstructor Operator">⟩∷</a> <a id="1624" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="1626" class="Symbol">)</a> <a id="1628" class="Symbol">=</a> <a id="1630" href="Polynomial.Simple.Reflection.html#1606" class="Bound">nm</a> <a id="1633" href="Function.html#2548" class="Function Operator">⟨</a> <a id="1635" href="Agda.Builtin.Reflection.html#4648" class="InductiveConstructor">con</a> <a id="1639" href="Function.html#2548" class="Function Operator">⟩</a> <a id="1641" href="Polynomial.Simple.Reflection.html#1058" class="Function Operator">⟅</a> <a id="1643" href="Polynomial.Simple.Reflection.html#1604" class="Bound">i</a> <a id="1645" href="Polynomial.Simple.Reflection.html#1058" class="Function Operator">⋯⟆∷</a> <a id="1649" href="Polynomial.Simple.Reflection.html#464" class="InductiveConstructor Operator">⟨</a> <a id="1651" href="Polynomial.Simple.Reflection.html#2796" class="Function">toExpr</a> <a id="1658" href="Polynomial.Simple.Reflection.html#1604" class="Bound">i</a> <a id="1660" href="Polynomial.Simple.Reflection.html#1612" class="Bound">x</a> <a id="1662" href="Polynomial.Simple.Reflection.html#464" class="InductiveConstructor Operator">⟩∷</a> <a id="1665" href="Polynomial.Simple.Reflection.html#464" class="InductiveConstructor Operator">⟨</a> <a id="1667" href="Polynomial.Simple.Reflection.html#2796" class="Function">toExpr</a> <a id="1674" href="Polynomial.Simple.Reflection.html#1604" class="Bound">i</a> <a id="1676" href="Polynomial.Simple.Reflection.html#1619" class="Bound">y</a> <a id="1678" href="Polynomial.Simple.Reflection.html#464" class="InductiveConstructor Operator">⟩∷</a> <a id="1681" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>
    <a id="1688" href="Polynomial.Simple.Reflection.html#1546" class="CatchallClause Function">getBinOp</a><a id="1696" class="CatchallClause"> </a><a id="1697" href="Polynomial.Simple.Reflection.html#1697" class="CatchallClause Bound">i</a><a id="1698" class="CatchallClause"> </a><a id="1699" href="Polynomial.Simple.Reflection.html#1699" class="CatchallClause Bound">nm</a><a id="1701" class="CatchallClause"> </a><a id="1702" class="CatchallClause Symbol">(</a><a id="1703" href="Polynomial.Simple.Reflection.html#1703" class="CatchallClause Bound">x</a><a id="1704" class="CatchallClause"> </a><a id="1705" href="Agda.Builtin.List.html#132" class="CatchallClause InductiveConstructor Operator">∷</a><a id="1706" class="CatchallClause"> </a><a id="1707" href="Polynomial.Simple.Reflection.html#1707" class="CatchallClause Bound">xs</a><a id="1709" class="CatchallClause Symbol">)</a> <a id="1711" class="Symbol">=</a> <a id="1713" href="Polynomial.Simple.Reflection.html#1546" class="Function">getBinOp</a> <a id="1722" href="Polynomial.Simple.Reflection.html#1697" class="Bound">i</a> <a id="1724" href="Polynomial.Simple.Reflection.html#1699" class="Bound">nm</a> <a id="1727" href="Polynomial.Simple.Reflection.html#1707" class="Bound">xs</a>
    <a id="1734" href="Polynomial.Simple.Reflection.html#1546" class="CatchallClause Function">getBinOp</a><a id="1742" class="CatchallClause"> </a><a id="1743" class="CatchallClause Symbol">_</a><a id="1744" class="CatchallClause"> </a><a id="1745" class="CatchallClause Symbol">_</a><a id="1746" class="CatchallClause"> </a><a id="1747" class="CatchallClause Symbol">_</a> <a id="1749" class="Symbol">=</a> <a id="1751" href="Agda.Builtin.Reflection.html#5048" class="InductiveConstructor">unknown</a>

    <a id="Internal.getUnOp"></a><a id="1764" href="Polynomial.Simple.Reflection.html#1764" class="Function">getUnOp</a> <a id="1772" class="Symbol">:</a> <a id="1774" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="1776" class="Symbol">→</a> <a id="1778" href="Agda.Builtin.Reflection.html#363" class="Postulate">Name</a> <a id="1783" class="Symbol">→</a> <a id="1785" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="1790" class="Symbol">(</a><a id="1791" href="Agda.Builtin.Reflection.html#3041" class="Datatype">Arg</a> <a id="1795" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a><a id="1799" class="Symbol">)</a> <a id="1801" class="Symbol">→</a> <a id="1803" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
    <a id="1812" href="Polynomial.Simple.Reflection.html#1764" class="Function">getUnOp</a> <a id="1820" href="Polynomial.Simple.Reflection.html#1820" class="Bound">i</a> <a id="1822" href="Polynomial.Simple.Reflection.html#1822" class="Bound">nm</a> <a id="1825" class="Symbol">(</a><a id="1826" href="Polynomial.Simple.Reflection.html#464" class="InductiveConstructor Operator">⟨</a> <a id="1828" href="Polynomial.Simple.Reflection.html#1828" class="Bound">x</a> <a id="1830" href="Polynomial.Simple.Reflection.html#464" class="InductiveConstructor Operator">⟩∷</a> <a id="1833" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="1835" class="Symbol">)</a> <a id="1837" class="Symbol">=</a> <a id="1839" href="Polynomial.Simple.Reflection.html#1822" class="Bound">nm</a> <a id="1842" href="Function.html#2548" class="Function Operator">⟨</a> <a id="1844" href="Agda.Builtin.Reflection.html#4648" class="InductiveConstructor">con</a> <a id="1848" href="Function.html#2548" class="Function Operator">⟩</a> <a id="1850" href="Polynomial.Simple.Reflection.html#1058" class="Function Operator">⟅</a> <a id="1852" href="Polynomial.Simple.Reflection.html#1820" class="Bound">i</a> <a id="1854" href="Polynomial.Simple.Reflection.html#1058" class="Function Operator">⋯⟆∷</a> <a id="1858" href="Polynomial.Simple.Reflection.html#464" class="InductiveConstructor Operator">⟨</a> <a id="1860" href="Polynomial.Simple.Reflection.html#2796" class="Function">toExpr</a> <a id="1867" href="Polynomial.Simple.Reflection.html#1820" class="Bound">i</a> <a id="1869" href="Polynomial.Simple.Reflection.html#1828" class="Bound">x</a> <a id="1871" href="Polynomial.Simple.Reflection.html#464" class="InductiveConstructor Operator">⟩∷</a> <a id="1874" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>
    <a id="1881" href="Polynomial.Simple.Reflection.html#1764" class="CatchallClause Function">getUnOp</a><a id="1888" class="CatchallClause"> </a><a id="1889" href="Polynomial.Simple.Reflection.html#1889" class="CatchallClause Bound">i</a><a id="1890" class="CatchallClause"> </a><a id="1891" href="Polynomial.Simple.Reflection.html#1891" class="CatchallClause Bound">nm</a><a id="1893" class="CatchallClause"> </a><a id="1894" class="CatchallClause Symbol">(</a><a id="1895" href="Polynomial.Simple.Reflection.html#1895" class="CatchallClause Bound">x</a><a id="1896" class="CatchallClause"> </a><a id="1897" href="Agda.Builtin.List.html#132" class="CatchallClause InductiveConstructor Operator">∷</a><a id="1898" class="CatchallClause"> </a><a id="1899" href="Polynomial.Simple.Reflection.html#1899" class="CatchallClause Bound">xs</a><a id="1901" class="CatchallClause Symbol">)</a> <a id="1903" class="Symbol">=</a> <a id="1905" href="Polynomial.Simple.Reflection.html#1764" class="Function">getUnOp</a> <a id="1913" href="Polynomial.Simple.Reflection.html#1889" class="Bound">i</a> <a id="1915" href="Polynomial.Simple.Reflection.html#1891" class="Bound">nm</a> <a id="1918" href="Polynomial.Simple.Reflection.html#1899" class="Bound">xs</a>
    <a id="1925" href="Polynomial.Simple.Reflection.html#1764" class="CatchallClause Function">getUnOp</a><a id="1932" class="CatchallClause"> </a><a id="1933" class="CatchallClause Symbol">_</a><a id="1934" class="CatchallClause"> </a><a id="1935" class="CatchallClause Symbol">_</a><a id="1936" class="CatchallClause"> </a><a id="1937" class="CatchallClause Symbol">_</a> <a id="1939" class="Symbol">=</a> <a id="1941" href="Agda.Builtin.Reflection.html#5048" class="InductiveConstructor">unknown</a>

    <a id="Internal.getExp"></a><a id="1954" href="Polynomial.Simple.Reflection.html#1954" class="Function">getExp</a> <a id="1961" class="Symbol">:</a> <a id="1963" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="1965" class="Symbol">→</a> <a id="1967" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="1972" class="Symbol">(</a><a id="1973" href="Agda.Builtin.Reflection.html#3041" class="Datatype">Arg</a> <a id="1977" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a><a id="1981" class="Symbol">)</a> <a id="1983" class="Symbol">→</a> <a id="1985" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
    <a id="1994" href="Polynomial.Simple.Reflection.html#1954" class="Function">getExp</a> <a id="2001" href="Polynomial.Simple.Reflection.html#2001" class="Bound">i</a> <a id="2003" class="Symbol">(</a><a id="2004" href="Polynomial.Simple.Reflection.html#464" class="InductiveConstructor Operator">⟨</a> <a id="2006" href="Polynomial.Simple.Reflection.html#2006" class="Bound">x</a> <a id="2008" href="Polynomial.Simple.Reflection.html#464" class="InductiveConstructor Operator">⟩∷</a> <a id="2011" href="Polynomial.Simple.Reflection.html#464" class="InductiveConstructor Operator">⟨</a> <a id="2013" href="Polynomial.Simple.Reflection.html#2013" class="Bound">y</a> <a id="2015" href="Polynomial.Simple.Reflection.html#464" class="InductiveConstructor Operator">⟩∷</a> <a id="2018" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="2020" class="Symbol">)</a> <a id="2022" class="Symbol">=</a> <a id="2024" class="Keyword">quote</a> <a id="2030" href="Polynomial.Expr.html#414" class="InductiveConstructor Operator">_⊛_</a> <a id="2034" href="Function.html#2548" class="Function Operator">⟨</a> <a id="2036" href="Agda.Builtin.Reflection.html#4648" class="InductiveConstructor">con</a> <a id="2040" href="Function.html#2548" class="Function Operator">⟩</a> <a id="2042" href="Polynomial.Simple.Reflection.html#1058" class="Function Operator">⟅</a> <a id="2044" href="Polynomial.Simple.Reflection.html#2001" class="Bound">i</a> <a id="2046" href="Polynomial.Simple.Reflection.html#1058" class="Function Operator">⋯⟆∷</a> <a id="2050" href="Polynomial.Simple.Reflection.html#464" class="InductiveConstructor Operator">⟨</a> <a id="2052" href="Polynomial.Simple.Reflection.html#2796" class="Function">toExpr</a> <a id="2059" href="Polynomial.Simple.Reflection.html#2001" class="Bound">i</a> <a id="2061" href="Polynomial.Simple.Reflection.html#2006" class="Bound">x</a> <a id="2063" href="Polynomial.Simple.Reflection.html#464" class="InductiveConstructor Operator">⟩∷</a> <a id="2066" href="Polynomial.Simple.Reflection.html#464" class="InductiveConstructor Operator">⟨</a> <a id="2068" href="Polynomial.Simple.Reflection.html#2013" class="Bound">y</a> <a id="2070" href="Polynomial.Simple.Reflection.html#464" class="InductiveConstructor Operator">⟩∷</a> <a id="2073" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>
    <a id="2080" href="Polynomial.Simple.Reflection.html#1954" class="CatchallClause Function">getExp</a><a id="2086" class="CatchallClause"> </a><a id="2087" href="Polynomial.Simple.Reflection.html#2087" class="CatchallClause Bound">i</a><a id="2088" class="CatchallClause"> </a><a id="2089" class="CatchallClause Symbol">(</a><a id="2090" href="Polynomial.Simple.Reflection.html#2090" class="CatchallClause Bound">x</a><a id="2091" class="CatchallClause"> </a><a id="2092" href="Agda.Builtin.List.html#132" class="CatchallClause InductiveConstructor Operator">∷</a><a id="2093" class="CatchallClause"> </a><a id="2094" href="Polynomial.Simple.Reflection.html#2094" class="CatchallClause Bound">xs</a><a id="2096" class="CatchallClause Symbol">)</a> <a id="2098" class="Symbol">=</a> <a id="2100" href="Polynomial.Simple.Reflection.html#1954" class="Function">getExp</a> <a id="2107" href="Polynomial.Simple.Reflection.html#2087" class="Bound">i</a> <a id="2109" href="Polynomial.Simple.Reflection.html#2094" class="Bound">xs</a>
    <a id="2116" href="Polynomial.Simple.Reflection.html#1954" class="CatchallClause Function">getExp</a><a id="2122" class="CatchallClause"> </a><a id="2123" class="CatchallClause Symbol">_</a><a id="2124" class="CatchallClause"> </a><a id="2125" class="CatchallClause Symbol">_</a> <a id="2127" class="Symbol">=</a> <a id="2129" href="Agda.Builtin.Reflection.html#5048" class="InductiveConstructor">unknown</a>

    <a id="2142" class="Comment">-- When trying to figure out the shape of an expression, one of</a>
    <a id="2210" class="Comment">-- the difficult tasks is recognizing where constants in the</a>
    <a id="2275" class="Comment">-- underlying ring are used. If we were only dealing with ℕ, we</a>
    <a id="2343" class="Comment">-- might look for its constructors: however, we want to deal with</a>
    <a id="2413" class="Comment">-- arbitrary types which implement AlmostCommutativeRing. If the</a>
    <a id="2482" class="Comment">-- Term type contained type information we might be able to</a>
    <a id="2546" class="Comment">-- recognize it there, but it doesn&#39;t.</a>
    <a id="2589" class="Comment">--</a>
    <a id="2596" class="Comment">-- We&#39;re in luck, though, because all other cases in the following</a>
    <a id="2667" class="Comment">-- function *are* recognizable. As a result, the &quot;catch-all&quot; case</a>
    <a id="2737" class="Comment">-- will just assume that it has a constant expression.</a>
    <a id="Internal.toExpr"></a><a id="2796" href="Polynomial.Simple.Reflection.html#2796" class="Function">toExpr</a> <a id="2803" class="Symbol">:</a> <a id="2805" class="Symbol">(</a><a id="2806" href="Polynomial.Simple.Reflection.html#2806" class="Bound">i</a> <a id="2808" class="Symbol">:</a> <a id="2810" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a><a id="2811" class="Symbol">)</a> <a id="2813" class="Symbol">→</a> <a id="2815" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="2820" class="Symbol">→</a> <a id="2822" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
    <a id="2831" href="Polynomial.Simple.Reflection.html#2796" class="Function">toExpr</a> <a id="2838" href="Polynomial.Simple.Reflection.html#2838" class="Bound">i</a> <a id="2840" href="Polynomial.Simple.Reflection.html#2840" class="Bound">t</a><a id="2841" class="Symbol">@(</a><a id="2843" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="2847" href="Polynomial.Simple.Reflection.html#2847" class="Bound">f</a> <a id="2849" href="Polynomial.Simple.Reflection.html#2849" class="Bound">xs</a><a id="2851" class="Symbol">)</a> <a id="2853" class="Keyword">with</a> <a id="2858" href="Polynomial.Simple.Reflection.html#2847" class="Bound">f</a> <a id="2860" href="Reflection.html#1665" class="Function Operator">≟-Name</a> <a id="2867" class="Keyword">quote</a> <a id="2873" href="Polynomial.Simple.AlmostCommutativeRing.html#1123" class="Field Operator">AlmostCommutativeRing._+_</a>
    <a id="2903" class="Symbol">...</a> <a id="2907" class="Symbol">|</a> <a id="2909" href="Relation.Nullary.html#606" class="InductiveConstructor">yes</a> <a id="2913" href="Polynomial.Simple.Reflection.html#2913" class="Bound">p</a> <a id="2915" class="Symbol">=</a> <a id="2917" href="Polynomial.Simple.Reflection.html#1546" class="Function">getBinOp</a> <a id="2926" class="Bound">i</a> <a id="2928" class="Symbol">(</a><a id="2929" class="Keyword">quote</a> <a id="2935" href="Polynomial.Expr.html#336" class="InductiveConstructor Operator">_⊕_</a><a id="2938" class="Symbol">)</a> <a id="2940" class="Bound">xs</a>
    <a id="2947" class="Symbol">...</a> <a id="2951" class="Symbol">|</a> <a id="2953" href="Relation.Nullary.html#633" class="InductiveConstructor">no</a> <a id="2956" class="Symbol">_</a> <a id="2958" class="Keyword">with</a> <a id="2963" class="Bound">f</a> <a id="2965" href="Reflection.html#1665" class="Function Operator">≟-Name</a> <a id="2972" class="Keyword">quote</a> <a id="2978" href="Polynomial.Simple.AlmostCommutativeRing.html#1165" class="Field Operator">AlmostCommutativeRing._*_</a>
    <a id="3008" class="Symbol">...</a> <a id="3012" class="Symbol">|</a> <a id="3014" href="Relation.Nullary.html#606" class="InductiveConstructor">yes</a> <a id="3018" href="Polynomial.Simple.Reflection.html#3018" class="Bound">p</a> <a id="3020" class="Symbol">=</a> <a id="3022" href="Polynomial.Simple.Reflection.html#1546" class="Function">getBinOp</a> <a id="3031" class="Bound">i</a> <a id="3033" class="Symbol">(</a><a id="3034" class="Keyword">quote</a> <a id="3040" href="Polynomial.Expr.html#375" class="InductiveConstructor Operator">_⊗_</a><a id="3043" class="Symbol">)</a> <a id="3045" class="Bound">xs</a>
    <a id="3052" class="Symbol">...</a> <a id="3056" class="Symbol">|</a> <a id="3058" href="Relation.Nullary.html#633" class="InductiveConstructor">no</a> <a id="3061" class="Symbol">_</a> <a id="3063" class="Keyword">with</a> <a id="3068" class="Bound">f</a> <a id="3070" href="Reflection.html#1665" class="Function Operator">≟-Name</a> <a id="3077" class="Keyword">quote</a> <a id="3083" href="Polynomial.Simple.AlmostCommutativeRing.html#2058" class="Function Operator">AlmostCommutativeRing._^_</a>
    <a id="3113" class="Symbol">...</a> <a id="3117" class="Symbol">|</a> <a id="3119" href="Relation.Nullary.html#606" class="InductiveConstructor">yes</a> <a id="3123" href="Polynomial.Simple.Reflection.html#3123" class="Bound">p</a> <a id="3125" class="Symbol">=</a> <a id="3127" href="Polynomial.Simple.Reflection.html#1954" class="Function">getExp</a> <a id="3134" class="Bound">i</a> <a id="3136" class="Bound">xs</a>
    <a id="3143" class="Symbol">...</a> <a id="3147" class="Symbol">|</a> <a id="3149" href="Relation.Nullary.html#633" class="InductiveConstructor">no</a> <a id="3152" class="Symbol">_</a> <a id="3154" class="Keyword">with</a> <a id="3159" class="Bound">f</a> <a id="3161" href="Reflection.html#1665" class="Function Operator">≟-Name</a> <a id="3168" class="Keyword">quote</a> <a id="3174" href="Polynomial.Simple.AlmostCommutativeRing.html#1207" class="Field Operator">AlmostCommutativeRing.-_</a>
    <a id="3203" class="Symbol">...</a> <a id="3207" class="Symbol">|</a> <a id="3209" href="Relation.Nullary.html#606" class="InductiveConstructor">yes</a> <a id="3213" href="Polynomial.Simple.Reflection.html#3213" class="Bound">p</a> <a id="3215" class="Symbol">=</a> <a id="3217" href="Polynomial.Simple.Reflection.html#1764" class="Function">getUnOp</a> <a id="3225" class="Bound">i</a> <a id="3227" class="Symbol">(</a><a id="3228" class="Keyword">quote</a> <a id="3234" href="Polynomial.Expr.html#446" class="InductiveConstructor Operator">⊝_</a><a id="3236" class="Symbol">)</a> <a id="3238" class="Bound">xs</a>
    <a id="3245" class="Symbol">...</a> <a id="3249" class="Symbol">|</a> <a id="3251" href="Relation.Nullary.html#633" class="InductiveConstructor">no</a> <a id="3254" class="Symbol">_</a> <a id="3256" class="Symbol">=</a> <a id="3258" href="Polynomial.Simple.Reflection.html#1195" class="Function">constExpr</a> <a id="3268" class="Bound">i</a> <a id="3270" class="Bound">t</a>
    <a id="3276" href="Polynomial.Simple.Reflection.html#2796" class="Function">toExpr</a> <a id="3283" href="Polynomial.Simple.Reflection.html#3283" class="Bound">i</a> <a id="3285" href="Polynomial.Simple.Reflection.html#3285" class="Bound">v</a><a id="3286" class="Symbol">@(</a><a id="3288" href="Agda.Builtin.Reflection.html#4592" class="InductiveConstructor">var</a> <a id="3292" href="Polynomial.Simple.Reflection.html#3292" class="Bound">x</a> <a id="3294" href="Polynomial.Simple.Reflection.html#3294" class="Bound">args</a><a id="3298" class="Symbol">)</a> <a id="3300" class="Keyword">with</a> <a id="3305" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="3309" href="Polynomial.Simple.Reflection.html#3292" class="Bound">x</a> <a id="3311" href="Data.Nat.Properties.html#2689" class="Function Operator">ℕ.≤?</a> <a id="3316" href="Polynomial.Simple.Reflection.html#3283" class="Bound">i</a>
    <a id="3322" class="Symbol">...</a> <a id="3326" class="Symbol">|</a> <a id="3328" href="Relation.Nullary.html#606" class="InductiveConstructor">yes</a> <a id="3332" href="Polynomial.Simple.Reflection.html#3332" class="Bound">p</a> <a id="3334" class="Symbol">=</a> <a id="3336" class="Bound">v</a>
    <a id="3342" class="Symbol">...</a> <a id="3346" class="Symbol">|</a> <a id="3348" href="Relation.Nullary.html#633" class="InductiveConstructor">no</a> <a id="3351" href="Polynomial.Simple.Reflection.html#3351" class="Bound">¬p</a> <a id="3354" class="Symbol">=</a> <a id="3356" href="Polynomial.Simple.Reflection.html#1195" class="Function">constExpr</a> <a id="3366" class="Bound">i</a> <a id="3368" class="Bound">v</a>
    <a id="3374" class="Symbol">{-#</a> <a id="3378" class="Keyword">CATCHALL</a> <a id="3387" class="Symbol">#-}</a>
    <a id="3395" href="Polynomial.Simple.Reflection.html#2796" class="Function">toExpr</a> <a id="3402" href="Polynomial.Simple.Reflection.html#3402" class="Bound">i</a> <a id="3404" href="Polynomial.Simple.Reflection.html#3404" class="Bound">t</a> <a id="3406" class="Symbol">=</a> <a id="3408" href="Polynomial.Simple.Reflection.html#1195" class="Function">constExpr</a> <a id="3418" href="Polynomial.Simple.Reflection.html#3402" class="Bound">i</a> <a id="3420" href="Polynomial.Simple.Reflection.html#3404" class="Bound">t</a>


  <a id="Internal.hlams"></a><a id="3426" href="Polynomial.Simple.Reflection.html#3426" class="Function">hlams</a> <a id="3432" class="Symbol">:</a> <a id="3434" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="3439" href="Agda.Builtin.String.html#165" class="Postulate">String</a> <a id="3446" class="Symbol">→</a> <a id="3448" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="3453" class="Symbol">→</a> <a id="3455" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
  <a id="3462" href="Polynomial.Simple.Reflection.html#3426" class="Function">hlams</a> <a id="3468" href="Polynomial.Simple.Reflection.html#3468" class="Bound">vs</a> <a id="3471" href="Polynomial.Simple.Reflection.html#3471" class="Bound">xs</a> <a id="3474" class="Symbol">=</a> <a id="3476" href="Data.List.Base.html#3588" class="Function">foldr</a> <a id="3482" class="Symbol">(λ</a> <a id="3485" href="Polynomial.Simple.Reflection.html#3485" class="Bound">v</a> <a id="3487" href="Polynomial.Simple.Reflection.html#3487" class="Bound">vs</a> <a id="3490" class="Symbol">→</a> <a id="3492" href="Agda.Builtin.Reflection.html#4762" class="InductiveConstructor">lam</a> <a id="3496" href="Agda.Builtin.Reflection.html#2557" class="InductiveConstructor">hidden</a> <a id="3503" class="Symbol">(</a><a id="3504" href="Agda.Builtin.Reflection.html#3308" class="InductiveConstructor">abs</a> <a id="3508" href="Polynomial.Simple.Reflection.html#3485" class="Bound">v</a> <a id="3510" href="Polynomial.Simple.Reflection.html#3487" class="Bound">vs</a><a id="3512" class="Symbol">))</a> <a id="3515" href="Polynomial.Simple.Reflection.html#3471" class="Bound">xs</a> <a id="3518" href="Polynomial.Simple.Reflection.html#3468" class="Bound">vs</a>

  <a id="Internal.vlams"></a><a id="3524" href="Polynomial.Simple.Reflection.html#3524" class="Function">vlams</a> <a id="3530" class="Symbol">:</a> <a id="3532" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="3537" href="Agda.Builtin.String.html#165" class="Postulate">String</a> <a id="3544" class="Symbol">→</a> <a id="3546" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="3551" class="Symbol">→</a> <a id="3553" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
  <a id="3560" href="Polynomial.Simple.Reflection.html#3524" class="Function">vlams</a> <a id="3566" href="Polynomial.Simple.Reflection.html#3566" class="Bound">vs</a> <a id="3569" href="Polynomial.Simple.Reflection.html#3569" class="Bound">xs</a> <a id="3572" class="Symbol">=</a> <a id="3574" href="Data.List.Base.html#3588" class="Function">foldr</a> <a id="3580" class="Symbol">(λ</a> <a id="3583" href="Polynomial.Simple.Reflection.html#3583" class="Bound">v</a> <a id="3585" href="Polynomial.Simple.Reflection.html#3585" class="Bound">vs</a> <a id="3588" class="Symbol">→</a> <a id="3590" href="Agda.Builtin.Reflection.html#4762" class="InductiveConstructor">lam</a> <a id="3594" href="Agda.Builtin.Reflection.html#2549" class="InductiveConstructor">visible</a> <a id="3602" class="Symbol">(</a><a id="3603" href="Agda.Builtin.Reflection.html#3308" class="InductiveConstructor">abs</a> <a id="3607" href="Polynomial.Simple.Reflection.html#3583" class="Bound">v</a> <a id="3609" href="Polynomial.Simple.Reflection.html#3585" class="Bound">vs</a><a id="3611" class="Symbol">))</a> <a id="3614" href="Polynomial.Simple.Reflection.html#3569" class="Bound">xs</a> <a id="3617" href="Polynomial.Simple.Reflection.html#3566" class="Bound">vs</a>

  <a id="Internal.mkSolver"></a><a id="3623" href="Polynomial.Simple.Reflection.html#3623" class="Function">mkSolver</a> <a id="3632" class="Symbol">:</a> <a id="3634" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="3639" href="Agda.Builtin.String.html#165" class="Postulate">String</a> <a id="3646" class="Symbol">→</a> <a id="3648" href="Agda.Builtin.Reflection.html#363" class="Postulate">Name</a> <a id="3653" class="Symbol">→</a> <a id="3655" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="3657" class="Symbol">→</a> <a id="3659" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="3664" class="Symbol">→</a> <a id="3666" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="3671" class="Symbol">→</a> <a id="3673" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
  <a id="3680" href="Polynomial.Simple.Reflection.html#3623" class="Function">mkSolver</a> <a id="3689" href="Polynomial.Simple.Reflection.html#3689" class="Bound">nms</a> <a id="3693" href="Polynomial.Simple.Reflection.html#3693" class="Bound">rng</a> <a id="3697" href="Polynomial.Simple.Reflection.html#3697" class="Bound">i</a> <a id="3699" href="Polynomial.Simple.Reflection.html#3699" class="Bound">lhs</a> <a id="3703" href="Polynomial.Simple.Reflection.html#3703" class="Bound">rhs</a> <a id="3707" class="Symbol">=</a>
    <a id="3713" class="Keyword">quote</a> <a id="3719" href="Polynomial.Simple.Solver.html#2804" class="Function">solve′</a> <a id="3726" href="Function.html#2548" class="Function Operator">⟨</a> <a id="3728" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="3732" href="Function.html#2548" class="Function Operator">⟩</a>
      <a id="3740" href="Polynomial.Simple.Reflection.html#526" class="InductiveConstructor Operator">⟅</a> <a id="3742" href="Agda.Builtin.Reflection.html#5048" class="InductiveConstructor">unknown</a> <a id="3750" href="Polynomial.Simple.Reflection.html#526" class="InductiveConstructor Operator">⟆∷</a>
      <a id="3759" href="Polynomial.Simple.Reflection.html#526" class="InductiveConstructor Operator">⟅</a> <a id="3761" href="Agda.Builtin.Reflection.html#5048" class="InductiveConstructor">unknown</a> <a id="3769" href="Polynomial.Simple.Reflection.html#526" class="InductiveConstructor Operator">⟆∷</a>
      <a id="3778" href="Polynomial.Simple.Reflection.html#464" class="InductiveConstructor Operator">⟨</a> <a id="3780" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="3784" href="Polynomial.Simple.Reflection.html#3693" class="Bound">rng</a> <a id="3788" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a> <a id="3791" href="Polynomial.Simple.Reflection.html#464" class="InductiveConstructor Operator">⟩∷</a>
      <a id="3800" href="Polynomial.Simple.Reflection.html#464" class="InductiveConstructor Operator">⟨</a> <a id="3802" href="Polynomial.Simple.Reflection.html#580" class="Function">natTerm</a> <a id="3810" href="Polynomial.Simple.Reflection.html#3697" class="Bound">i</a> <a id="3812" href="Polynomial.Simple.Reflection.html#464" class="InductiveConstructor Operator">⟩∷</a>
      <a id="3821" href="Polynomial.Simple.Reflection.html#464" class="InductiveConstructor Operator">⟨</a> <a id="3823" href="Polynomial.Simple.Reflection.html#3524" class="Function">vlams</a> <a id="3829" href="Polynomial.Simple.Reflection.html#3689" class="Bound">nms</a> <a id="3833" href="Function.html#1927" class="Function Operator">$</a>
          <a id="3845" class="Keyword">quote</a> <a id="3851" href="Polynomial.Simple.Solver.html#3445" class="Function Operator">_⊜_</a> <a id="3855" href="Function.html#2548" class="Function Operator">⟨</a> <a id="3857" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="3861" href="Function.html#2548" class="Function Operator">⟩</a>
            <a id="3875" href="Polynomial.Simple.Reflection.html#526" class="InductiveConstructor Operator">⟅</a> <a id="3877" href="Agda.Builtin.Reflection.html#5048" class="InductiveConstructor">unknown</a> <a id="3885" href="Polynomial.Simple.Reflection.html#526" class="InductiveConstructor Operator">⟆∷</a>
            <a id="3900" href="Polynomial.Simple.Reflection.html#526" class="InductiveConstructor Operator">⟅</a> <a id="3902" href="Agda.Builtin.Reflection.html#5048" class="InductiveConstructor">unknown</a> <a id="3910" href="Polynomial.Simple.Reflection.html#526" class="InductiveConstructor Operator">⟆∷</a>
            <a id="3925" href="Polynomial.Simple.Reflection.html#464" class="InductiveConstructor Operator">⟨</a> <a id="3927" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="3931" href="Polynomial.Simple.Reflection.html#3693" class="Bound">rng</a> <a id="3935" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a> <a id="3938" href="Polynomial.Simple.Reflection.html#464" class="InductiveConstructor Operator">⟩∷</a>
            <a id="3953" href="Polynomial.Simple.Reflection.html#464" class="InductiveConstructor Operator">⟨</a> <a id="3955" href="Polynomial.Simple.Reflection.html#580" class="Function">natTerm</a> <a id="3963" href="Polynomial.Simple.Reflection.html#3697" class="Bound">i</a> <a id="3965" href="Polynomial.Simple.Reflection.html#464" class="InductiveConstructor Operator">⟩∷</a>
            <a id="3980" href="Polynomial.Simple.Reflection.html#464" class="InductiveConstructor Operator">⟨</a> <a id="3982" href="Polynomial.Simple.Reflection.html#2796" class="Function">toExpr</a> <a id="3989" href="Polynomial.Simple.Reflection.html#3697" class="Bound">i</a> <a id="3991" href="Polynomial.Simple.Reflection.html#3699" class="Bound">lhs</a> <a id="3995" href="Polynomial.Simple.Reflection.html#464" class="InductiveConstructor Operator">⟩∷</a>
            <a id="4010" href="Polynomial.Simple.Reflection.html#464" class="InductiveConstructor Operator">⟨</a> <a id="4012" href="Polynomial.Simple.Reflection.html#2796" class="Function">toExpr</a> <a id="4019" href="Polynomial.Simple.Reflection.html#3697" class="Bound">i</a> <a id="4021" href="Polynomial.Simple.Reflection.html#3703" class="Bound">rhs</a> <a id="4025" href="Polynomial.Simple.Reflection.html#464" class="InductiveConstructor Operator">⟩∷</a>
            <a id="4040" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>
      <a id="4049" href="Polynomial.Simple.Reflection.html#464" class="InductiveConstructor Operator">⟩∷</a>
      <a id="4058" href="Polynomial.Simple.Reflection.html#464" class="InductiveConstructor Operator">⟨</a> <a id="4060" href="Polynomial.Simple.Reflection.html#3426" class="Function">hlams</a> <a id="4066" href="Polynomial.Simple.Reflection.html#3689" class="Bound">nms</a> <a id="4070" href="Function.html#1927" class="Function Operator">$</a>
          <a id="4082" class="Keyword">quote</a> <a id="4088" href="Polynomial.Simple.AlmostCommutativeRing.html#2136" class="Function">AlmostCommutativeRing.refl</a> <a id="4115" href="Function.html#2548" class="Function Operator">⟨</a> <a id="4117" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="4121" href="Function.html#2548" class="Function Operator">⟩</a>
            <a id="4135" href="Polynomial.Simple.Reflection.html#526" class="InductiveConstructor Operator">⟅</a> <a id="4137" href="Agda.Builtin.Reflection.html#5048" class="InductiveConstructor">unknown</a> <a id="4145" href="Polynomial.Simple.Reflection.html#526" class="InductiveConstructor Operator">⟆∷</a>
            <a id="4160" href="Polynomial.Simple.Reflection.html#526" class="InductiveConstructor Operator">⟅</a> <a id="4162" href="Agda.Builtin.Reflection.html#5048" class="InductiveConstructor">unknown</a> <a id="4170" href="Polynomial.Simple.Reflection.html#526" class="InductiveConstructor Operator">⟆∷</a>
            <a id="4185" href="Polynomial.Simple.Reflection.html#464" class="InductiveConstructor Operator">⟨</a> <a id="4187" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="4191" href="Polynomial.Simple.Reflection.html#3693" class="Bound">rng</a> <a id="4195" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a> <a id="4198" href="Polynomial.Simple.Reflection.html#464" class="InductiveConstructor Operator">⟩∷</a>
            <a id="4213" href="Polynomial.Simple.Reflection.html#526" class="InductiveConstructor Operator">⟅</a> <a id="4215" href="Agda.Builtin.Reflection.html#5048" class="InductiveConstructor">unknown</a> <a id="4223" href="Polynomial.Simple.Reflection.html#526" class="InductiveConstructor Operator">⟆∷</a>
            <a id="4238" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>
      <a id="4247" href="Polynomial.Simple.Reflection.html#464" class="InductiveConstructor Operator">⟩∷</a>
      <a id="4256" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>


  <a id="Internal.toSoln"></a><a id="4263" href="Polynomial.Simple.Reflection.html#4263" class="Function">toSoln</a> <a id="4270" class="Symbol">:</a> <a id="4272" href="Agda.Builtin.Reflection.html#363" class="Postulate">Name</a> <a id="4277" class="Symbol">→</a> <a id="4279" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="4284" class="Symbol">→</a> <a id="4286" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
  <a id="4293" href="Polynomial.Simple.Reflection.html#4263" class="Function">toSoln</a> <a id="4300" href="Polynomial.Simple.Reflection.html#4300" class="Bound">rng</a> <a id="4304" class="Symbol">=</a> <a id="4306" href="Polynomial.Simple.Reflection.html#4328" class="Function">go</a> <a id="4309" class="Number">0</a> <a id="4311" href="Function.html#1104" class="Function">id</a>
    <a id="4318" class="Keyword">where</a>
    <a id="4328" href="Polynomial.Simple.Reflection.html#4328" class="Function">go</a> <a id="4331" class="Symbol">:</a> <a id="4333" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="4335" class="Symbol">→</a> <a id="4337" class="Symbol">(</a><a id="4338" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="4343" href="Agda.Builtin.String.html#165" class="Postulate">String</a> <a id="4350" class="Symbol">→</a> <a id="4352" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="4357" href="Agda.Builtin.String.html#165" class="Postulate">String</a><a id="4363" class="Symbol">)</a> <a id="4365" class="Symbol">→</a> <a id="4367" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="4372" class="Symbol">→</a> <a id="4374" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
    <a id="4383" href="Polynomial.Simple.Reflection.html#4328" class="Function">go</a> <a id="4386" href="Polynomial.Simple.Reflection.html#4386" class="Bound">i</a> <a id="4388" href="Polynomial.Simple.Reflection.html#4388" class="Bound">k</a> <a id="4390" class="Symbol">(</a><a id="4391" href="Agda.Builtin.Reflection.html#4705" class="InductiveConstructor">def</a> <a id="4395" href="Polynomial.Simple.Reflection.html#4395" class="Bound">f</a> <a id="4397" class="Symbol">(</a><a id="4398" href="Polynomial.Simple.Reflection.html#464" class="InductiveConstructor Operator">⟨</a> <a id="4400" href="Polynomial.Simple.Reflection.html#4400" class="Bound">lhs</a> <a id="4404" href="Polynomial.Simple.Reflection.html#464" class="InductiveConstructor Operator">⟩∷</a> <a id="4407" href="Polynomial.Simple.Reflection.html#464" class="InductiveConstructor Operator">⟨</a> <a id="4409" href="Polynomial.Simple.Reflection.html#4409" class="Bound">rhs</a> <a id="4413" href="Polynomial.Simple.Reflection.html#464" class="InductiveConstructor Operator">⟩∷</a> <a id="4416" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="4418" class="Symbol">))</a> <a id="4421" class="Symbol">=</a> <a id="4423" href="Polynomial.Simple.Reflection.html#3623" class="Function">mkSolver</a> <a id="4432" class="Symbol">(</a><a id="4433" href="Polynomial.Simple.Reflection.html#4388" class="Bound">k</a> <a id="4435" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="4437" class="Symbol">)</a> <a id="4439" href="Polynomial.Simple.Reflection.html#4300" class="Bound">rng</a> <a id="4443" href="Polynomial.Simple.Reflection.html#4386" class="Bound">i</a> <a id="4445" href="Polynomial.Simple.Reflection.html#4400" class="Bound">lhs</a> <a id="4449" href="Polynomial.Simple.Reflection.html#4409" class="Bound">rhs</a>
    <a id="4457" href="Polynomial.Simple.Reflection.html#4328" class="CatchallClause Function">go</a><a id="4459" class="CatchallClause"> </a><a id="4460" href="Polynomial.Simple.Reflection.html#4460" class="CatchallClause Bound">i</a><a id="4461" class="CatchallClause"> </a><a id="4462" href="Polynomial.Simple.Reflection.html#4462" class="CatchallClause Bound">k</a><a id="4463" class="CatchallClause"> </a><a id="4464" class="CatchallClause Symbol">(</a><a id="4465" href="Agda.Builtin.Reflection.html#4705" class="CatchallClause InductiveConstructor">def</a><a id="4468" class="CatchallClause"> </a><a id="4469" href="Polynomial.Simple.Reflection.html#4469" class="CatchallClause Bound">f</a><a id="4470" class="CatchallClause"> </a><a id="4471" class="CatchallClause Symbol">(_</a><a id="4473" class="CatchallClause"> </a><a id="4474" href="Agda.Builtin.List.html#132" class="CatchallClause InductiveConstructor Operator">∷</a><a id="4475" class="CatchallClause"> </a><a id="4476" class="CatchallClause Symbol">_</a><a id="4477" class="CatchallClause"> </a><a id="4478" href="Agda.Builtin.List.html#132" class="CatchallClause InductiveConstructor Operator">∷</a><a id="4479" class="CatchallClause"> </a><a id="4480" href="Polynomial.Simple.Reflection.html#464" class="CatchallClause InductiveConstructor Operator">⟨</a><a id="4481" class="CatchallClause"> </a><a id="4482" href="Polynomial.Simple.Reflection.html#4482" class="CatchallClause Bound">lhs</a><a id="4485" class="CatchallClause"> </a><a id="4486" href="Polynomial.Simple.Reflection.html#464" class="CatchallClause InductiveConstructor Operator">⟩∷</a><a id="4488" class="CatchallClause"> </a><a id="4489" href="Polynomial.Simple.Reflection.html#464" class="CatchallClause InductiveConstructor Operator">⟨</a><a id="4490" class="CatchallClause"> </a><a id="4491" href="Polynomial.Simple.Reflection.html#4491" class="CatchallClause Bound">rhs</a><a id="4494" class="CatchallClause"> </a><a id="4495" href="Polynomial.Simple.Reflection.html#464" class="CatchallClause InductiveConstructor Operator">⟩∷</a><a id="4497" class="CatchallClause"> </a><a id="4498" href="Agda.Builtin.List.html#117" class="CatchallClause InductiveConstructor">[]</a><a id="4500" class="CatchallClause Symbol">))</a> <a id="4503" class="Symbol">=</a> <a id="4505" href="Polynomial.Simple.Reflection.html#3623" class="Function">mkSolver</a> <a id="4514" class="Symbol">(</a><a id="4515" href="Polynomial.Simple.Reflection.html#4462" class="Bound">k</a> <a id="4517" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="4519" class="Symbol">)</a> <a id="4521" href="Polynomial.Simple.Reflection.html#4300" class="Bound">rng</a> <a id="4525" href="Polynomial.Simple.Reflection.html#4460" class="Bound">i</a> <a id="4527" href="Polynomial.Simple.Reflection.html#4482" class="Bound">lhs</a> <a id="4531" href="Polynomial.Simple.Reflection.html#4491" class="Bound">rhs</a>
    <a id="4539" href="Polynomial.Simple.Reflection.html#4328" class="CatchallClause Function">go</a><a id="4541" class="CatchallClause"> </a><a id="4542" href="Polynomial.Simple.Reflection.html#4542" class="CatchallClause Bound">i</a><a id="4543" class="CatchallClause"> </a><a id="4544" href="Polynomial.Simple.Reflection.html#4544" class="CatchallClause Bound">k</a><a id="4545" class="CatchallClause"> </a><a id="4546" class="CatchallClause Symbol">(</a><a id="4547" href="Agda.Builtin.Reflection.html#4705" class="CatchallClause InductiveConstructor">def</a><a id="4550" class="CatchallClause"> </a><a id="4551" href="Polynomial.Simple.Reflection.html#4551" class="CatchallClause Bound">f</a><a id="4552" class="CatchallClause"> </a><a id="4553" class="CatchallClause Symbol">(_</a><a id="4555" class="CatchallClause"> </a><a id="4556" href="Agda.Builtin.List.html#132" class="CatchallClause InductiveConstructor Operator">∷</a><a id="4557" class="CatchallClause"> </a><a id="4558" class="CatchallClause Symbol">_</a><a id="4559" class="CatchallClause"> </a><a id="4560" href="Agda.Builtin.List.html#132" class="CatchallClause InductiveConstructor Operator">∷</a><a id="4561" class="CatchallClause"> </a><a id="4562" class="CatchallClause Symbol">_</a><a id="4563" class="CatchallClause"> </a><a id="4564" href="Agda.Builtin.List.html#132" class="CatchallClause InductiveConstructor Operator">∷</a><a id="4565" class="CatchallClause"> </a><a id="4566" href="Polynomial.Simple.Reflection.html#464" class="CatchallClause InductiveConstructor Operator">⟨</a><a id="4567" class="CatchallClause"> </a><a id="4568" href="Polynomial.Simple.Reflection.html#4568" class="CatchallClause Bound">lhs</a><a id="4571" class="CatchallClause"> </a><a id="4572" href="Polynomial.Simple.Reflection.html#464" class="CatchallClause InductiveConstructor Operator">⟩∷</a><a id="4574" class="CatchallClause"> </a><a id="4575" href="Polynomial.Simple.Reflection.html#464" class="CatchallClause InductiveConstructor Operator">⟨</a><a id="4576" class="CatchallClause"> </a><a id="4577" href="Polynomial.Simple.Reflection.html#4577" class="CatchallClause Bound">rhs</a><a id="4580" class="CatchallClause"> </a><a id="4581" href="Polynomial.Simple.Reflection.html#464" class="CatchallClause InductiveConstructor Operator">⟩∷</a><a id="4583" class="CatchallClause"> </a><a id="4584" href="Agda.Builtin.List.html#117" class="CatchallClause InductiveConstructor">[]</a><a id="4586" class="CatchallClause Symbol">))</a> <a id="4589" class="Symbol">=</a> <a id="4591" href="Polynomial.Simple.Reflection.html#3623" class="Function">mkSolver</a> <a id="4600" class="Symbol">(</a><a id="4601" href="Polynomial.Simple.Reflection.html#4544" class="Bound">k</a> <a id="4603" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="4605" class="Symbol">)</a> <a id="4607" href="Polynomial.Simple.Reflection.html#4300" class="Bound">rng</a> <a id="4611" href="Polynomial.Simple.Reflection.html#4542" class="Bound">i</a> <a id="4613" href="Polynomial.Simple.Reflection.html#4568" class="Bound">lhs</a> <a id="4617" href="Polynomial.Simple.Reflection.html#4577" class="Bound">rhs</a>
    <a id="4625" href="Polynomial.Simple.Reflection.html#4328" class="Function">go</a> <a id="4628" href="Polynomial.Simple.Reflection.html#4628" class="Bound">i</a> <a id="4630" href="Polynomial.Simple.Reflection.html#4630" class="Bound">k</a> <a id="4632" class="Symbol">(</a><a id="4633" href="Agda.Builtin.Reflection.html#4880" class="InductiveConstructor">pi</a> <a id="4636" href="Polynomial.Simple.Reflection.html#4636" class="Bound">a</a> <a id="4638" class="Symbol">(</a><a id="4639" href="Agda.Builtin.Reflection.html#3308" class="InductiveConstructor">abs</a> <a id="4643" href="Polynomial.Simple.Reflection.html#4643" class="Bound">s</a> <a id="4645" href="Polynomial.Simple.Reflection.html#4645" class="Bound">x</a><a id="4646" class="Symbol">))</a> <a id="4649" class="Symbol">=</a> <a id="4651" href="Polynomial.Simple.Reflection.html#4328" class="Function">go</a> <a id="4654" class="Symbol">(</a><a id="4655" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="4659" href="Polynomial.Simple.Reflection.html#4628" class="Bound">i</a><a id="4660" class="Symbol">)</a> <a id="4662" class="Symbol">(</a><a id="4663" href="Polynomial.Simple.Reflection.html#4630" class="Bound">k</a> <a id="4665" href="Function.html#805" class="Function Operator">∘</a> <a id="4667" class="Symbol">(</a><a id="4668" href="Polynomial.Simple.Reflection.html#4643" class="Bound">s</a> <a id="4670" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷_</a><a id="4672" class="Symbol">))</a> <a id="4675" href="Polynomial.Simple.Reflection.html#4645" class="Bound">x</a>
    <a id="4681" href="Polynomial.Simple.Reflection.html#4328" class="CatchallClause Function">go</a><a id="4683" class="CatchallClause"> </a><a id="4684" href="Polynomial.Simple.Reflection.html#4684" class="CatchallClause Bound">i</a><a id="4685" class="CatchallClause"> </a><a id="4686" href="Polynomial.Simple.Reflection.html#4686" class="CatchallClause Bound">k</a><a id="4687" class="CatchallClause"> </a><a id="4688" href="Polynomial.Simple.Reflection.html#4688" class="CatchallClause Bound">t</a> <a id="4690" class="Symbol">=</a> <a id="4692" href="Agda.Builtin.Reflection.html#5048" class="InductiveConstructor">unknown</a>

<a id="4701" class="Keyword">open</a> <a id="4706" href="Polynomial.Simple.Reflection.html#128" class="Module">Internal</a>
<a id="4715" class="Keyword">open</a> <a id="4720" class="Keyword">import</a> <a id="4727" href="Agda.Builtin.Reflection.html" class="Module">Agda.Builtin.Reflection</a>
<a id="4751" class="Keyword">macro</a>
  <a id="solve"></a><a id="4759" href="Polynomial.Simple.Reflection.html#4759" class="Function">solve</a> <a id="4765" class="Symbol">:</a> <a id="4767" href="Agda.Builtin.Reflection.html#363" class="Postulate">Name</a> <a id="4772" class="Symbol">→</a> <a id="4774" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a> <a id="4779" class="Symbol">→</a> <a id="4781" href="Agda.Builtin.Reflection.html#7153" class="Postulate">TC</a> <a id="4784" href="Agda.Builtin.Unit.html#69" class="Record">⊤</a>
  <a id="4788" href="Polynomial.Simple.Reflection.html#4759" class="Function">solve</a> <a id="4794" href="Polynomial.Simple.Reflection.html#4794" class="Bound">rng</a> <a id="4798" href="Polynomial.Simple.Reflection.html#4798" class="Bound">hole</a> <a id="4803" class="Symbol">=</a>
    <a id="4809" href="Agda.Builtin.Reflection.html#7414" class="Postulate">inferType</a> <a id="4819" href="Polynomial.Simple.Reflection.html#4798" class="Bound">hole</a> <a id="4824" href="Function.html#2548" class="Function Operator">⟨</a> <a id="4826" href="Agda.Builtin.Reflection.html#7240" class="Postulate">bindTC</a> <a id="4833" href="Function.html#2548" class="Function Operator">⟩</a> <a id="4835" href="Agda.Builtin.Reflection.html#7520" class="Postulate">reduce</a> <a id="4842" href="Function.html#2548" class="Function Operator">⟨</a> <a id="4844" href="Agda.Builtin.Reflection.html#7240" class="Postulate">bindTC</a> <a id="4851" href="Function.html#2548" class="Function Operator">⟩</a> <a id="4853" href="Agda.Builtin.Reflection.html#7317" class="Postulate">unify</a> <a id="4859" href="Polynomial.Simple.Reflection.html#4798" class="Bound">hole</a> <a id="4864" href="Function.html#805" class="Function Operator">∘</a> <a id="4866" href="Polynomial.Simple.Reflection.html#4263" class="Function">toSoln</a> <a id="4873" href="Polynomial.Simple.Reflection.html#4794" class="Bound">rng</a>
</pre></body></html>